<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="private,Java知识点," />










<meta name="description" content="Java 虚拟机面试题 （⭐⭐⭐）JVM 内存区域。JVM 基本构成从上图可知，JVM主要包括四个部分：  类加载器（ClassLoader）：在JVM启动时或者在类运行时将需要的class加载到JVM中。（下图表示了从java源文件到JVM的整个过程，可配合理解。）   执行引擎：负责执行class文件中包含的字节码指令；  内存区（也叫运行时数据区）：是在JVM运行的时候操作所分配的内存区。">
<meta property="og:type" content="article">
<meta property="og:title" content="Java-JVM面试题">
<meta property="og:url" content="http://shenbh.github.io/posts/659d22b1/index.html">
<meta property="og:site_name" content="AB">
<meta property="og:description" content="Java 虚拟机面试题 （⭐⭐⭐）JVM 内存区域。JVM 基本构成从上图可知，JVM主要包括四个部分：  类加载器（ClassLoader）：在JVM启动时或者在类运行时将需要的class加载到JVM中。（下图表示了从java源文件到JVM的整个过程，可配合理解。）   执行引擎：负责执行class文件中包含的字节码指令；  内存区（也叫运行时数据区）：是在JVM运行的时候操作所分配的内存区。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://shenbh.github.io/posts/659d22b1/JVM%E5%9F%BA%E6%9C%AC%E6%9E%84%E6%88%90.png">
<meta property="og:image" content="http://shenbh.github.io/posts/659d22b1/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B.png">
<meta property="og:image" content="http://shenbh.github.io/posts/659d22b1/%E8%BF%90%E8%A1%8C%E6%97%B6%E5%86%85%E5%AD%98%E5%8C%BA.png">
<meta property="article:published_time" content="2022-03-10T01:59:21.000Z">
<meta property="article:modified_time" content="2022-11-02T07:22:57.106Z">
<meta property="article:author" content="阿炳">
<meta property="article:tag" content="private">
<meta property="article:tag" content="Java知识点">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://shenbh.github.io/posts/659d22b1/JVM%E5%9F%BA%E6%9C%AC%E6%9E%84%E6%88%90.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://shenbh.github.io/posts/659d22b1/"/>





  <title>Java-JVM面试题 | AB</title><meta name="robots" content="noindex">
  








<meta name="generator" content="Hexo 6.1.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AB</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Just do IT Now.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://shenbh.github.io/posts/659d22b1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AB">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Java-JVM面试题</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-10T09:59:21+08:00">
                2022-03-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Java-虚拟机面试题-（⭐⭐⭐）"><a href="#Java-虚拟机面试题-（⭐⭐⭐）" class="headerlink" title="Java 虚拟机面试题 （⭐⭐⭐）"></a>Java 虚拟机面试题 （⭐⭐⭐）</h1><h2 id="JVM-内存区域。"><a href="#JVM-内存区域。" class="headerlink" title="JVM 内存区域。"></a>JVM 内存区域。</h2><h3 id="JVM-基本构成"><a href="#JVM-基本构成" class="headerlink" title="JVM 基本构成"></a><code>JVM</code> 基本构成<img src="/posts/659d22b1/JVM%E5%9F%BA%E6%9C%AC%E6%9E%84%E6%88%90.png" alt="Java/JVM基本构成"></h3><p>从上图可知，<code>JVM</code>主要包括四个部分：</p>
<ol>
<li><p>类加载器（<code>ClassLoader</code>）：在JVM启动时或者在类运行时将需要的<code>class</code>加载到<code>JVM</code>中。（下图表示了从<code>java</code>源文件到<code>JVM</code>的整个过程，可配合理解。）</p>
<p><img src="/posts/659d22b1/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B.png" alt="Java/类加载器加载过程"></p>
</li>
<li><p>执行引擎：负责执行<code>class</code>文件中包含的字节码指令；</p>
</li>
<li><p>内存区（也叫运行时数据区）：是在<code>JVM</code>运行的时候操作所分配的内存区。</p>
<p>运行时内存区主要可以划分为5个区域，如图：</p>
<p><img src="/posts/659d22b1/%E8%BF%90%E8%A1%8C%E6%97%B6%E5%86%85%E5%AD%98%E5%8C%BA.png" alt="Java/运行时内存区"></p>
<p>方法区（<code>MethodArea</code>）：用于存储类结构信息的地方，包括常量池、静态变量、构造函数等。虽然<code>JVM</code>规范把方法区描述为堆的一个逻辑部分，但它却有个别名<code>non-heap</code>（非堆），所以大家不要搞混淆了。方法区还包含一个运行时常量池。</p>
<p><code>java</code>堆（<code>Heap</code>）：存储<code>java</code>实例或者对象的地方。这块是<code>GC</code>的主要区域。从存储的内容我们可以很容易知道，方法和堆是被所有<code>java</code>线程共享的。</p>
<p><code>java</code>栈（<code>Stack</code>）：<code>java</code>栈总是和线程关联在一起，每当创建一个线程时，<code>JVM</code>就会为这个线程创建一个对应的<code>java</code>栈，在这个<code>java</code>栈中，其中又会包含多个栈帧，每运行一个方法就建一个栈帧，用于存储局部变量表、操作栈、方法返回等。每一个方法从调用到直至执行完成的过程，就对应一栈帧在<code>java</code>栈中入栈到出栈的过程。所以<code>java</code>栈是现成有的。</p>
<p>程序计数器（<code>PCRegister</code>）：用于保存当前线程执行的内存地址。由于<code>JVM</code>程序是多线程执行的（线程轮流切换），所以为了保证线程切换回来后，还能恢复到原先状态，就需要一个独立计数器，记录之前中断的地方，可见程序计数器也是线程私有的。</p>
<p>本地方法栈（<code>Native MethodStack</code>）：和<code>java</code>栈的作用差不多，只不过是为<code>JVM</code>使用到<code>native</code>方法服务的。</p>
</li>
<li><p>本地方法接口：主要是调用<code>C</code>或者<code>C++</code>实现的本地方法及回调结果。</p>
</li>
</ol>
<h3 id="开线程影响哪块内存？"><a href="#开线程影响哪块内存？" class="headerlink" title="开线程影响哪块内存？"></a>开线程影响哪块内存？</h3><p>每当有线程被创建的时候，<code>JVM</code> 就需要为其在内存中分配虚拟机栈和本地方法栈来记录调用方法的内容，分配程序计数器记录指令执行的位置，这样的内存消耗就是创建线程的内存代价。</p>
<h2 id="JVM-的内存模型的理解？"><a href="#JVM-的内存模型的理解？" class="headerlink" title="JVM 的内存模型的理解？"></a><strong>JVM 的内存模型的理解？</strong></h2><p><code>Java</code>内存模型即<code>Java Memory Model</code>，简称<code>JMM</code>。<code>JMM</code>定义了<code>Java</code> 虚拟机(<code>JVM</code>) 在计算机内存(<code>RAM</code>)中的工作方式。<code>JVM</code> 是整个计算机虚拟模型，所以 <code>JMM</code> 是隶属于 <code>JVM</code> 的。 </p>
<p><code>Java</code> 线程之间的通信总是隐式进行，并且采用的是<strong>共享内存模型</strong>。这里提到的共享内存模型指的就是 <code>Java</code> 内存模型(简称 <code>JMM</code>)，<code>JMM</code> 决定一个线程对共享变量的写入何时对另一个线程可见。从抽象的角度来看，<code>JMM</code> 定义了线程和主内存之间的抽象关系：线程之间的共享变量存储在<strong>主内存</strong>（<code>main memory</code>）中，每个线程都有一个私有的本地内存（<code>local memory</code>），本地内存中存储了该线程以读&#x2F;写共享变量的<strong>副本</strong>。本地内存是 <code>JMM</code> 的一个抽象概念，并不真实存在。它涵盖了缓存，写缓冲区，寄存器以及其他的硬件和编译器优化。总之，<code>JMM</code> 就是<strong>一组规则</strong>，这组规则意在解决在并发编程可能出现的线程安全问题，并提供了内置解决方案（<code>happen-before</code> 原则）及其外部可使用的同步手段(<code>synchronized</code>&#x2F;<code>volatile</code> 等)，确保了程序执行在多线程环境中的应有的原子性，可视性及其有序性。 </p>
<h3 id="需要更全面理解建议阅读以下文章："><a href="#需要更全面理解建议阅读以下文章：" class="headerlink" title="需要更全面理解建议阅读以下文章："></a>需要更全面理解建议阅读以下文章：</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/javazejian/article/details/72772461">全面理解 Java 内存模型(JMM)及 volatile 关键字</a> </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/suifeng3051/article/details/52611310">全面理解 Java 内存模型</a> </p>
<h2 id="描述一下-GC-的原理和回收策略？"><a href="#描述一下-GC-的原理和回收策略？" class="headerlink" title="描述一下 GC 的原理和回收策略？"></a>描述一下 GC 的原理和回收策略？</h2><p>提到垃圾回收，我们可以先思考一下，如果我们去做垃圾回收需要解决哪些问题？</p>
<p>一般说来，我们要解决三个问题： </p>
<ol>
<li>回收哪些内存？ </li>
<li>什么时候回收？ </li>
<li>如何回收？</li>
</ol>
<p>这些问题分别对应着引用管理和回收策略等方案。提到引用，我们都知道 Java 中有四种引用类型： </p>
<ul>
<li>强引用：代码中普遍存在的，只要强引用还存在，垃圾收集器就不会回收掉被引用的对象。 </li>
<li>软引用：SoftReference，用来描述还有用但是非必须的对象，当内存不足的时候会回收这类对象。</li>
<li>弱引用：WeakReference，用来描述非必须对象，弱引用的对象只能生存到下一次 GC 发生时，当 GC 发生时，无论内存是否足够，都会回收该对象。</li>
<li>虚引用：PhantomReference，一个对象是否有虚引用的存在，完全不会对其生存时间产生影响，也无法通过虚引用取得一个对象的引用，它存在的唯一目的是在这个对象被回收时可以收到一个系统通知。</li>
</ul>
<p>不同的引用类型，在做 GC 时会区别对待，我们平时生成的 Java 对象，默认都是强引用，也就是说只要强引用还在，GC 就不会回收，那么如何判断强引用是否存在呢？ </p>
<p>一个简单的思路就是：<strong>引用计数法</strong>，有对这个对象的引用就+1，不再引用就-1，但是这种方式看起来简单美好，但它却不能解决循环引用计数的问题。</p>
<p>因此<strong>可达性分析算法</strong>登上历史舞台，用它来判断对象的引用是否存在。</p>
<p>可达性分析算法通过一系列称为 GCRoots 的对象作为起始点，从这些节点从上向下搜索，所走过的路径称为引用链，当一个对象没有任何引用链与 GCRoots 连接时就说明此对象不可用，也就是对象不可达。 </p>
<p>GC Roots 对象通常包括： </p>
<ul>
<li>虚拟机栈中引用的对象（栈帧中的本地变量表） </li>
<li>方法中类的静态属性引用的对象 </li>
<li>方法区中常量引用的对象 </li>
<li>Native 方法引用的对象</li>
</ul>
<p>可达性分析算法整个流程如下所示： </p>
<p>第一次标记：对象在经过可达性分析后发现没有与 GC Roots 有引用链，则进行第一次标记并进行一次筛选，筛选条件是：该对象是否有必要执行 finalize()方法。没有覆盖 finalize()方法或者 finalize()方法已经被执行过都会被认为没有必要执行。 如果有必要执行：则该对象会被放在一个 F-Queue 队列，并稍后在由虚拟机建立的低优先级 Finalizer 线程中触发该对象的 finalize()方法，但不保证一定等待它执行结束，因为如果这个对象的 finalize()方法发生了死循环或者执行时间较长的情况，会阻塞 F-Queue 队列里的其他对象，影响 GC。 </p>
<p>第二次标记：GC 对 F-Queue 队列里的对象进行第二次标记，如果在第二次标记时该对象又成功被引用，则会被移除即将回收的集合，否则会被回收。总之，JVM 在做垃圾回收的时候，会检查堆中的所有对象否会被这些根集对象引用，不能够被引用的对象就会被圾收集器回收。一般回收算法也有如下几种： </p>
<ol>
<li><p>标记-清除（Mark-sweep） </p>
<p>标记-清除算法采用从根集合进行扫描，对存活的对象进行标记，标记完毕后，再扫描整个空间中未被标记的对象，进行回收。标记-清除算法不需要进行对象的移动，并且仅对不存活的对象进行处理，在存活对象比较多的情况下极为高效，但由于标记-清除算法直接回收不存活的对象，因此会造成内存碎片。 </p>
</li>
<li><p>标记-整理（Mark-Compact）</p>
<p>标记-整理算法采用标记-清除算法一样的方式进行对象的标记，但在清除时不同，在回收不存活的对象占用的空间后，会将所有的存活对象往左端空闲空间移动，并更新对应的指针。标记-整理算法是在标记-清除算法的基础上，又进行了对象的移动，因此成本更高，但是却解决了内存碎片的问题。该垃圾回收算法适用于对象存活率高的场景（老年代）。 </p>
</li>
<li><p>复制（Copying）</p>
<p>复制算法将可用内存按容量划分为大小相等的两块，每次只使用其中的一块。当这一块的内存用完了，就将还存活着的对象复制到另外一块上面，然后再把已使用过的内存空间一次清理掉。这种算法适用于对象存活率低的场景，比如新生代。这样使得每次都是对整个半区进行内存回收，内存分配时也就不用考虑内存碎片等复杂情况。 </p>
</li>
<li><p>分代收集算法</p>
<p>不同的对象的生命周期(存活情况)是不一样的，而不同生命周期的对象位于堆中不同的区域，因此对堆内存不同区域采用不同的策略进行回收可以提高 JVM 的执行效率。当代商用虚拟机使用的都是分代收集算法：新生代对象存活率低，就采用复制算法；老年代存活率高，就用标记清除算法或者标记整理算法。Java 堆内存一般可以分为新生代、老年代和永久代三个模块：</p>
</li>
</ol>
<h3 id="新生代："><a href="#新生代：" class="headerlink" title="新生代："></a>新生代：</h3><ol>
<li><p>所有新生成的对象首先都是放在新生代的。新生代的目标就是尽可能快速的收集掉那些生命周期短的对象。 </p>
</li>
<li><p>新生代内存按照 8:1:1 的比例分为一个 eden 区和两个survivor(survivor0,survivor1)区。大部分对象在 Eden 区中生成。回收时先将 eden 区存活对象复制到一个 survivor0 区，然后清空 eden 区，当这个 survivor0 区也存放满了时，则将 eden 区和 survivor0 区存活对象复制到另一个 survivor1 区，然后清空 eden 和这个 survivor0 区，此时 survivor0 区是空的，然后将 survivor0 区和 survivor1 区交换，即保持 survivor1 区为空， 如此往复。 </p>
</li>
<li><p>当 survivor1 区不足以存放 eden 和 survivor0 的存活对象时，就将存活对象直接存放到老年代。若是老年代也满了就会触发一次 Full GC，也就是新生代、老年代都进行回收。 </p>
</li>
<li><p>新生代发生的 GC 也叫做 Minor GC，MinorGC 发生频率比较高(不一定等 Eden 区满了才触发)。</p>
</li>
</ol>
<h3 id="老年代："><a href="#老年代：" class="headerlink" title="老年代："></a>老年代：</h3><ol>
<li><p>在老年代中经历了 N 次垃圾回收后仍然存活的对象，就会被放到老年代中。因此，可以认为老年代中存放的都是一些生命周期较长的对象。 </p>
</li>
<li><p>内存比新生代也大很多(大概比例是 1:2)，当老年代内存满时触发 Major GC，即 Full GC。Full GC 发生频率比较低，老年代对象存活时间比较长。</p>
</li>
</ol>
<h3 id="永久代："><a href="#永久代：" class="headerlink" title="永久代："></a>永久代：</h3><p>永久代主要存放静态文件，如 Java 类、方法等。永久代对垃圾回收没有显著影响，但是有些应用可能动态生成或者调用一些 class，例如使用反射、动态代理、CGLib 等 bytecode 框架时，在这种时候需要设置一个比较大的永久代空间来存放这些运行过程中新增的类。 </p>
<h3 id="垃圾收集器"><a href="#垃圾收集器" class="headerlink" title="垃圾收集器"></a>垃圾收集器</h3><p>垃圾收集算法是内存回收的方法论，那么垃圾收集器就是内存回收的具体实现： </p>
<ul>
<li>Serial 收集器（复制算法): 新生代单线程收集器，标记和清理都是单线程，优点是简单高效； </li>
<li>Serial Old 收集器 (标记-整理算法): 老年代单线程收集器，Serial 收集器的老年代版本； </li>
<li>ParNew 收集器 (复制算法): 新生代收并行集器，实际上是 Serial 收集器的多线程版本，在多核 CPU 环境下有着比 Serial 更好的表现；</li>
<li>CMS(Concurrent Mark Sweep)收集器（标记-清除算法）： 老年代并行收集器，以获取最短回收停顿时间为目标的收集器，具有高并发、低停顿的特点，追求最短 GC 回收停顿时间。Parallel Old 收集器 (标记-整理算法)： 老年代并行收集器，吞吐量优先，Parallel Scavenge 收集器的老年代版本；</li>
<li>Parallel Scavenge 收集器 (复制算法): 新生代并行收集器，追求高吞吐量，高效利用 CPU。吞吐量 &#x3D; 用户线程时间&#x2F;(用户线程时间+GC 线程时间)，高吞吐量可以高效率的利用 CPU 时间，尽快完成程序的运算任务，适合后台应用等对交互相应要求不高的场景；</li>
<li>G1(Garbage First)收集器 (标记-整理算法)： Java 堆并行收集器，G1 收集器是 JDK1.7 提供的一个新收集器，G1 收集器基于“标记-整理”算法实现，也就是说不会产生内存碎片。此外，G1 收集器不同于之前的收集器的一个重要特点是：G1 回收的范围是整个 Java 堆(包括新生代，老年代)， 而前六种收集器回收的范围仅限于新生代或老年代。</li>
</ul>
<h3 id="内存分配和回收策略"><a href="#内存分配和回收策略" class="headerlink" title="内存分配和回收策略"></a>内存分配和回收策略</h3><p>JAVA 自动内存管理：给对象分配内存 以及 回收分配给对象的内存。 </p>
<ol>
<li><p>对象优先在 Eden 分配，当 Eden 区没有足够空间进行分配时，虚拟机将发起一次 MinorGC。 </p>
</li>
<li><p>大对象直接进入老年代。如很长的字符串以及数组。很长的字符串以及数组。 </p>
</li>
<li><p>长期存活的对象将进入老年代。当对象在新生代中经历过一定次数（默认为15）的 Minor GC 后，就会被晋升到老年代中。 </p>
</li>
<li><p>动态对象年龄判定。为了更好地适应不同程序的内存状况，虚拟机并不是永远地要求对象年龄必须达到了 MaxTenuringThreshold 才能晋升老年代，如果在Survivor 空间中相同年龄所有对象大小的总和大于 Survivor 空间的一半，年龄大于或等于该年龄的对象就可以直接进入老年代，无须等到 MaxTenuringThreshold 中要求的年龄。</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/justloveyou_/article/details/71216049">需要更全面的理解请点击这里</a> </p>
<h2 id="类的加载器，双亲机制，Android-的类加载器。"><a href="#类的加载器，双亲机制，Android-的类加载器。" class="headerlink" title="类的加载器，双亲机制，Android 的类加载器。"></a>类的加载器，双亲机制，Android 的类加载器。</h2><h3 id="类的加载器"><a href="#类的加载器" class="headerlink" title="类的加载器"></a>类的加载器</h3><p>大家都知道，一个 Java 程序都是由若干个.class 文件组织而成的一个完整的 Java 应用程序，当程序在运行时，即会调用该程序的一个入口函数来调用系统的相关功能，而这些功能都被封装在不同的 class 文件当中，所以经常要从这个 class 文件中要调用另外一个 class 文件中的方法，如果另外一个文件不存在的话，则会引发系统异常。 </p>
<p>而程序在启动的时候，并不会一次性加载程序所要用到的 class 文件，而是根据程序的需要，通过 Java 的类加载制（ClassLoader）来动态加载某个 class 文件到内存当的，从而只有 class 文件被载入到了内存之后，才能被其它 class 文件所引用。所以 ClassLoader 就是用来动态加载 class 件到内存当中用的。 </p>
<h3 id="双亲机制"><a href="#双亲机制" class="headerlink" title="双亲机制"></a>双亲机制</h3><p>类的加载就是虚拟机通过一个类的全限定名来获取描述此类的二进制字节流，而完成这个加载动作的就是类加载器。 </p>
<p>类和类加载器息息相关，判定两个类是否相等，只有在这两个类被同一个类加载器加载的情况下才有意义，否则即便是两个类来自同一个 Class 文件，被不同类加载器加载，它们也是不相等的。 </p>
<blockquote>
<p>注：这里的相等性保函 Class 对象的 equals()方法、isAssignableFrom()方法、isInstance()方法的返回结果以及 Instance 关键字对对象所属关系的判定结果等。 </p>
</blockquote>
<p>类加载器可以分为三类：</p>
<ul>
<li>启动类加载器（Bootstrap ClassLoader）：负责加载<JAVA_HOME>\lib 目录下或者被-Xbootclasspath 参数所指定的路径的，并且是被虚拟机所 识别的库到内存中。 </JAVA_HOME></li>
<li>扩展类加载器（Extension ClassLoader）：负责加载<JAVA_HOME>\lib\ext 目录下或者被 java.ext.dirs 系统变量所指定的路径的所有类库到内存中。 </JAVA_HOME></li>
<li>应用类加载器（Application ClassLoader）：负责加载用户类路径上的指定类库，如果应用程序中没有实现自己的类加载器，一般就是这个类加载 器去加载应用程序中的类库。</li>
</ul>
<ol>
<li><p>原理介绍 </p>
<p>ClassLoader 使用的是双亲委托模型来搜索类的，每个 ClassLoader 实例都有一个父类加载器的引用（不是继承的关系，是一个包含的关系），虚拟机内置的类加载器（Bootstrap ClassLoader）本身没有父类加载器，但可以用作其它 ClassLoader 实例的的父类加载器。 </p>
<p>当一个 ClassLoader 实例需要加载某个类时，它会在试图搜索某个类之前，先把这个任务委托给它的父类加载器，这个过程是由上至下依次检查的，首先由最顶层的类加载器 Bootstrap ClassLoader 试图加载，如果没加载到，则把任务转交给 Extension ClassLoader 试图加载，如果也没加载到，则转交给 App ClassLoader 进行加载，如果它也没有加载得到的话，则返回给委托的发起者，由它到指定的文件系统或网络等待 URL 中加载该类。</p>
<p>如果它们都没有加载到这个类时，则抛出 ClassNotFoundException 异常。否则将这个找到的类生成一个类的定义，将它加载到内存当中，最后返回这个类在内存中的 Class 实例对象。</p>
<p>类加载机制：类的加载指的是将类的.class 文件中的二进制数据读入到内存中，将其放在运行时数据区的方法去内，然后在堆区创建一个 java.lang.Class 对象，用来封装在方法区内的数据结构。类的加载最终是在堆区内的 Class 对象，Class 对象封装了类在方法区内的数据结构，并且向 Java 程序员提供了访问方法区内的数据结构的接口。 </p>
<p>类加载有三种方式： </p>
<ol>
<li>命令行启动应用时候由 JVM 初始化加载 </li>
<li>通过 Class.forName（）方法动态加载 </li>
<li>通过 ClassLoader.loadClass（）方法动态加载</li>
</ol>
<p>这么多类加载器，那么当类在加载的时候会使用哪个加载器呢？</p>
<p>这个时候就要提到类加载器的双亲委派模型，流程图如下所示： </p>
<p>双亲委派模型的整个工作流程非常的简单，如下所示： </p>
<p>如果一个类加载器收到了加载类的请求，它不会自己立去加载类，它会先去请求父类加载器，每个层次的类加器都是如此。层层传递，直到传递到最高层的类加载器只有当 父类加载器反馈自己无法加载这个类，才会有当子类加载器去加载该类。 </p>
</li>
<li><p>为什么要使用双亲委托这种模型呢？</p>
<p>因为这样可以避免重复加载，当父亲已经加载了该类的时候，就没有必要让子 ClassLoader 再加载一次。考虑到安全因素，我们试想一下，如果不使用这种委托模式，那我们就可以随时使用自定义的 String 来动态替代 java 核心 api 中定义的类型，这样会存在非常大的安全隐患，而双亲委托的方式，就可以避免这种情况，因为 String 已经在启动时就被引导类加载器（BootstrcpClassLoader）加载，所以用户自定义的ClassLoader 永远也无法加载一个自己写的 String，除非你改变 JDK 中 ClassLoader 搜索类的默认算法。 </p>
</li>
<li><p>但是 JVM 在搜索类的时候，又是如何判定两个 class 是相同的呢？ </p>
<p>JVM 在判定两个 class 是否相同时，不仅要判断两个类名否相同，而且要判断是否由同一个类加载器实例加载的。只有两者同时满足的情况下，JVM 才认为这两个 class 是相同的。就算两个 class 是同一份 class 字节码，如果被两个不同的 ClassLoader 实例所加载，JVM 也会认为它们是两个不同 class。 </p>
<p>比如网络上的一个 Java 类 org.classloader.simple.NetClassLoaderSimple，javac 编译之后生成字节码文件 NetClasLoaderSimple.class，ClassLoaderA 和 ClassLoaderB 这个类加载器并读取了 NetClassLoaderSimple.class 文件并分别定义出了 java.lang.Class 实例来表示这个类，对 JVM 来说，它们是两个不同的实例对象，但它们确实是一份字节码文件，如果试图将这个 Class 实例生成具体的对象进行转换时，就会抛运行时异常 java.lang.ClassCastException，提示这是两个不同的类型。</p>
</li>
</ol>
<h3 id="Android-类加载器"><a href="#Android-类加载器" class="headerlink" title="Android 类加载器"></a>Android 类加载器</h3><p>对于 Android 而言，最终的 apk 文件包含的是 dex 类型的文件，dex 文件是将 class 文件重新打包，打包的规则又不是简单地压缩，而是完全对 class 文件内部的各种函数表进行优化，产生一个新的文件，即 dex 文件。因此加载某种特殊的 Class 文件就需要特殊的类加载器 DexClassLoader。可以动态加载 Jar 通过 URLClassLoader </p>
<ol>
<li><p>ClassLoader 隔离问题：JVM 识别一个类是由 ClassLoaderid + PackageName + ClassName。 </p>
</li>
<li><p>加载不同 Jar 包中的公共类： </p>
<ul>
<li>让父 ClassLoader 加载公共的 Jar，子 ClassLoade 加载包含公共 Jar 的 Jar，此时子 ClassLoader 在加载 Jar 的时候会先去父 ClassLoader 中找。(只适用 Java) </li>
<li>重写加载包含公共 Jar 的 Jar 的 ClassLoader，在 loClass 中找到已经加载过公共 Jar 的 ClassLoader，是把父 ClassLoader 替换掉。(只适用 Java) </li>
<li>在生成包含公共 Jar 的 Jar 时候把公共 Jar 去掉。</li>
</ul>
</li>
</ol>
<h2 id="JVM-跟-Art、Dalvik-对比？"><a href="#JVM-跟-Art、Dalvik-对比？" class="headerlink" title="JVM 跟 Art、Dalvik 对比？"></a>JVM 跟 Art、Dalvik 对比？</h2><h2 id="GC-收集器简介？以及它的内存划分怎么样的？"><a href="#GC-收集器简介？以及它的内存划分怎么样的？" class="headerlink" title="GC 收集器简介？以及它的内存划分怎么样的？"></a>GC 收集器简介？以及它的内存划分怎么样的？</h2><ol>
<li><p>简介：</p>
<p>Garbage-First（G1，垃圾优先）收集器是服务类型的收集器，目标是多处理器机器、大内存机器。它高度符合垃圾收集暂停时间的目标，同时实现高吞吐量。Oracle JDK 7 update 4 以及更新发布版完全支持 G1 垃圾收集器</p>
</li>
<li><p>G1 的内存划分方式：</p>
<p>它是将堆内存被划分为多个大小相等的 heap 区,每个 heap 区都是逻辑上连续的一段内存(virtual memory). 其中一部分区域被当成老一代收集器相同的角色 (eden, survivor, old), 但每个角色的区域个数都不是固定的。这在内存使用上提供了更多的灵活性</p>
</li>
</ol>
<h2 id="Java-的虚拟机-JVM-的两个内存：栈内存和堆内存的区别是什么？"><a href="#Java-的虚拟机-JVM-的两个内存：栈内存和堆内存的区别是什么？" class="headerlink" title="Java 的虚拟机 JVM 的两个内存：栈内存和堆内存的区别是什么？"></a>Java 的虚拟机 JVM 的两个内存：栈内存和堆内存的区别是什么？</h2><p>Java 把内存划分成两种：一种是栈内存，一种是堆内存。两者的区别是： </p>
<ol>
<li><p>栈内存：在函数中定义的一些<strong>基本类型</strong>的变量和<strong>对象的引用</strong>变量都在函数的栈内存中分配。 当在一段代码块定义一个变量时，Java 就在栈中为这个变量分配内存空间，当超过变量的作用域后，Java 会自动释放掉为该变量所分配的内存空间，该内存空间可以立即被另作他用。 </p>
</li>
<li><p>堆内存：堆内存用来存放由 new 创建的对象和数组。在堆中分配的内存，由 Java 虚拟机的自动垃圾回收器来管理。</p>
</li>
</ol>
<h2 id="JVM-调优的常见命令行工具有哪些？JVM-常见的调优参数有哪些？"><a href="#JVM-调优的常见命令行工具有哪些？JVM-常见的调优参数有哪些？" class="headerlink" title="JVM 调优的常见命令行工具有哪些？JVM 常见的调优参数有哪些？"></a>JVM 调优的常见命令行工具有哪些？JVM 常见的调优参数有哪些？</h2><h3 id="JVM-调优的常见命令工具包括："><a href="#JVM-调优的常见命令工具包括：" class="headerlink" title="JVM 调优的常见命令工具包括："></a>JVM 调优的常见命令工具包括：</h3><ol>
<li>jps 命令用于查询正在运行的 JVM 进程， </li>
<li>jstat 可以实时显示本地或远程 JVM 进程中类装载、内存、垃圾收集、JIT 编译等数据 </li>
<li>jinfo 用于查询当前运行这的 JVM 属性和参数的值。 </li>
<li>jmap 用于显示当前 Java 堆和永久代的详细信息</li>
<li>jhat 用于分析使用 jmap 生成的 dump 文件，是 JDK 自带的工具 </li>
<li>jstack 用于生成当前 JVM 的所有线程快照，线程快照是虚拟机每一条线程正在执行的方法,目的是定位线程出现长时间停顿的原因。</li>
</ol>
<h3 id="JVM-常见的调优参数包括："><a href="#JVM-常见的调优参数包括：" class="headerlink" title="JVM 常见的调优参数包括："></a>JVM 常见的调优参数包括：</h3><ul>
<li><p>-Xmx</p>
<p>指定 java 程序的最大堆内存, 使用 java -Xmx5000M -version 判断当前系统能分配的最大堆内存 </p>
</li>
<li><p>-Xms</p>
<p>指定最小堆内存, 通常设置成跟最大堆内存一样，减少 GC </p>
</li>
<li><p>-Xmn</p>
<p>设置年轻代大小。整个堆大小&#x3D;年轻代大小 + 年老代大小。所以增大年轻代后，将会减小年老代大小。此值对系统性能影响较大，Sun 官方推荐配置为整个堆的 3&#x2F;8。 </p>
</li>
<li><p>-Xss</p>
<p>指定线程的最大栈空间, 此参数决定了 java 函数调用的深度, 值越大调用深度越深, 若值太小则容易出栈溢出错误(StackOverflowError) -XX:PermSize指定方法区(永久区)的初始值,默认是物理内存的 1&#x2F;64， 在 Java8 永久区移除, 代之的是元数据区， 由-XX:MetaspaceSize 指定 </p>
</li>
<li><p>-XX:MaxPermSize</p>
<p>指定方法区的最大值, 默认是物理内存的 1&#x2F;4， 在 java8 中由 -XX:MaxMetaspaceSize 指定元数据区的大小 </p>
</li>
<li><p>-XX:NewRatio&#x3D;n </p>
<p>年老代与年轻代的比值，-XX:NewRatio&#x3D;2, 表示年老代与年轻代的比值为 2:1 </p>
</li>
<li><p>-XX:SurvivorRatio&#x3D;n </p>
<p>Eden 区与 Survivor 区的大小比值，-XX:SurvivorRatio&#x3D;8 表示 Eden 区与 Survivor 区的大小比值是 8:1:1，因为 Survivor 区有两个(from, to)</p>
</li>
</ul>
<h2 id="jstack-jmap-jutil-分别的意义？如何线上排查-JVM-的相关问题？"><a href="#jstack-jmap-jutil-分别的意义？如何线上排查-JVM-的相关问题？" class="headerlink" title="jstack,jmap,jutil 分别的意义？如何线上排查 JVM 的相关问题？"></a>jstack,jmap,jutil 分别的意义？如何线上排查 <strong>JVM</strong> 的相关问题？</h2><h2 id="JVM方法区存储内容-是否会动态扩展-是否会出现内存溢出-出现的原因有哪些。"><a href="#JVM方法区存储内容-是否会动态扩展-是否会出现内存溢出-出现的原因有哪些。" class="headerlink" title="JVM方法区存储内容 是否会动态扩展 是否会出现内存溢出 出现的原因有哪些。"></a>JVM方法区存储内容 是否会动态扩展 是否会出现内存溢出 出现的原因有哪些。</h2><h2 id="如何解决同时存在的对象创建和对象回收问题？"><a href="#如何解决同时存在的对象创建和对象回收问题？" class="headerlink" title="如何解决同时存在的对象创建和对象回收问题？"></a>如何解决同时存在的对象创建和对象回收问题？</h2><h2 id="JVM-中最大堆大小有没有限制？"><a href="#JVM-中最大堆大小有没有限制？" class="headerlink" title="JVM 中最大堆大小有没有限制？"></a>JVM 中最大堆大小有没有限制？</h2><h2 id="JVM-方法区存储内容-是否会动态扩展-是否会出现内存溢出-出现的原因有哪些。"><a href="#JVM-方法区存储内容-是否会动态扩展-是否会出现内存溢出-出现的原因有哪些。" class="headerlink" title="JVM 方法区存储内容 是否会动态扩展 是否会出现内存溢出 出现的原因有哪些。"></a>JVM <strong>方法区存储内容 是否会动态扩展 是否会出现内存溢出 出现的原因有</strong>哪些。</h2><h2 id="如何理解-Java-的虚函数表？"><a href="#如何理解-Java-的虚函数表？" class="headerlink" title="如何理解 Java 的虚函数表？"></a>如何理解 <strong>Java</strong> <strong>的虚函数表？</strong></h2><h2 id="Java-运行时数据区域，导致内存溢出的原因。"><a href="#Java-运行时数据区域，导致内存溢出的原因。" class="headerlink" title="Java 运行时数据区域，导致内存溢出的原因。"></a>Java 运行时数据区域，导致内存溢出的原因。</h2><h2 id="对象创建、内存布局，访问定位等。"><a href="#对象创建、内存布局，访问定位等。" class="headerlink" title="对象创建、内存布局，访问定位等。"></a>对象创建、内存布局，访问定位等。</h2><!-- flag of hidden posts -->
      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>请我喝杯奶茶吧~</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt=" WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/private/" rel="tag"># private</a>
          
            <a href="/tags/Java%E7%9F%A5%E8%AF%86%E7%82%B9/" rel="tag"># Java知识点</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">106</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">30</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:shenbh@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/ptwenzi?spm=1010.2135.3001.5113" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-clone"></i>CSDN</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/shenbh" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://gitee.com/shen_bh" target="_blank" title="Gitee">
                      
                        <i class="fa fa-fw fa-git"></i>Gitee</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Java-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%9D%A2%E8%AF%95%E9%A2%98-%EF%BC%88%E2%AD%90%E2%AD%90%E2%AD%90%EF%BC%89"><span class="nav-text">Java 虚拟机面试题 （⭐⭐⭐）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM-%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E3%80%82"><span class="nav-text">JVM 内存区域。</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JVM-%E5%9F%BA%E6%9C%AC%E6%9E%84%E6%88%90"><span class="nav-text">JVM 基本构成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E7%BA%BF%E7%A8%8B%E5%BD%B1%E5%93%8D%E5%93%AA%E5%9D%97%E5%86%85%E5%AD%98%EF%BC%9F"><span class="nav-text">开线程影响哪块内存？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM-%E7%9A%84%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%90%86%E8%A7%A3%EF%BC%9F"><span class="nav-text">JVM 的内存模型的理解？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E6%9B%B4%E5%85%A8%E9%9D%A2%E7%90%86%E8%A7%A3%E5%BB%BA%E8%AE%AE%E9%98%85%E8%AF%BB%E4%BB%A5%E4%B8%8B%E6%96%87%E7%AB%A0%EF%BC%9A"><span class="nav-text">需要更全面理解建议阅读以下文章：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0%E4%B8%80%E4%B8%8B-GC-%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E5%9B%9E%E6%94%B6%E7%AD%96%E7%95%A5%EF%BC%9F"><span class="nav-text">描述一下 GC 的原理和回收策略？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B0%E7%94%9F%E4%BB%A3%EF%BC%9A"><span class="nav-text">新生代：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%80%81%E5%B9%B4%E4%BB%A3%EF%BC%9A"><span class="nav-text">老年代：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B0%B8%E4%B9%85%E4%BB%A3%EF%BC%9A"><span class="nav-text">永久代：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8"><span class="nav-text">垃圾收集器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E5%92%8C%E5%9B%9E%E6%94%B6%E7%AD%96%E7%95%A5"><span class="nav-text">内存分配和回收策略</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%99%A8%EF%BC%8C%E5%8F%8C%E4%BA%B2%E6%9C%BA%E5%88%B6%EF%BC%8CAndroid-%E7%9A%84%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E3%80%82"><span class="nav-text">类的加载器，双亲机制，Android 的类加载器。</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="nav-text">类的加载器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E4%BA%B2%E6%9C%BA%E5%88%B6"><span class="nav-text">双亲机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Android-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="nav-text">Android 类加载器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM-%E8%B7%9F-Art%E3%80%81Dalvik-%E5%AF%B9%E6%AF%94%EF%BC%9F"><span class="nav-text">JVM 跟 Art、Dalvik 对比？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GC-%E6%94%B6%E9%9B%86%E5%99%A8%E7%AE%80%E4%BB%8B%EF%BC%9F%E4%BB%A5%E5%8F%8A%E5%AE%83%E7%9A%84%E5%86%85%E5%AD%98%E5%88%92%E5%88%86%E6%80%8E%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F"><span class="nav-text">GC 收集器简介？以及它的内存划分怎么样的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java-%E7%9A%84%E8%99%9A%E6%8B%9F%E6%9C%BA-JVM-%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%86%85%E5%AD%98%EF%BC%9A%E6%A0%88%E5%86%85%E5%AD%98%E5%92%8C%E5%A0%86%E5%86%85%E5%AD%98%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-text">Java 的虚拟机 JVM 的两个内存：栈内存和堆内存的区别是什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM-%E8%B0%83%E4%BC%98%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9FJVM-%E5%B8%B8%E8%A7%81%E7%9A%84%E8%B0%83%E4%BC%98%E5%8F%82%E6%95%B0%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="nav-text">JVM 调优的常见命令行工具有哪些？JVM 常见的调优参数有哪些？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JVM-%E8%B0%83%E4%BC%98%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4%E5%B7%A5%E5%85%B7%E5%8C%85%E6%8B%AC%EF%BC%9A"><span class="nav-text">JVM 调优的常见命令工具包括：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JVM-%E5%B8%B8%E8%A7%81%E7%9A%84%E8%B0%83%E4%BC%98%E5%8F%82%E6%95%B0%E5%8C%85%E6%8B%AC%EF%BC%9A"><span class="nav-text">JVM 常见的调优参数包括：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jstack-jmap-jutil-%E5%88%86%E5%88%AB%E7%9A%84%E6%84%8F%E4%B9%89%EF%BC%9F%E5%A6%82%E4%BD%95%E7%BA%BF%E4%B8%8A%E6%8E%92%E6%9F%A5-JVM-%E7%9A%84%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="nav-text">jstack,jmap,jutil 分别的意义？如何线上排查 JVM 的相关问题？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM%E6%96%B9%E6%B3%95%E5%8C%BA%E5%AD%98%E5%82%A8%E5%86%85%E5%AE%B9-%E6%98%AF%E5%90%A6%E4%BC%9A%E5%8A%A8%E6%80%81%E6%89%A9%E5%B1%95-%E6%98%AF%E5%90%A6%E4%BC%9A%E5%87%BA%E7%8E%B0%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA-%E5%87%BA%E7%8E%B0%E7%9A%84%E5%8E%9F%E5%9B%A0%E6%9C%89%E5%93%AA%E4%BA%9B%E3%80%82"><span class="nav-text">JVM方法区存储内容 是否会动态扩展 是否会出现内存溢出 出现的原因有哪些。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%90%8C%E6%97%B6%E5%AD%98%E5%9C%A8%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E5%92%8C%E5%AF%B9%E8%B1%A1%E5%9B%9E%E6%94%B6%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="nav-text">如何解决同时存在的对象创建和对象回收问题？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM-%E4%B8%AD%E6%9C%80%E5%A4%A7%E5%A0%86%E5%A4%A7%E5%B0%8F%E6%9C%89%E6%B2%A1%E6%9C%89%E9%99%90%E5%88%B6%EF%BC%9F"><span class="nav-text">JVM 中最大堆大小有没有限制？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JVM-%E6%96%B9%E6%B3%95%E5%8C%BA%E5%AD%98%E5%82%A8%E5%86%85%E5%AE%B9-%E6%98%AF%E5%90%A6%E4%BC%9A%E5%8A%A8%E6%80%81%E6%89%A9%E5%B1%95-%E6%98%AF%E5%90%A6%E4%BC%9A%E5%87%BA%E7%8E%B0%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA-%E5%87%BA%E7%8E%B0%E7%9A%84%E5%8E%9F%E5%9B%A0%E6%9C%89%E5%93%AA%E4%BA%9B%E3%80%82"><span class="nav-text">JVM 方法区存储内容 是否会动态扩展 是否会出现内存溢出 出现的原因有哪些。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3-Java-%E7%9A%84%E8%99%9A%E5%87%BD%E6%95%B0%E8%A1%A8%EF%BC%9F"><span class="nav-text">如何理解 Java 的虚函数表？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java-%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F%EF%BC%8C%E5%AF%BC%E8%87%B4%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E7%9A%84%E5%8E%9F%E5%9B%A0%E3%80%82"><span class="nav-text">Java 运行时数据区域，导致内存溢出的原因。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E3%80%81%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%EF%BC%8C%E8%AE%BF%E9%97%AE%E5%AE%9A%E4%BD%8D%E7%AD%89%E3%80%82"><span class="nav-text">对象创建、内存布局，访问定位等。</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">阿炳</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('Copied')
          else $(this).text('Copy failed')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('Copy')
        }, 300)
      }).append(e)
    })
  </script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>