<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="clippings," />










<meta name="description" content="常用命令多条命令执行结果不输出到终端12345678910111213141516171819202122## 使用;分隔的多条命令执行结果之间互不干扰$ ls;lls;lsDownloads  termux-packageszsh: command not found: llsDownloads  termux-packages## 使用&amp;&amp;分割的多条命令后一条会在前一条命令执行成功">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux笔记">
<meta property="og:url" content="http://shenbh.github.io/posts/e511c25d/index.html">
<meta property="og:site_name" content="积跬步">
<meta property="og:description" content="常用命令多条命令执行结果不输出到终端12345678910111213141516171819202122## 使用;分隔的多条命令执行结果之间互不干扰$ ls;lls;lsDownloads  termux-packageszsh: command not found: llsDownloads  termux-packages## 使用&amp;&amp;分割的多条命令后一条会在前一条命令执行成功">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://shenbh.github.io/posts/e511c25d/Linux%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B.png">
<meta property="og:image" content="http://shenbh.github.io/posts/e511c25d/%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6.png">
<meta property="og:image" content="http://shenbh.github.io/posts/e511c25d/%E4%B8%89%E4%B8%AA%E8%A1%A8%E7%9A%84%E5%85%B3%E7%B3%BB.png">
<meta property="og:image" content="http://shenbh.github.io/posts/e511c25d/%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E9%99%90%E5%88%B6.png">
<meta property="article:published_time" content="2025-07-03T06:59:00.196Z">
<meta property="article:modified_time" content="2025-07-03T09:26:17.763Z">
<meta property="article:author" content="阿炳">
<meta property="article:tag" content="clippings">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://shenbh.github.io/posts/e511c25d/Linux%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://shenbh.github.io/posts/e511c25d/"/>





  <title>Linux笔记 | 积跬步</title>
  








<meta name="generator" content="Hexo 6.1.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">积跬步</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Just do IT Now.</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://shenbh.github.io/posts/e511c25d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="积跬步">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Linux笔记</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-07-03T14:59:00+08:00">
                2025-07-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          
              <div class="post-description">
                  常用命令多条命令执行结果不输出到终端12345678910111213141516171819202122## 使用;分隔的多条命令执行结果之间互不干扰$ ls;lls;lsDownloads  termux-packageszsh: command not found: llsDownloads  termux-packages## 使用&&分割的多条命令后一条会在前一条命令执行成功
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="多条命令执行结果不输出到终端"><a href="#多条命令执行结果不输出到终端" class="headerlink" title="多条命令执行结果不输出到终端"></a>多条命令执行结果不输出到终端</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">使用;分隔的多条命令执行结果之间互不干扰</span><br><span class="line"></span><br><span class="line"> ls;lls;ls</span><br><span class="line"></span><br><span class="line">Downloads  termux-packages</span><br><span class="line"></span><br><span class="line">zsh: command not found: lls</span><br><span class="line"></span><br><span class="line">Downloads  termux-packages</span><br><span class="line"></span><br><span class="line"> 使用&amp;&amp;分割的多条命令后一条会在前一条命令执行成功后才执行</span><br><span class="line"></span><br><span class="line"> ls&amp;&amp;lls&amp;&amp;ls</span><br><span class="line"></span><br><span class="line">Downloads  termux-packages</span><br><span class="line"></span><br><span class="line">zsh: command not found: lls</span><br><span class="line"></span><br><span class="line"> 使用cmd &gt; /dev/null 2&gt;&amp;1将输出重定向到null，即不输出到终端</span><br><span class="line"></span><br><span class="line"> 使用if [ $? -ne 0 ]; then echo 1; else echo 0;fi;可以得到上一条命令的执行结果（$?表示上一条命令的执行结果）</span><br><span class="line"></span><br><span class="line"> ls &gt; /dev/null 2&gt;&amp;1;if [ $? -ne 0 ]; then echo 1; else echo 0;fi;</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"> 使用&#123;&#125;包裹起来的多条命令</span><br><span class="line"></span><br><span class="line"> &#123;ls&amp;&amp;ls&amp;&amp;ls&#125; &gt; /dev/null 2&gt;&amp;1;if [ $? -ne 0 ]; then echo 1; else echo 0;fi;</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"> echo指定-e参数可开启转移，添加/c可不换行输出</span><br><span class="line"></span><br><span class="line"> echo -e &quot;please input a value:\c&quot;;</span><br></pre></td></tr></table></figure>

<h3 id="后台运行"><a href="#后台运行" class="headerlink" title="后台运行"></a>后台运行</h3><p>当用户注销（logout）或者网络断开时，终端会收到 HUP（hangup）信号从而关闭其所有子进程。因此，解决办法有两种途径：</p>
<ul>
<li>让进程忽略 HUP 信号；</li>
<li>让进程运行在新的会话里从而成为不属于此终端的子进程。</li>
</ul>
<h4 id="nohup"><a href="#nohup" class="headerlink" title="nohup"></a>nohup</h4><p>nohup 的用途就是让提交的命令忽略 hangup 信号，一般我们可在结尾加上”&amp;”来将命令同时放入后台运行，也可用”&gt;filename 2&gt;&amp;1”来更改缺省的重定向文件名。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nohup ping www.baidu.com &amp;</span><br><span class="line"></span><br><span class="line">[1] 3059</span><br><span class="line"></span><br><span class="line">nohup: appending output to &#x27;nohup.out&#x27;</span><br><span class="line"></span><br><span class="line"> ps -ef |grep 3059</span><br><span class="line"></span><br><span class="line">root      3059   984  0 21:06 pts/3    00:00:00 ping www.baidu.com</span><br><span class="line"></span><br><span class="line">root      3067   984  0 21:06 pts/3    00:00:00 grep 3059</span><br></pre></td></tr></table></figure>

<h4 id="setsid"><a href="#setsid" class="headerlink" title="setsid"></a>setsid</h4><p>换个角度思考，如果我们的进程不属于接受 HUP 信号的终端的子进程，那么自然也就不会受到 HUP 信号的影响了。setsid 就能做到这一点。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">setsid ping www.baidu.com</span><br><span class="line"></span><br><span class="line"> ps -ef |grep www.baidu.com</span><br><span class="line"></span><br><span class="line">root     31094     1  0 07:28 ?        00:00:00 ping www.baidu.com</span><br><span class="line"></span><br><span class="line">root     31102 29217  0 07:29 pts/4    00:00:00 grep www.baidu.com</span><br></pre></td></tr></table></figure>

<p>进程 ID(PID)为31094，而它的父 ID（PPID）为1（即为 init 进程 ID），并不是当前终端的进程 ID。</p>
<h4 id="amp"><a href="#amp" class="headerlink" title="&amp;"></a>&amp;</h4><p>将一个或多个命名包含在 <code>()</code> 中就能让这些命令在子 shell 中运行中，从而扩展出很多有趣的功能。</p>
<p>当我们将 <code>&amp;</code> 也放入 <code>()</code> 内之后，就会发现所提交的作业并不在作业列表中，也就是说，是无法通过jobs来查看的。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(ping www.baidu.com &amp;)</span><br><span class="line"></span><br><span class="line"> ps -ef |grep www.baidu.com</span><br><span class="line"></span><br><span class="line">root     16270     1  0 14:13 pts/4    00:00:00 ping www.baidu.com</span><br><span class="line"></span><br><span class="line">root     16278 15362  0 14:13 pts/4    00:00:00 grep www.baidu.com</span><br></pre></td></tr></table></figure>

<p>从上例中可以看出，新提交的进程的父 ID（PPID）为1（init 进程的 PID），并不是当前终端的进程 ID。因此并不属于当前终端的子进程，从而也就不会受到当前终端的 HUP 信号的影响了。</p>
<h3 id="查看进程"><a href="#查看进程" class="headerlink" title="查看进程"></a>查看进程</h3><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><ul>
<li>VSS - Virtual Set Size 虚拟耗用内存（包含共享库占用的内存），一个进程总共可访问的地址空间。其大小还包括了可能不在RAM中的内存（比如虽然malloc分配了空间，但尚未写入）。 VSS 很少被用于判断一个进程的真实内存使用量。</li>
<li>RSS - Resident Set Size 实际使用物理内存（包含共享库占用的内存），一个进程在RAM中真实存储的总内存。但是RSS还是可能会造成误导，因为它仅仅表示该进程所使用的所有共享库的大小，它不管有多少个进程使用该共享库，该共享库仅被加载到内存一次。所以RSS并不能准确反映单进程的内存占用情况。</li>
<li>PSS - Proportional Set Size 实际使用的物理内存（比例分配共享库占用的内存），按比例表示使用的共享库， 例如：如果有三个进程都使用了一个共享库，共占用了30页内存。那么PSS将认为每个进程分别占用该共享库10页的大小。 PSS是非常有用的数据，因为系统中所有进程的PSS都相加的话，就刚好反映了系统中的总共占用的内存。 而当一个进程被销毁之后， 其占用的共享库那部分比例的PSS，将会再次按比例分配给余下使用该库的进程。这样PSS可能会造成一点的误导，因为当一个进程被销毁后，PSS不能准确地表示返回给全局系统的内存（the memory returned to the overall system）。</li>
<li>USS - Unique Set Size 进程独自占用的物理内存（不包含共享库占用的内存），一个进程所占用的私有内存。即该进程独占的内存。 USS是非常非常有用的数据，因为它反映了运行一个特定进程真实的边际成本（增量成本）。当一个进程被销毁后，USS是真实返回给系统的内存。当进程中存在一个可疑的内存泄露时，USS是最佳观察数据。</li>
</ul>
<p>一般来说内存占用大小有如下规律：VSS &gt;&#x3D; RSS &gt;&#x3D; PSS &gt;&#x3D; USS</p>
<h4 id="free"><a href="#free" class="headerlink" title="free"></a>free</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">free -h</span><br><span class="line"></span><br><span class="line">       total       used        free      shared  buff/cache   available</span><br><span class="line"></span><br><span class="line">Mem:   7.9G        6.6G        1.0G         17M        223M        1.1G</span><br><span class="line"></span><br><span class="line">Swap:  19G         566M         19G</span><br></pre></td></tr></table></figure>

<h4 id="top"><a href="#top" class="headerlink" title="top"></a>top</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">得到进程的pid</span><br><span class="line"></span><br><span class="line"> pidof sleep</span><br><span class="line"></span><br><span class="line">602</span><br><span class="line"></span><br><span class="line"> top指定查看PID</span><br><span class="line"></span><br><span class="line"> top -p 602</span><br><span class="line"></span><br><span class="line">top - 11:01:36 up 23 min,  0 users,  load average: 0.52, 0.58, 0.59</span><br><span class="line"></span><br><span class="line">Tasks:   1 total,   0 running,   1 sleeping,   0 stopped,   0 zombie</span><br><span class="line"></span><br><span class="line">Cpu(s):  0.7 us,  0.9 sy,  0.0 ni, 98.2 id,  0.0 wa,  0.2 hi,  0.0 si,  0.0 st</span><br><span class="line"></span><br><span class="line">KiB Mem :  8266588 total,  2224708 free,  5812528 used,   229352 buff/cache</span><br><span class="line"></span><br><span class="line">KiB Swap: 20680852 total, 19784620 free,   896232 used.  2320328 avail Mem</span><br><span class="line"></span><br><span class="line">PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND</span><br><span class="line"></span><br><span class="line">602 hearing   15 42+   13956    808    688 S   0.0  0.0   0:00.01 sleep</span><br><span class="line"></span><br><span class="line"> top查看某些指定的PID</span><br><span class="line"></span><br><span class="line"> top -p 602,666,1001</span><br></pre></td></tr></table></figure>
<ul>
<li>键入 <code>P</code> 按照CPU排序输出</li>
<li>键入 <code>M</code> 按照内存排序输出</li>
</ul>
<h4 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h4><p>ps是显示瞬间进程的状态，并不动态连续；如果想对进程进行实时监控应该用top命令。如果输出较多可以结合less命令和管道来使用，即 <code>ps -ef | less</code> 。</p>
<ul>
<li>-A：所有的进程均显示出来，与 -e 具有同样的效用</li>
<li>-a：显示现行终端机下的所有进程，包括其他用户的进程</li>
<li>-u：以用户为主的进程状态&#x2F;以针对用户的格式输出</li>
<li>-x：通常与 a 这个参数一起使用，可列出较完整信息</li>
<li>-l：较长、较详细的将该PID 的的信息列出；</li>
<li>-j：工作的格式 (jobs format)</li>
<li>-f：做一个更为完整的输出。<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">根据CPU使用率来升序排序</span><br><span class="line"></span><br><span class="line"> ps -aux --sort -pcpu | less</span><br><span class="line"></span><br><span class="line"> 根据内存使用率来升序排序</span><br><span class="line"></span><br><span class="line"> ps -aux --sort -pmem | less</span><br><span class="line"></span><br><span class="line"> 合并命令，并通过管道显示前10个结果</span><br><span class="line"></span><br><span class="line"> ps -aux --sort -pcpu,+pmem | head -n 10</span><br></pre></td></tr></table></figure></li>
</ul>
<p>可以使用 <code>-C</code> 参数查看指定进程的信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ps -f -C sleep</span><br><span class="line"></span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line"></span><br><span class="line">hearing    348     7  0 10:45 tty1     00:00:00 sleep 555</span><br></pre></td></tr></table></figure>

<p>也可以结合 <code>watch</code> 命令实时查看信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">每秒执行一次ps -aux --sort -pmem, -pcpu</span><br><span class="line"></span><br><span class="line"> watch -n 1 &#x27;ps -aux --sort -pmem, -pcpu&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="proc"><a href="#proc" class="headerlink" title="proc"></a>proc</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/$pid/status</span><br><span class="line"></span><br><span class="line">Name:    main</span><br><span class="line"></span><br><span class="line">State:    S (sleeping)</span><br><span class="line"></span><br><span class="line">Tgid:    24154</span><br><span class="line"></span><br><span class="line">Pid:    24154</span><br><span class="line"></span><br><span class="line">PPid:    1</span><br><span class="line"></span><br><span class="line">TracerPid:    0</span><br><span class="line"></span><br><span class="line">Uid:    2000    2000    2000    2000</span><br><span class="line"></span><br><span class="line">Gid:    2000    2000    2000    2000</span><br><span class="line"></span><br><span class="line">FDSize:    32</span><br><span class="line"></span><br><span class="line">Groups:    1004 1007 1011 1015 1028 3001 3002 3003 3006</span><br><span class="line"></span><br><span class="line">VmPeak:      777484 kB</span><br><span class="line"></span><br><span class="line">VmSize:      777484 kB</span><br><span class="line"></span><br><span class="line">VmLck:           0 kB</span><br><span class="line"></span><br><span class="line">VmPin:           0 kB</span><br><span class="line"></span><br><span class="line">VmHWM:       26960 kB</span><br><span class="line"></span><br><span class="line">VmRSS:       26960 kB</span><br><span class="line"></span><br><span class="line">VmData:       11680 kB</span><br><span class="line"></span><br><span class="line">VmStk:        8192 kB</span><br><span class="line"></span><br><span class="line">VmExe:          12 kB</span><br><span class="line"></span><br><span class="line">VmLib:       52812 kB</span><br><span class="line"></span><br><span class="line">VmPTE:         134 kB</span><br><span class="line"></span><br><span class="line">VmSwap:           0 kB</span><br><span class="line"></span><br><span class="line">Threads:    13</span><br><span class="line"></span><br><span class="line">SigQ:    0/6947</span><br><span class="line"></span><br><span class="line">SigPnd:    0000000000000000</span><br><span class="line"></span><br><span class="line">ShdPnd:    0000000000000000</span><br><span class="line"></span><br><span class="line">SigBlk:    0000000000001204</span><br><span class="line"></span><br><span class="line">SigIgn:    0000000000000001</span><br><span class="line"></span><br><span class="line">SigCgt:    00000002000094f8</span><br><span class="line"></span><br><span class="line">CapInh:    0000000000000000</span><br><span class="line"></span><br><span class="line">CapPrm:    0000000000000000</span><br><span class="line"></span><br><span class="line">CapEff:    0000000000000000</span><br><span class="line"></span><br><span class="line">CapBnd:    00000000000000c0</span><br><span class="line"></span><br><span class="line">Seccomp:    0</span><br><span class="line"></span><br><span class="line">Cpus_allowed:    f</span><br><span class="line"></span><br><span class="line">Cpus_allowed_list:    0-3</span><br><span class="line"></span><br><span class="line">voluntary_ctxt_switches:    18</span><br><span class="line"></span><br><span class="line">nonvoluntary_ctxt_switches:    76</span><br></pre></td></tr></table></figure>

<h4 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h4><h5 id="procrank"><a href="#procrank" class="headerlink" title="procrank"></a>procrank</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">rocrank</span><br><span class="line"></span><br><span class="line">  PID      Vss      Rss      Pss      Uss  cmdline</span><br><span class="line"></span><br><span class="line"> 1078   59840K   59708K   42125K   39344K  com.csr.BTApp</span><br><span class="line"></span><br><span class="line"> 2683   59124K   59040K   37960K   33032K  com.android.launcher</span><br><span class="line"></span><br><span class="line"> 1042   51572K   51488K   35686K   33604K  android.process.acore</span><br><span class="line"></span><br><span class="line">  782   32808K   32748K   16775K   14716K  system_server</span><br><span class="line"></span><br><span class="line">  667   20560K   17560K   12739K    8940K  /system/bin/surfaceflinger</span><br><span class="line"></span><br><span class="line">  851   30124K   30036K   12085K    7996K  com.android.systemui</span><br><span class="line"></span><br><span class="line"> 2999   27680K   27596K    9929K    7040K  com.baidu.input</span><br><span class="line"></span><br><span class="line">  959   20764K   20676K    5522K    3788K  com.android.phone</span><br><span class="line"></span><br><span class="line"> 3468   21892K   21800K    4591K    1920K  com.apical.dreamthemetime</span><br><span class="line"></span><br><span class="line">  982   19880K   19792K    4438K    2644K  com.csr.csrservices</span><br><span class="line"></span><br><span class="line">  668   19592K   19480K    3525K    1360K  zygote</span><br><span class="line"></span><br><span class="line">  670    2960K    2960K    2407K    2356K  /system/bin/mediaserver</span><br><span class="line"></span><br><span class="line">  663    1784K    1784K    1209K    1116K  /system/bin/synergy_service</span><br><span class="line"></span><br><span class="line">  756    3404K    1348K    1133K    1124K  /usr/bin/gpsexe</span><br><span class="line"></span><br><span class="line">  669    1468K    1468K     959K     928K  /system/bin/drmserver</span><br><span class="line"></span><br><span class="line">  675     692K     692K     692K     692K  /bin/sh</span><br><span class="line"></span><br><span class="line"> 3482     656K     652K     456K     444K  procrank</span><br><span class="line"></span><br><span class="line">    1     164K     164K     144K     144K  /init</span><br><span class="line"></span><br><span class="line">                          ------   ------  ------</span><br><span class="line"></span><br><span class="line">                         195031K  163724K  TOTAL</span><br><span class="line"></span><br><span class="line">RAM: 480380K total, 3624K free, 732K buffers, 299788K cached, 264844K shmem, 7632K slab</span><br></pre></td></tr></table></figure>

<h5 id="dumpsys"><a href="#dumpsys" class="headerlink" title="dumpsys"></a>dumpsys</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dumpsys [options]</span><br><span class="line"></span><br><span class="line">        meminfo 显示内存信息</span><br><span class="line"></span><br><span class="line">        cpuinfo 显示CPU信息</span><br><span class="line"></span><br><span class="line">        account 显示accounts信息</span><br><span class="line"></span><br><span class="line">        activity 显示所有的activities的信息</span><br><span class="line"></span><br><span class="line">        window 显示键盘，窗口和它们的关系</span><br><span class="line"></span><br><span class="line">        wifi 显示wifi信息</span><br></pre></td></tr></table></figure>

<p>可以在其后通过包名或者进程pid展示指定进程的信息。</p>
<h2 id="UNIX与Linux"><a href="#UNIX与Linux" class="headerlink" title="UNIX与Linux"></a>UNIX与Linux</h2><p>Linux 是一个类似 Unix 的操作系统（类UNIX系统），Unix 要早于 Linux，Linux 的初衷就是要替代 UNIX，并在功能和用户体验上进行优化，所以 Linux 模仿了 UNIX（但并没有抄袭 UNIX 的源码），使得 Linux 在外观和交互上与 UNIX 非常类似。</p>
<p>二者的区别：</p>
<ul>
<li>UNIX 系统大多是与硬件配套的，也就是说，大多数 UNIX 系统如 AIX、HP-UX 等是无法安装在 x86 服务器和个人计算机上的，而 Linux 则可以运行在多种硬件平台上；</li>
<li>UNIX 是商业软件，而 Linux 是开源软件，是免费、公开源代码的。</li>
</ul>
<p>UNIX&#x2F;Linux系统结构：可以粗糙地抽象为 3 个层次：底层是 UNIX&#x2F;Linux 操作系统，即系统内核（Kernel）；中间层是 Shell 层，即命令解释层；高层则是应用层。</p>
<ol>
<li>内核层：内核层是 UNIX&#x2F;Linux 系统的核心和基础，它直接附着在硬件平台之上，控制和管理系统内各种资源（硬件资源和软件资源），有效地组织进程的运行，从而扩展硬件的功能，提高资源的利用效率，为用户提供方便、高效、安全、可靠的应用环境。Linux 内核由如下几部分组成：内存管理、进程管理、设备驱动程序、文件系统和网络管理等。</li>
<li>Shell层：Shell 层是与用户直接交互的界面。用户可以在提示符下输入命令行，由 Shell 解释执行并输出相应结果或者有关信息，所以我们也把 Shell 称作命令解释器，利用系统提供的丰富命令可以快捷而简便地完成许多工作。目前主要有下列版本的shell：<ul>
<li>Bourne Shell(sh)：贝尔实验室开发的</li>
<li>Bourne Again Shell(bash)：GNU操作系统上默认的shell，大部分linux的发行套件使用的都是这种shell</li>
<li>Korn Shell：是对Bourne SHell的发展，在大部分内容上与Bourne Shell兼容</li>
<li>C Shell：是SUN公司Shell的BSD版本</li>
</ul>
</li>
<li>应用层：应用层提供基于 X Window 协议的图形环境。X Window 协议定义了一个系统所必须具备的功能，可系统能满足此协议及符合 X 协会其他的规范，便可称为 X Window。</li>
</ol>
<h2 id="Linux内核与发行版"><a href="#Linux内核与发行版" class="headerlink" title="Linux内核与发行版"></a>Linux内核与发行版</h2><p>Linux内核是计算机操作系统的核心。一个完整的 Linux发行版包括了内核与一些其他与文件相关的操作，用户管理系统，和软件包管理器等一系列软件。每个工具都是整个系统的一小部分。这些工具通常都是一个个独立的项目，有相应的开发者来开发及维护。</p>
<p>Linux的众多发行版可能是基于不同的内核版本的。例如：流行的 RHEL6发行版是基于很老但是很稳定的 2.6.32 版本的Linux内核的。其他的一些发行版可能会很快的更新以适应最新的内核版本。需要特别注意的一点是，内核并不是一个非此即彼的命题，例如RHEL6就在2.6.32的内核中引进了新版本内核的许多改进。</p>
<p>各发行版提供的其他基本工具和组成部分还有包括以下的内容：C&#x2F;C++编译器，gdbdebugger 调试工具，核心系统库应用程序，用于在屏幕上绘图的底层接口以及高级的桌面环境，以及供安装和更新包括内核在内的众多组建的系统</p>
<p>Debian是包括Ubuntu在内许多发行版的上游，而Ubuntu又是Linux Mint及其他发行版的上游。Debian在服务器和桌面电脑领域都有着广泛的应用。Debian是一个纯开源计划并着重在一个关键点上，稳定性。它同时也提供了最大的和完整的软件仓库给用户。</p>
<h2 id="Android与Linux"><a href="#Android与Linux" class="headerlink" title="Android与Linux"></a>Android与Linux</h2><ul>
<li>Android采用Linux作为内核</li>
<li>Android对Linux内核做了修改，目的是适应在移动设备上使用</li>
<li>Android开始作为Linux的一个分支，后来由于无法并入Linux的主开发树，已被Linux Kernel小组从开发树中删除</li>
</ul>
<p>Android是在Linux内核基础上运行的，提供的核心系统服务包括安全、内存管理、进程管理、网络组和驱动模型等内容。在硬件层和系统中其他软件之间添加了硬件抽象层（HAL），严格上来说Android不算是Linux系统</p>
<p>Android内核是有标准的Linux内核修改而来的，继承了Linux内核的诸多优点，保留了Linux内核的主题框架，同时Android按照移动设备的要求，在文件系统、内存管理、进程间通信机智和电源管理方面进行了修改，添加了相关的驱动程序和必要的新功能。Android在很大程度上保留了Linux的基本架构。</p>
<h2 id="GNU"><a href="#GNU" class="headerlink" title="GNU"></a>GNU</h2><p>GPL：GNU通用公共许可协议（英语：GNU General Public License，缩写GNU GPL 或 GPL），是被广泛使用的自由软件许可证，给予了终端用户运行、学习、共享和修改软件的自由。</p>
<p>GNU是一个自由的操作系统，其内容软件完全以GPL方式发布。这个操作系统是GNU计划的主要目标，名称来自GNU’s Not Unix!的递归缩写，因为GNU的设计类似Unix，但它不包含具著作权的Unix代码。GNU的创始人，理查德·马修·斯托曼，将GNU视为“达成社会目的技术方法”。</p>
<p>作为操作系统，GNU的发展仍未完成，其中最大的问题是具有完备功能的内核尚未被开发成功。GNU的内核，称为Hurd，是自由软件基金会发展的重点，但是其发展尚未成熟。在实际使用上，多半使用Linux内核、FreeBSD等替代方案，作为系统核心，其中主要的操作系统是Linux的发行版。Linux操作系统包涵了Linux内核与其他自由软件项目中的GNU组件和软件，可以被称为GNU&#x2F;Linux。</p>
<p>GNU&#x2F;Linux命名争议，是在自由及开放源代码软件社群成员内的，关于是应该把使用GNU软件与Linux内核组合之操作系统称为“GNU&#x2F;Linux”还是“Linux”的争议。</p>
<p>GNU&#x2F;Linux这一名称是由自由软件基金会的创立者与GNU计划的发起人理查德·斯托曼所提出的。GNU的开发者与其支持者，希望以该名称来作为此操作系统的正式名称。他们认为，此操作系统，包括了GNU系统软件包与Linux kernel，使用GNU&#x2F;Linux这个名称，可以良好概括它的主要内容。况且，GNU项目原本就是以发展一个自由的操作系统为远程项目，但迟迟没有完成。而Linux kernel的出现刚好可以补足这个缺口。</p>
<p>Linux内核本身并不是GNU计划的一部分，GNU&#x2F;Linux这个名称在Linux社群中并没有得到一致认同。一些发行版社群例如Debian采用了GNU&#x2F;Linux这一名称，但许多Linux社群中的成员认为使用Linux这一名称是更好的，为此提出了数项理由，主张Linux这个名称朗朗上口，且在公众与媒体中更为通用。Linux内核项目的发起人林纳斯·托瓦兹（Linus Torvalds）偏好于使用Linux，但对于GNU&#x2F;Linux这个名字并不强烈反感。</p>
<h2 id="一切皆文件"><a href="#一切皆文件" class="headerlink" title="一切皆文件"></a>一切皆文件</h2><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>linux&#x2F;unix下的哲学核心思想是 <strong>一切皆文件</strong> 。它指的是，对所有文件（目录、字符设备、块设备、套接字、打印机、进程、线程、管道等）操作，读写都可用 <code>fopen()/fclose()/fwrite()/fread()</code> 等函数进行处理，屏蔽了硬件的区别，所有设备都抽象成文件，提供统一的接口给用户，虽然类型各不相同，但是对其提供的却是同一套操作界面，更进一步，对文件的操作也可以跨文件系统执行。</p>
<p>操作一个已经打开的文件：使用文件描述符（file descriptor），简称fd，它是一个对应某个已经打开的文件的索引（非负整数）。</p>
<p>Windows的内部实现也近似于“一切皆文件”的思想，当然，这一切都只在内核里才有，下载一个WinObj这软件就可以看到，Windows上各种设备、分区、虚拟对象都是挂载到根“\”下的，通过这个树可以访问各种设备、驱动、文件系统等。</p>
<p>Windows与Linux不同的就是把这些对象又重新封装了一层WindowsAPI，对外以设备、盘符、文件等等表现出来，重新封装WindowsAPI的目的是为了兼容性，而设备、盘符、文件这些是为了让普通用户更好理解。</p>
<h3 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h3><p><img src="/posts/e511c25d/Linux%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B.png" alt="Linux文件类型"></p>
<h2 id="Inode"><a href="#Inode" class="headerlink" title="Inode"></a>Inode</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p>inode是一个重要概念，是理解Unix&#x2F;Linux文件系统和硬盘储存的基础。</p>
<p>文件储存在硬盘上，硬盘的最小存储单位叫做”扇区”（Sector）。每个扇区储存512字节（相当于0.5KB）。操作系统读取硬盘的时候，不会一个个扇区地读取，这样效率太低，而是一次性连续读取多个扇区，即一次性读取一个”块”（block）。这种由多个扇区组成的”块”，是文件存取的最小单位。”块”的大小，最常见的是4KB，即连续八个 sector组成一个 block。</p>
<p>文件数据都储存在”块”中，那么很显然，我们还必须找到一个地方储存文件的元信息，比如文件的创建者、文件的创建日期、文件的大小等等。这种储存文件元信息的区域就叫做inode，中文译名为”索引节点”。每一个文件都有对应的inode，里面包含了与该文件有关的一些信息。</p>
<h3 id="inode的内容"><a href="#inode的内容" class="headerlink" title="inode的内容"></a>inode的内容</h3><p>inode包含文件的元信息，具体来说有以下内容：</p>
<ul>
<li>文件的字节数</li>
<li>文件拥有者的User ID</li>
<li>文件的Group ID</li>
<li>文件的读、写、执行权限</li>
<li>文件的时间戳，共有三个：ctime指inode上一次变动的时间，mtime指文件内容上一次变动的时间，atime指文件上一次打开的时间。</li>
<li>链接数，即有多少文件名指向这个inode</li>
<li>文件数据block的位置</li>
</ul>
<p>可以用stat命令，查看某个文件的inode信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">stat README.md</span><br><span class="line"></span><br><span class="line">  File: README.md</span><br><span class="line"></span><br><span class="line">  Size: 15              Blocks: 0          IO Block: 4096   regular file</span><br><span class="line"></span><br><span class="line">Device: fh/15d  Inode: 30680772461790950  Links: 1</span><br><span class="line"></span><br><span class="line">Access: (0777/-rwxrwxrwx)  Uid: ( 1000/ hearing)   Gid: ( 1000/ hearing)</span><br><span class="line"></span><br><span class="line">Access: 2019-08-16 20:56:58.121431000 +0800</span><br><span class="line"></span><br><span class="line">Modify: 2019-08-16 20:56:58.121431000 +0800</span><br><span class="line"></span><br><span class="line">Change: 2019-08-16 20:56:58.121431000 +0800</span><br><span class="line"></span><br><span class="line"> Birth: -</span><br></pre></td></tr></table></figure>

<p>总之，除了文件名以外的所有文件信息，都存在inode之中。至于为什么没有文件名，下文会有详细解释。</p>
<h3 id="inode的大小"><a href="#inode的大小" class="headerlink" title="inode的大小"></a>inode的大小</h3><p>inode也会消耗硬盘空间，所以硬盘格式化的时候，操作系统自动将硬盘分成两个区域。一个是数据区，存放文件数据；另一个是inode区（inode table），存放inode所包含的信息。</p>
<p>每个inode节点的大小，一般是128字节或256字节。inode节点的总数，在格式化时就给定，一般是每1KB或每2KB就设置一个inode。假定在一块1GB的硬盘中，每个inode节点的大小为128字节，每1KB就设置一个inode，那么inode table的大小就会达到128MB，占整块硬盘的12.8%。</p>
<p>查看每个硬盘分区的inode总数和已经使用的数量，可以使用 <code>df -i</code> 命令。</p>
<p>查看每个inode节点的大小，可以用如下命令： <code>sudo dumpe2fs -h /dev/hda | grep &quot;Inode size&quot;</code></p>
<p>由于每个文件都必须有一个inode，因此有可能发生inode已经用光，但是硬盘还未存满的情况。这时，就无法在硬盘上创建新文件。</p>
<h3 id="inode号码"><a href="#inode号码" class="headerlink" title="inode号码"></a>inode号码</h3><p>每个inode都有一个号码，操作系统用inode号码来识别不同的文件。Unix&#x2F;Linux系统内部不使用文件名，而使用inode号码来识别文件。对于系统来说，文件名只是inode号码便于识别的别称或者绰号。</p>
<p>表面上，用户通过文件名，打开文件。实际上，系统内部这个过程分成三步：首先，系统找到这个文件名对应的inode号码；其次，通过inode号码，获取inode信息；最后，根据inode信息，找到文件数据所在的block，读出数据。</p>
<p>使用ls -i命令，可以看到文件名对应的inode号码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -i README.md</span><br><span class="line"></span><br><span class="line">30680772461790950 README.md</span><br></pre></td></tr></table></figure>

<h3 id="目录文件"><a href="#目录文件" class="headerlink" title="目录文件"></a>目录文件</h3><p>Unix&#x2F;Linux系统中，目录（directory）也是一种文件。打开目录，实际上就是打开目录文件。</p>
<p>目录文件的结构非常简单，就是一系列目录项（dirent）的列表。每个目录项，由两部分组成：所包含文件的文件名，以及该文件名对应的inode号码。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">ls命令只列出目录文件中的所有文件名：</span><br><span class="line"></span><br><span class="line"> ls</span><br><span class="line"></span><br><span class="line">HybridAccessory  README.md  _config.yml  db.json  gulpfile.js  node_modules  package-lock.json  package.json  scaffolds  source  themes</span><br><span class="line"></span><br><span class="line"> ls -i命令列出整个目录文件，即文件名和inode号码：</span><br><span class="line"></span><br><span class="line"> ls -i</span><br><span class="line"></span><br><span class="line">  281474976845551 HybridAccessory   5348024557503872 db.json         281474976858064 package-lock.json    281474976858853 source</span><br><span class="line"></span><br><span class="line">30680772461790950 README.md          281474976845560 gulpfile.js     281474976858065 package.json         281474976859117 themes</span><br><span class="line"></span><br><span class="line"> 1125899906905575 _config.yml        281474976845561 node_modules    281474976858849 scaffolds</span><br><span class="line"></span><br><span class="line"> ls -l命令列出文件的详细信息：</span><br><span class="line"></span><br><span class="line"> ls -l</span><br><span class="line"></span><br><span class="line">total 280</span><br><span class="line"></span><br><span class="line">drwxrwxrwx 1 hearing hearing   4096 Jul 22 14:06 HybridAccessory</span><br><span class="line"></span><br><span class="line">-rwxrwxrwx 1 hearing hearing     15 Aug 16 20:56 README.md</span><br><span class="line"></span><br><span class="line">-rwxrwxrwx 1 hearing hearing   2189 Aug 19 12:34 _config.yml</span><br><span class="line"></span><br><span class="line">-rwxrwxrwx 1 hearing hearing    174 Aug 27 17:55 db.json</span><br><span class="line"></span><br><span class="line">-rwxrwxrwx 1 hearing hearing   1596 Jul 22 14:06 gulpfile.js</span><br><span class="line"></span><br><span class="line">drwxrwxrwx 1 hearing hearing   4096 Jul 22 14:06 node_modules</span><br><span class="line"></span><br><span class="line">-rwxrwxrwx 1 hearing hearing 277830 Jul 22 14:06 package-lock.json</span><br><span class="line"></span><br><span class="line">-rwxrwxrwx 1 hearing hearing    686 Jul 22 14:06 package.json</span><br><span class="line"></span><br><span class="line">drwxrwxrwx 1 hearing hearing   4096 Jul 22 14:06 scaffolds</span><br><span class="line"></span><br><span class="line">drwxrwxrwx 1 hearing hearing   4096 Jul 29 11:35 source</span><br><span class="line"></span><br><span class="line">drwxrwxrwx 1 hearing hearing   4096 Aug 16 20:51 themes</span><br></pre></td></tr></table></figure>

<p>目录文件的读权限（r）和写权限（w），都是针对目录文件本身。由于目录文件内只有文件名和inode号码，所以如果只有读权限，只能获取文件名，无法获取其他信息，因为其他信息都储存在inode节点中，而读取inode节点内的信息需要目录文件的执行权限（x）。</p>
<p>查看目录大小：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">du -h --max-depth=1</span><br><span class="line"></span><br><span class="line"> du -h -d 1</span><br></pre></td></tr></table></figure>

<h3 id="硬链接"><a href="#硬链接" class="headerlink" title="硬链接"></a>硬链接</h3><p>一般情况下，文件名和inode号码是”一一对应”关系，每个inode号码对应一个文件名。但是，Unix&#x2F;Linux系统允许，多个文件名指向同一个inode号码。</p>
<p>这意味着，可以用不同的文件名访问同样的内容；对文件内容进行修改，会影响到所有文件名；但是，删除一个文件名，不影响另一个文件名的访问。这种情况就被称为”硬链接”（hard link）。</p>
<p>ln命令可以创建硬链接： <code>ln 源文件 目标文件</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ls -li</span><br><span class="line"></span><br><span class="line">total 0</span><br><span class="line"></span><br><span class="line">16044073672577795 drwxrwxrwx 1 hearing hearing 4096 Aug 27 18:07 test</span><br><span class="line"></span><br><span class="line">14918173765727074 -rw-rw-rw- 1 hearing hearing    0 Aug 27 18:06 test.txt</span><br><span class="line"></span><br><span class="line"> ln test.txt test1</span><br><span class="line"></span><br><span class="line"> ls -li</span><br><span class="line"></span><br><span class="line">total 0</span><br><span class="line"></span><br><span class="line">16044073672577795 drwxrwxrwx 1 hearing hearing 4096 Aug 27 18:07 test</span><br><span class="line"></span><br><span class="line">14918173765727074 -rw-rw-rw- 2 hearing hearing    0 Aug 27 18:06 test.txt</span><br><span class="line"></span><br><span class="line">14918173765727074 -rw-rw-rw- 2 hearing hearing    0 Aug 27 18:06 test1</span><br></pre></td></tr></table></figure>

<p>运行上面这条命令以后，源文件与目标文件的inode号码相同，都指向同一个inode。inode信息中有一项叫做”链接数”，记录指向该inode的文件名总数，这时就会增加1。反过来，删除一个文件名，就会使得inode节点中的”链接数”减1。当这个值减到0，表明没有文件名指向这个inode，系统就会回收这个inode号码，以及其所对应block区域。</p>
<p>创建目录时，默认会生成两个目录项：”.”和”..”。前者的inode号码就是当前目录的inode号码，等同于当前目录的”硬链接”；后者的inode号码就是当前目录的父目录的inode号码，等同于父目录的”硬链接”。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ls -ai</span><br><span class="line"></span><br><span class="line"> 9570149208327005 .   1970324837227736 ..  16044073672577795 test   4785074604151560 test2</span><br><span class="line"></span><br><span class="line"> ls -i ../</span><br><span class="line"></span><br><span class="line"> 9570149208327005 Downloads</span><br></pre></td></tr></table></figure>

<p>目录不能创建硬链接（hard link not allowed for directory）。</p>
<h3 id="软链接-快捷方式"><a href="#软链接-快捷方式" class="headerlink" title="软链接(快捷方式)"></a>软链接(快捷方式)</h3><p>文件A和文件B的inode号码虽然不一样，但是文件A的内容是文件B的路径。读取文件A时，系统会自动将访问者导向文件B。因此，无论打开哪一个文件，最终读取的都是文件B。这时，文件A就称为文件B的”软链接”（soft link）或者”符号链接（symbolic link）。</p>
<p>这意味着，文件A依赖于文件B而存在，如果删除了文件B，打开文件A就会报错：”No such file or directory”。这是软链接与硬链接最大的不同：文件A指向文件B的文件名，而不是文件B的inode号码，文件B的inode”链接数”不会因此发生变化。</p>
<p>ln -s命令可以创建软链接： <code>ln -s 源文文件或目录 目标文件或目录</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ln -s test2 test1</span><br><span class="line"></span><br><span class="line"> ls -l</span><br><span class="line"></span><br><span class="line">total 0</span><br><span class="line"></span><br><span class="line">drwxrwxrwx 1 hearing hearing 4096 Aug 27 18:07 test</span><br><span class="line"></span><br><span class="line">lrwxrwxrwx 1 hearing hearing    5 Aug 27 18:17 test1 -&gt; test2</span><br><span class="line"></span><br><span class="line">-rw-rw-rw- 1 hearing hearing    5 Aug 27 18:09 test2</span><br></pre></td></tr></table></figure>

<h3 id="inode的特殊作用"><a href="#inode的特殊作用" class="headerlink" title="inode的特殊作用"></a>inode的特殊作用</h3><p>由于inode号码与文件名分离，这种机制导致了一些Unix&#x2F;Linux系统特有的现象。</p>
<ol>
<li>有时，文件名包含特殊字符，无法正常删除。这时，直接删除inode节点，就能起到删除文件的作用。</li>
<li>移动文件或重命名文件，只是改变文件名，不影响inode号码。</li>
<li>打开一个文件以后，系统就以inode号码来识别这个文件，不再考虑文件名。因此，通常来说，系统无法从inode号码得知文件名。</li>
</ol>
<p>第3点使得软件更新变得简单，可以在不关闭软件的情况下进行更新，不需要重启。因为系统通过inode号码，识别运行中的文件，不通过文件名。更新的时候，新版文件以同样的文件名，生成一个新的inode，不会影响到运行中的文件。等到下一次运行这个软件的时候，文件名就自动指向新版文件，旧版文件的inode则被回收。</p>
<h2 id="文件描述符"><a href="#文件描述符" class="headerlink" title="文件描述符"></a>文件描述符</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>文件描述符在形式上是一个非负整数。实际上，它是一个索引值，指向内核为每一个进程所维护的该进程打开文件的记录表。当程序打开一个现有文件或者创建一个新文件时，内核向进程返回一个文件描述符。在程序设计中，一些涉及底层的程序编写往往会围绕着文件描述符展开。</p>
<p>Linux 系统中，把一切都看做是文件，当进程打开现有文件或创建新文件时，内核向进程返回一个文件描述符，文件描述符就是内核为了高效管理已被打开的文件所创建的索引，用来指向被打开的文件，所有执行I&#x2F;O操作的系统调用都会通过文件描述符。</p>
<h3 id="文件描述符、文件、进程间的关系"><a href="#文件描述符、文件、进程间的关系" class="headerlink" title="文件描述符、文件、进程间的关系"></a>文件描述符、文件、进程间的关系</h3><p>1.描述：</p>
<ul>
<li>每个文件描述符会与一个打开的文件相对应</li>
<li>不同的文件描述符也可能指向同一个文件</li>
<li>相同的文件可以被不同的进程打开，也可以在同一个进程被多次打开</li>
</ul>
<p>2.系统为维护文件描述符，建立了三个表</p>
<ul>
<li>进程级的文件描述符表</li>
<li>系统级的文件描述符表</li>
<li>文件系统的i-node表<br><img src="/posts/e511c25d/%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6.png"> <img src="/posts/e511c25d/%E4%B8%89%E4%B8%AA%E8%A1%A8%E7%9A%84%E5%85%B3%E7%B3%BB.png"></li>
<li>在进程A中，文件描述符1和30都指向了同一个打开的文件句柄（#23），这可能是该进程多次对执行打开操作</li>
<li>进程A中的文件描述符2和进程B的文件描述符2都指向了同一个打开的文件句柄（#73），这种情况有几种可能，1.进程A和进程B可能是父子进程关系;2.进程A和进程B打开了同一个文件，且文件描述符相同（低概率事件&#x3D;_&#x3D;）；3.A、B中某个进程通过UNIX域套接字将一个打开的文件描述符传递给另一个进程。</li>
<li>进程A的描述符0和进程B的描述符3分别指向不同的打开文件句柄，但这些句柄均指向i-node表的相同条目（#1936），换言之，指向同一个文件。发生这种情况是因为每个进程各自对同一个文件发起了打开请求。同一个进程两次打开同一个文件，也会发生类似情况。</li>
</ul>
<h3 id="文件描述符限制"><a href="#文件描述符限制" class="headerlink" title="文件描述符限制"></a>文件描述符限制</h3><p>“文件描述符”也是一种资源，系统中的每个进程都需要有“文件描述符”才能进行一些操作。</p>
<p><img src="/posts/e511c25d/%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E9%99%90%E5%88%B6.png"></p>
<p>永久修改用户级限制时有三种设置类型：</p>
<ul>
<li>soft 指的是当前系统生效的设置值</li>
<li>hard 指的是系统中所能设定的最大值</li>
<li><code>-</code> 指的是同时设置了 soft 和 hard 的值</li>
</ul>
<h3 id="检查某个进程的文件描述符相关内容"><a href="#检查某个进程的文件描述符相关内容" class="headerlink" title="检查某个进程的文件描述符相关内容"></a>检查某个进程的文件描述符相关内容</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">查看指定进程的限制：在 Max open files 那一行，可以看到当前设置中最大文件描述符的数量为1024</span><br><span class="line"></span><br><span class="line"> cat /proc/803/limits</span><br><span class="line"></span><br><span class="line">Limit                     Soft Limit           Hard Limit           Units</span><br><span class="line"></span><br><span class="line">Max cpu time              unlimited            unlimited            seconds</span><br><span class="line"></span><br><span class="line">Max file size             unlimited            unlimited            bytes</span><br><span class="line"></span><br><span class="line">Max data size             unlimited            unlimited            bytes</span><br><span class="line"></span><br><span class="line">Max stack size            8388608              unlimited            bytes</span><br><span class="line"></span><br><span class="line">Max core file size        0                    unlimited            bytes</span><br><span class="line"></span><br><span class="line">Max resident set          unlimited            unlimited            bytes</span><br><span class="line"></span><br><span class="line">Max processes             8041                 8041                 processes</span><br><span class="line"></span><br><span class="line">Max open files            1024                 4096                 files</span><br><span class="line"></span><br><span class="line">Max locked memory         65536                65536                bytes</span><br><span class="line"></span><br><span class="line">Max address space         unlimited            unlimited            bytes</span><br><span class="line"></span><br><span class="line">Max file locks            unlimited            unlimited            locks</span><br><span class="line"></span><br><span class="line">Max pending signals       8041                 8041                 signals</span><br><span class="line"></span><br><span class="line">Max msgqueue size         819200               819200               bytes</span><br><span class="line"></span><br><span class="line">Max nice priority         40                   40</span><br><span class="line"></span><br><span class="line">Max realtime priority     0                    0</span><br><span class="line"></span><br><span class="line">Max realtime timeout      unlimited            unlimited            us</span><br><span class="line"></span><br><span class="line"> 查看该进程占用了多少个文件描述符</span><br><span class="line"></span><br><span class="line"> ll /proc/803/fd | wc -l</span><br><span class="line"></span><br><span class="line">5</span><br><span class="line"></span><br><span class="line"> ll /proc/803/fd</span><br><span class="line"></span><br><span class="line">total 0</span><br><span class="line"></span><br><span class="line">lrwx------ 1 hearing hearing 0 Aug 27 20:14 0 -&gt; /dev/tty3</span><br><span class="line"></span><br><span class="line">lrwx------ 1 hearing hearing 0 Aug 27 20:14 1 -&gt; /dev/tty3</span><br><span class="line"></span><br><span class="line">lrwx------ 1 hearing hearing 0 Aug 27 20:14 10 -&gt; /dev/tty3</span><br><span class="line"></span><br><span class="line">lrwx------ 1 hearing hearing 0 Aug 27 20:14 2 -&gt; /dev/tty3</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>实际应用过程中，如果出现“Too many open files”, 可以通过增大进程可用的文件描述符数量来解决，但往往故事不会这样结束，很多时候，并不是因为进程可用的文件描述符过少，而是因为程序bug，打开了大量的文件连接（web连接也会占用文件描述符）而没有释放。程序申请的资源在用完后及时释放，才是解决“Too many open files”的根本之道。</p>
<h2 id="证书-amp-CA"><a href="#证书-amp-CA" class="headerlink" title="证书&amp;CA"></a>证书&amp;CA</h2><ul>
<li>证书（“digital certificate”或“public key certificate”）：它是用来证明某某东西确实是某某东西的东西</li>
<li>CA（Certificate Authority）：证书授权中心，负责管理和签发证书的第三方机构</li>
<li>CA 证书：就是CA颁发的证书</li>
</ul>
<h2 id="apt-amp-dpkg"><a href="#apt-amp-dpkg" class="headerlink" title="apt&amp;dpkg"></a>apt&amp;dpkg</h2><h3 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h3><p>在Linux平台下使用源代码进行软件编译可以具有定制化的设置，但对于Linux distribution的发行商来说，毕竟不是每个人都会进行源代码编译的，这个问题将会严重的影响linux平台上软件的发行与推广。</p>
<p>为了解决上述的问题，厂商先在他们的系统上面编译好了用户所需要的软件，然后将这个编译好并可执行的软件直接发布给用户安装。不同的 Linux 发行版使用不同的打包系统，一般而言，大多数发行版分别属于两大包管理技术阵营：Debian 的”.deb”，和 Red Hat的”.rpm”。</p>
<h3 id="dpkg"><a href="#dpkg" class="headerlink" title="dpkg"></a>dpkg</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>dpkg - package manager for Debian。dpkg是Debian的一个底层包管理工具，主要用于对已下载到本地和已安装的软件包进行管理。</p>
<p>通过dpkg的机制，Debian提供的软件就能够简单的安装起来，同时能提供安装后的软件信息，只要派生于Debian的其它Linux distributions大多使用dpkg这个机制来管理，包括B2D，Ubuntu，Deepin等。</p>
<h4 id="deb软件包名规则"><a href="#deb软件包名规则" class="headerlink" title="deb软件包名规则"></a>deb软件包名规则</h4><p>格式为： <code>Package_Version-Build_Architecture.deb</code> ，如：nano_1.3.10-2_i386.deb：</p>
<ul>
<li>软件包名称(Package Name): nano</li>
<li>版本(Version Number):1.3.10</li>
<li>修订号(Build Number):2</li>
<li>平台(Architecture):i386</li>
</ul>
<h4 id="dpkg软件包相关文件"><a href="#dpkg软件包相关文件" class="headerlink" title="dpkg软件包相关文件"></a>dpkg软件包相关文件</h4><ul>
<li>&#x2F;etc&#x2F;dpkg&#x2F;dpkg.cfg：dpkg包管理软件的配置文件【Configuration file with default options】</li>
<li>&#x2F;var&#x2F;log&#x2F;dpkg.log：dpkg包管理软件的日志文件【Default log file (see &#x2F;etc&#x2F;dpkg&#x2F;dpkg.cfg(5) and option –log)】</li>
<li>&#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;available：存放系统所有安装过的软件包信息【List of available packages.】</li>
<li>&#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;status：存放系统现在所有安装软件的状态信息</li>
<li>&#x2F;var&#x2F;lib&#x2F;dpkg&#x2F;info：记安装软件包控制目录的控制信息文件</li>
</ul>
<h4 id="dpkg数据库"><a href="#dpkg数据库" class="headerlink" title="dpkg数据库"></a>dpkg数据库</h4><p>dpkg 使用文本文件作为数据库来维护系统中软件，包括文件清单, 依赖关系, 软件状态, 等等详细的内容，通常在 &#x2F;var&#x2F;lib&#x2F;dpkg 目录下。通常在 status 文件中存储软件状态和控制信息。在 info&#x2F; 目录下备份控制文件，并在其下的.list 文件中记录安装文件清单，其下的.mdasums 保存文件的 MD5 编码。</p>
<h4 id="使用手册"><a href="#使用手册" class="headerlink" title="使用手册"></a>使用手册</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">安装软件包，必须是deb包的完整名称。（软件的安装可被拆分为两个对立的过程“解包”和“配置”）</span><br><span class="line"></span><br><span class="line">dpkg -i package-name.deb</span><br><span class="line"></span><br><span class="line"> “解包”：解开软件包到系统目录但不配置,如果和-R一起使用，参数可以是一个目录</span><br><span class="line"></span><br><span class="line">dpkg --unpack package-name.deb</span><br><span class="line"></span><br><span class="line"> “配置”：配置软件包</span><br><span class="line"></span><br><span class="line">dpkg --configure package-name.deb</span><br><span class="line"></span><br><span class="line"> 列出 deb 包的内容</span><br><span class="line"></span><br><span class="line">dpkg -c package-name.deb</span><br></pre></td></tr></table></figure>

<p>安装相关选项：</p>
<ul>
<li>-R：递归地指向特定目录的所有安装包，可以结合-i, -A, –install, –unpack 与 –avail一起使用<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">--remove，移除软件包，但保留其配置文件</span><br><span class="line"></span><br><span class="line">dpkg -r package-name</span><br><span class="line"></span><br><span class="line"> --purge，清除软件包的所有文件（removes everything，including conffiles）</span><br><span class="line"></span><br><span class="line">dpkg -P package-name</span><br><span class="line"></span><br><span class="line"> --list, 查看系统中软件包名符合pattern模式的软件包</span><br><span class="line"></span><br><span class="line">dpkg -l package-name-pattern</span><br><span class="line"></span><br><span class="line"> --listfiles, 查看package-name对应的软件包安装的文件及目录</span><br><span class="line"></span><br><span class="line">dpkg -L package-name</span><br><span class="line"></span><br><span class="line"> --print-avail, 显示包的具体信息</span><br><span class="line"></span><br><span class="line">dpkg -p package-name</span><br><span class="line"></span><br><span class="line"> --status, 查看package-name（已安装）对应的软件包信息</span><br><span class="line"></span><br><span class="line">dpkg -s package-name</span><br><span class="line"></span><br><span class="line"> --search，从已经安装的软件包中查找包含filename的软件包名称 （Tip：也可使用子命令dpkg-query来进行查询操作）</span><br><span class="line"></span><br><span class="line">dpkg -S filename-search-pattern</span><br><span class="line"></span><br><span class="line"> 解包</span><br><span class="line"></span><br><span class="line">dpkg -X pkg.deb</span><br><span class="line"></span><br><span class="line"> 例：列出系统上安装的与dpkg相关的软件包</span><br><span class="line"></span><br><span class="line">dpkg -l \*dpkg*</span><br><span class="line"></span><br><span class="line"> 例：查看dpkg软件包安装到系统中的文件</span><br><span class="line"></span><br><span class="line">dpkg -L dpkg</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h3><h4 id="apt简介"><a href="#apt简介" class="headerlink" title="apt简介"></a>apt简介</h4><p>虽然我们在使用dpkg时，已经解决掉了软件安装过程中的大量问题，但是当依赖关系不满足时，仍然需要手动解决，而apt这个工具解决了这样的问题，linux distribution 先将软件放置到对应的服务器中，然后分析软件的依赖关系，并且记录下来，然后当客户端有安装软件需求时，通过清单列表与本地的dpkg以存在的软件数据相比较，就能从网络端获取所有需要的具有依赖属性的软件了。</p>
<h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p>Debian 采用集中式的软件仓库机制，将各式各样的软件包分门别类地存放在软件仓库中，进行有效地组织和管理。然后，将软件仓库置于许许多多的镜像服务器中，并保持基本一致。这样，所有的 Debian 用户随时都能获得最新版本的安装软件包。因此，对于用户，这些镜像服务器就是他们的软件源（Reposity）</p>
<p>然而，由于每位用户所处的网络环境不同，不可能随意地访问各镜像站点。为了能够有选择地访问，在 Debian 系统中，使用软件源配置文件&#x2F;etc&#x2F;apt&#x2F;sources.list列出最合适访问的镜像站点地址。</p>
<p><code>apt udpate</code> 过程：</p>
<ol>
<li>执行apt-get update</li>
<li>程序分析&#x2F;etc&#x2F;apt&#x2F;sources.list</li>
<li>自动连网寻找list中对应的Packages&#x2F;Sources&#x2F;Release列表文件，如果有更新则下载之，存入&#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;目录</li>
<li>然后 apt-get install 相应的包，下载并安装。</li>
</ol>
<p>用户可以使用“apt-get update”命令刷新软件源，建立更新软件包列表。它会扫描每一个软件源服务器，并为该服务器所具有软件包资源建立索引文件，存放在本地的&#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;目录中。使用apt执行安装、更新操作时，都将依据这些索引文件，向软件源服务器申请资源。</p>
<h4 id="apt相关文件"><a href="#apt相关文件" class="headerlink" title="apt相关文件"></a>apt相关文件</h4><ul>
<li>var&#x2F;lib&#x2F;dpkg&#x2F;available 文件的内容是软件包的描述信息, 该软件包括当前系统所使用的Debian 安装源中的所有软件包，其中包括当前系统中已安装的和未安装的软件包.</li>
<li>&#x2F;etc&#x2F;apt&#x2F;sources.list 记录软件源的地址（当你执行 sudo apt-get install xxx 时，Ubuntu 就去这些站点下载软件包到本地并执行安装）</li>
<li>&#x2F;var&#x2F;cache&#x2F;apt&#x2F;archives 已经下载到的软件包都放在这里（用 apt-get install 安装软件时，软件包的临时存放路径）</li>
<li>&#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists 使用apt-get update命令会从&#x2F;etc&#x2F;apt&#x2F;sources.list中下载软件列表，并保存到该目录</li>
</ul>
<h4 id="创建apt软件源"><a href="#创建apt软件源" class="headerlink" title="创建apt软件源"></a>创建apt软件源</h4><h5 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h5><p>以下是我搭建的软件源目录结构：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">hearing/</span><br><span class="line"></span><br><span class="line">├── bootstraps</span><br><span class="line"></span><br><span class="line">│   ├── bootstrap-aarch64</span><br><span class="line"></span><br><span class="line">│   ├── bootstrap-aarch64.zip</span><br><span class="line"></span><br><span class="line">│   ├── bootstrap-arm.zip</span><br><span class="line"></span><br><span class="line">│   ├── bootstrap-i686.zip</span><br><span class="line"></span><br><span class="line">│   └── bootstrap-x86_64.zip</span><br><span class="line"></span><br><span class="line">├── repository</span><br><span class="line"></span><br><span class="line">│   ├── dists</span><br><span class="line"></span><br><span class="line">│   |    └── stable</span><br><span class="line"></span><br><span class="line">│   |       ├── InRelease</span><br><span class="line"></span><br><span class="line">│   |       ├── main</span><br><span class="line"></span><br><span class="line">│   |       │   ├── binary-aarch64</span><br><span class="line"></span><br><span class="line">│   |       │   │   └── Packages</span><br><span class="line"></span><br><span class="line">│   |       │   ├── binary-all</span><br><span class="line"></span><br><span class="line">│   |       │   │   └── Packages</span><br><span class="line"></span><br><span class="line">│   |       │   ├── binary-arm</span><br><span class="line"></span><br><span class="line">│   |       │   │   └── Packages</span><br><span class="line"></span><br><span class="line">│   |       │   ├── binary-i686</span><br><span class="line"></span><br><span class="line">│   |       │   │   └── Packages</span><br><span class="line"></span><br><span class="line">│   |       │   └── binary-x86_64</span><br><span class="line"></span><br><span class="line">│   |       │       └── Packages</span><br><span class="line"></span><br><span class="line">│   |       ├── Release</span><br><span class="line"></span><br><span class="line">|   |       ├── Release.gpg</span><br><span class="line"></span><br><span class="line">|   |       └── repo.asc</span><br><span class="line"></span><br><span class="line">│   └── pool</span><br><span class="line"></span><br><span class="line">│       ├── aarch64</span><br><span class="line"></span><br><span class="line">│       |   ├── xxx.deb</span><br><span class="line"></span><br><span class="line">│       ├── all</span><br><span class="line"></span><br><span class="line">│       |   ├── xxx.deb</span><br><span class="line"></span><br><span class="line">│       ├── arm</span><br><span class="line"></span><br><span class="line">│       |   ├── xxx.deb</span><br><span class="line"></span><br><span class="line">│       ├── i686</span><br><span class="line"></span><br><span class="line">│       |   ├── xxx.deb</span><br><span class="line"></span><br><span class="line">│       └── x86_64</span><br><span class="line"></span><br><span class="line">│           ├── xxx.deb</span><br><span class="line"></span><br><span class="line">└── tmp</span><br><span class="line"></span><br><span class="line">    ├── xxx.tar.gz</span><br></pre></td></tr></table></figure>
<ul>
<li>bootstraps目录下放的是最终编译成功的zip文件</li>
<li>repository是自己制作的软件仓库</li>
<li>tmp放置的是上一步编译中下载失败的一些依赖</li>
</ul>
<h5 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h5><p>根据 <code>https://wiki.debian.org/DebianRepository/Setup</code> 中的说法，仓库分为两种，一种比较简单的是trivial archive，而另外一种复杂的仓库称为official archive。在一个official archive中，典型特征是顶层有个 dists 目录和 pool 目录。这样的好处是:</p>
<ul>
<li>将所有类型CPU的包列表(Packages或者Packages.gz文件)放在一个文件里面，这样每个机器要获取的包列表就比较小。</li>
<li>不同套件&#x2F;不同CPU可共用的deb包（主要是那些 _all.deb）和源代码包，也只在 pool&#x2F;all目录下存放一份。</li>
<li>源代码包(.dsc，orig.tar.xz)有路径存放，这样 dget &#x2F; apt source 可以取到源代码包。</li>
</ul>
<p>对应的 <code>/etc/apt/sources.list</code> 配置如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb http://192.168.56.47:80/hearing/repository stable main</span><br></pre></td></tr></table></figure>

<p>配置软件源的格式为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb|deb-src uri distribution [component1] [component2] [...]</span><br></pre></td></tr></table></figure>

<h5 id="生成Packages"><a href="#生成Packages" class="headerlink" title="生成Packages"></a>生成Packages</h5><p>Packages文件包括每个deb包的位置，描述，版本等信息，生成命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dpkg-scanpackages all/ /dev/null| gzip -9c &gt; dists/stable/main/binary-all/Packages.gz</span><br><span class="line"></span><br><span class="line">dpkg-scanpackages all/ /dev/null| &gt; dists/stable/main/binary-all/Packages</span><br></pre></td></tr></table></figure>

<h5 id="生成Release"><a href="#生成Release" class="headerlink" title="生成Release"></a>生成Release</h5><p>Release文件里面包含了 Packages 等文件的大小和校验和(包含MD5&#x2F;SHA1&#x2F;SHA256&#x2F;SHA512 多种值)，如果这个文件里面所描述的 Packages 大小与校验和与实际读取到的文件不一致，apt 会拒绝这个仓库。生成命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-ftparchive release $dir &gt; Release</span><br></pre></td></tr></table></figure>

<h5 id="生成Release-gpg-和-InRelease-文件"><a href="#生成Release-gpg-和-InRelease-文件" class="headerlink" title="生成Release.gpg 和 InRelease 文件"></a>生成Release.gpg 和 InRelease 文件</h5><p>Release.gpg 是一个签名文件，随同 Release 一起出现的，比较老的客户端只认这两个文件，而 InRelease 是内嵌签名的（也就是说，将原来 Release 的内容和 Release.gpg 的内容揉到一起了，注意这里不是简单地拼到一起），新的客户端才支持这个这个文件，观察一下 Debian 和 Ubuntu 的仓库 ( <a target="_blank" rel="noopener" href="http://mirrors.ustc.edu.cn/debian/dists/jessie/">http://mirrors.ustc.edu.cn/debian/dists/jessie/</a>, <a target="_blank" rel="noopener" href="http://mirrors.ustc.edu.cn/ubuntu/dists/xenial/">http://mirrors.ustc.edu.cn/ubuntu/dists/xenial/</a> ) ，可以看到 Debian 的仓库只有 Release 和 Release.gpg 这两个文件，而 Ubuntu 仓库里面这三个文件都有。</p>
<p>如何生成这两个文件：</p>
<ul>
<li>生成自己的gpg key: <code>gpg --list-keys || gpg --gen-key</code></li>
<li>生成Release.gpg: <code>gpg --armor --detach-sign --sign -o Release.gpg Release</code></li>
<li>生成InRelease: <code>gpg --clearsign -o InRelease Release</code></li>
</ul>
<h5 id="导入公钥"><a href="#导入公钥" class="headerlink" title="导入公钥"></a>导入公钥</h5><p>当运行 <code>apt update</code> 的时候，会出现警告： <code>The following signatures couldn&#39;t be verified because the public key is not available: NO_PUBKEY 722D2AFAD8BAD548</code> 。</p>
<p>也就是说 InRelease &#x2F; Release.gpg 虽然签名了，但由于这个签名所用的公钥没有被接受，因此还是不能正常使用，有三种解决方法：</p>
<ol>
<li>服务端将公钥导出，然后提供给客户端导入： <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">导出</span><br><span class="line">gpg --export --armor 722D2AFAD8BAD548 -o my-repo.gpg-key.asc</span><br><span class="line"> 导入</span><br><span class="line">sudo apt-key add my-repo.gpg-key.asc</span><br></pre></td></tr></table></figure></li>
<li>客户端在执行 <code>apt update</code> 的时候，添加 <code>--allow-insecure-repositories</code> 选项；在执行 <code>apt install pkg</code> 的时候，添加 <code>--allow-unauthenticated</code> 选项。</li>
<li>用户修改仓库的配置，改为 <code>deb [trusted=yes] http://192.168.56.47:80/hearing/repository stable main</code></li>
</ol>
<h4 id="使用手册-1"><a href="#使用手册-1" class="headerlink" title="使用手册"></a>使用手册</h4><ol>
<li>apt-get update 更新源</li>
<li>apt-get dist-upgrade 升级系统到相应的发行版(根据 source.list 的配置)</li>
<li>apt-get upgrade 更新所有已经安装的软件包</li>
<li>apt-get install package_name 安装软件包(加上 –reinstall重新安装)，apt-get install package_name&#x3D;version 安装指定版本的软件包</li>
<li>apt-get remove package_name 卸载一个已安装的软件包（保留配置文件）</li>
<li>apt-get purge package_name 移除软件包（删除配置信息）或apt-get –purge remove packagename</li>
<li>apt-get check 检查是否有损坏的依赖</li>
<li>apt-get autoclean：删除你已经删掉的软件（定期运行这个命令来清除那些已经卸载的软件包的.deb文件。通过这种方式，可以释放大量的磁盘空间。可以使用apt-get<br> clean以释放更多空间。这个命令会将已安装软件包裹的.deb文件一并删除）</li>
<li>apt-get clean 把安装的软件的备份也删除，不过这样不会影响软件的使用</li>
</ol>
<p>apt-cache对APT的程序包缓存执行各种操作。apt-cache不会操纵系统状态，但会提供操作以从包元数据中搜索并生成输出。</p>
<ol>
<li>apt-cache depends packagename 了解使用依赖</li>
<li>apt-cache rdepends packagename 是查看该包被哪些包依赖</li>
<li>apt-cache search packagename 搜索包</li>
<li>apt-cache show packagename 获取包的相关信息，如说明、大小、版本等</li>
<li>apt-cache showpkg packagename 显示软件包的大致信息</li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/clippings/" rel="tag"># clippings</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/posts/d4e05bc8/" rel="next" title="Termux解析">
                <i class="fa fa-chevron-left"></i> Termux解析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/posts/e4e04dba/" rel="prev" title="Android动画笔记">
                Android动画笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">439</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:shenbh@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/ptwenzi?spm=1010.2135.3001.5113" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-clone"></i>CSDN</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E6%9D%A1%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%E4%B8%8D%E8%BE%93%E5%87%BA%E5%88%B0%E7%BB%88%E7%AB%AF"><span class="nav-text">多条命令执行结果不输出到终端</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C"><span class="nav-text">后台运行</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#nohup"><span class="nav-text">nohup</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setsid"><span class="nav-text">setsid</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#amp"><span class="nav-text">&amp;</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B"><span class="nav-text">查看进程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-text">概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#free"><span class="nav-text">free</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#top"><span class="nav-text">top</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ps"><span class="nav-text">ps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#proc"><span class="nav-text">proc</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Android"><span class="nav-text">Android</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#procrank"><span class="nav-text">procrank</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#dumpsys"><span class="nav-text">dumpsys</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UNIX%E4%B8%8ELinux"><span class="nav-text">UNIX与Linux</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux%E5%86%85%E6%A0%B8%E4%B8%8E%E5%8F%91%E8%A1%8C%E7%89%88"><span class="nav-text">Linux内核与发行版</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android%E4%B8%8ELinux"><span class="nav-text">Android与Linux</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GNU"><span class="nav-text">GNU</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E5%88%87%E7%9A%86%E6%96%87%E4%BB%B6"><span class="nav-text">一切皆文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0"><span class="nav-text">描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-text">文件类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Inode"><span class="nav-text">Inode</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode%E7%9A%84%E5%86%85%E5%AE%B9"><span class="nav-text">inode的内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="nav-text">inode的大小</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode%E5%8F%B7%E7%A0%81"><span class="nav-text">inode号码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6"><span class="nav-text">目录文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E9%93%BE%E6%8E%A5"><span class="nav-text">硬链接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%AF%E9%93%BE%E6%8E%A5-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F"><span class="nav-text">软链接(快捷方式)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode%E7%9A%84%E7%89%B9%E6%AE%8A%E4%BD%9C%E7%94%A8"><span class="nav-text">inode的特殊作用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="nav-text">文件描述符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E6%96%87%E4%BB%B6%E3%80%81%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-text">文件描述符、文件、进程间的关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E9%99%90%E5%88%B6"><span class="nav-text">文件描述符限制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E6%9F%90%E4%B8%AA%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9"><span class="nav-text">检查某个进程的文件描述符相关内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6-amp-CA"><span class="nav-text">证书&amp;CA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#apt-amp-dpkg"><span class="nav-text">apt&amp;dpkg</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dpkg"><span class="nav-text">dpkg</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-text">简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#deb%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%90%8D%E8%A7%84%E5%88%99"><span class="nav-text">deb软件包名规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dpkg%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6"><span class="nav-text">dpkg软件包相关文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dpkg%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">dpkg数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C"><span class="nav-text">使用手册</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#apt"><span class="nav-text">apt</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#apt%E7%AE%80%E4%BB%8B"><span class="nav-text">apt简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">工作原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#apt%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6"><span class="nav-text">apt相关文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAapt%E8%BD%AF%E4%BB%B6%E6%BA%90"><span class="nav-text">创建apt软件源</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0-3"><span class="nav-text">概述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BC%95%E7%94%A8"><span class="nav-text">引用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%9F%E6%88%90Packages"><span class="nav-text">生成Packages</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%9F%E6%88%90Release"><span class="nav-text">生成Release</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%9F%E6%88%90Release-gpg-%E5%92%8C-InRelease-%E6%96%87%E4%BB%B6"><span class="nav-text">生成Release.gpg 和 InRelease 文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E5%85%AC%E9%92%A5"><span class="nav-text">导入公钥</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-1"><span class="nav-text">使用手册</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">阿炳</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('Copied')
          else $(this).text('Copy failed')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('Copy')
        }, 300)
      }).append(e)
    })
  </script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>