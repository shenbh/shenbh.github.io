<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="private,flutter," />










<meta name="description" content="å®¹å™¨å®½é«˜ç›¸å…³é—®é¢˜Container è®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆä¸€èˆ¬æ˜¯ç”±äºçˆ¶çº§å®¹å™¨çš„ constraints å±æ€§å¼•èµ·çš„ï¼Œåœ¨ Flutter ä¸­ï¼Œå­ç»„ä»¶çš„å¤§å°ä¼šè¢«çˆ¶ç»„ä»¶çš„  constraints  å±æ€§é™åˆ¶ï¼Œä¾‹å¦‚ 12345678910ConstrainedBox(  constraints: BoxConstraints(    minWidth: 100.0, &#x2F;&#x2F; æœ€å°å®½åº¦ä¸º 100 åƒç´     min">
<meta property="og:type" content="article">
<meta property="og:title" content="Flutterç›¸å…³é—®é¢˜">
<meta property="og:url" content="http://shenbh.github.io/posts/136519660/index.html">
<meta property="og:site_name" content="ç§¯è·¬æ­¥">
<meta property="og:description" content="å®¹å™¨å®½é«˜ç›¸å…³é—®é¢˜Container è®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆä¸€èˆ¬æ˜¯ç”±äºçˆ¶çº§å®¹å™¨çš„ constraints å±æ€§å¼•èµ·çš„ï¼Œåœ¨ Flutter ä¸­ï¼Œå­ç»„ä»¶çš„å¤§å°ä¼šè¢«çˆ¶ç»„ä»¶çš„  constraints  å±æ€§é™åˆ¶ï¼Œä¾‹å¦‚ 12345678910ConstrainedBox(  constraints: BoxConstraints(    minWidth: 100.0, &#x2F;&#x2F; æœ€å°å®½åº¦ä¸º 100 åƒç´     min">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/2/28/1708b07cd338e0ca?imageslim">
<meta property="og:image" content="http://shenbh.github.io/posts/136519660/blur_img.jpg">
<meta property="article:published_time" content="2019-12-18T14:15:34.000Z">
<meta property="article:modified_time" content="2025-06-30T07:12:08.687Z">
<meta property="article:author" content="é˜¿ç‚³">
<meta property="article:tag" content="private">
<meta property="article:tag" content="flutter">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2020/2/28/1708b07cd338e0ca?imageslim">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://shenbh.github.io/posts/136519660/"/>





  <title>Flutterç›¸å…³é—®é¢˜ | ç§¯è·¬æ­¥</title><meta name="robots" content="noindex">
  








<meta name="generator" content="Hexo 6.1.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ç§¯è·¬æ­¥</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Just do IT Now.</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://shenbh.github.io/posts/136519660/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç§¯è·¬æ­¥">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Flutterç›¸å…³é—®é¢˜</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-18T22:15:34+08:00">
                2019-12-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Flutter/" itemprop="url" rel="index">
                    <span itemprop="name">Flutter</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="å®¹å™¨å®½é«˜ç›¸å…³é—®é¢˜"><a href="#å®¹å™¨å®½é«˜ç›¸å…³é—®é¢˜" class="headerlink" title="å®¹å™¨å®½é«˜ç›¸å…³é—®é¢˜"></a>å®¹å™¨å®½é«˜ç›¸å…³é—®é¢˜</h1><h2 id="Container-è®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆ"><a href="#Container-è®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆ" class="headerlink" title="Container è®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆ"></a>Container è®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆ</h2><p>ä¸€èˆ¬æ˜¯ç”±äºçˆ¶çº§å®¹å™¨çš„ <code>constraints</code> å±æ€§å¼•èµ·çš„ï¼Œåœ¨ Flutter ä¸­ï¼Œå­ç»„ä»¶çš„å¤§å°ä¼šè¢«çˆ¶ç»„ä»¶çš„  <code>constraints</code>  å±æ€§é™åˆ¶ï¼Œä¾‹å¦‚</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ConstrainedBox(</span><br><span class="line">  constraints: BoxConstraints(</span><br><span class="line">    minWidth: <span class="number">100.0</span>, <span class="comment">// æœ€å°å®½åº¦ä¸º 100 åƒç´ </span></span><br><span class="line">    minHeight: <span class="number">50.0</span> <span class="comment">// æœ€å°é«˜åº¦ä¸º 50 åƒç´ </span></span><br><span class="line">  ),</span><br><span class="line">  child: Container(</span><br><span class="line">    height: <span class="number">5.0</span>,<span class="comment">// é«˜åº¦ä¸º 5 é€»è¾‘åƒç´ </span></span><br><span class="line">    child: redBox </span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>Container</code> ç»„ä»¶è®¾ç½®é«˜åº¦ä¸º 5 åƒç´ ï¼Œæ˜¯æ— æ³•ç”Ÿæ•ˆçš„ï¼Œå› ä¸ºçˆ¶çº§å®¹å™¨å·²ç»è®¾ç½®äº†æœ€å°é«˜åº¦ä¸º 50 åƒç´ ï¼Œæ‰€ä»¥ <code>Container</code> ç»„ä»¶çš„æœ€ç»ˆé«˜åº¦å°†ä¼šæ˜¯ 50 åƒç´ ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™è‚¯å®šä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼Œæˆ‘ä»¬å°±æƒ³è®©  <code>Container</code>  ç»„ä»¶çš„æœ€ç»ˆé«˜åº¦æ˜¯ 5 åƒç´ æ€ä¹ˆåŠï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå¯ä»¥ä½¿ç”¨ <code>UnconstraindBox</code> è§£é™¤çˆ¶çº§å®¹å™¨çš„ <code>constraints</code> å±æ€§å¯¹å­ç»„ä»¶å¤§å°çš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ConstrainedBox(</span><br><span class="line">  constraints: BoxConstraints(</span><br><span class="line">    minWidth: <span class="number">100.0</span>, <span class="comment">// æœ€å°å®½åº¦ä¸º 100 åƒç´ </span></span><br><span class="line">    minHeight: <span class="number">50.0</span> <span class="comment">// æœ€å°é«˜åº¦ä¸º 50 åƒç´ </span></span><br><span class="line">  ),</span><br><span class="line">  child: UnconstraintsBox(</span><br><span class="line">    child: Container(</span><br><span class="line">      height: <span class="number">5.0</span>, </span><br><span class="line">      child: redBox </span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>UnconstrainedBox</code> å…è®¸å…¶å­ç»„ä»¶æŒ‰ç…§å…¶è‡ªèº«çš„å¤§å°ç»˜åˆ¶ï¼Œæˆ‘ä»¬å¾ˆå°‘ç›´æ¥ä½¿ç”¨æ­¤ç»„ä»¶ï¼Œé™¤éå¯¹äº Material è‡ªå¸¦çš„ä¸€äº›ç»„ä»¶ï¼Œå¦‚ <code>Appbar</code> çš„ icon è¢«å®˜æ–¹é™åˆ¶äº†å›ºå®šçš„å¤§å°ï¼Œåˆ©ç”¨è¯¥ç»„ä»¶å¯ä»¥è§£é™¤é™åˆ¶ï¼Œè€Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨ç»„ä»¶å¤–é¢å¥—ä¸€å±‚å¸ƒå±€ç±»ç»„ä»¶å°±å¯ä»¥è§£å†³éœ€æ±‚ï¼Œä¾‹å¦‚ä»¥ä¸‹ç»„ä»¶ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Row()</span><br><span class="line">Column()</span><br><span class="line">Align()</span><br><span class="line">Center()</span><br><span class="line">Flex()</span><br><span class="line">Wrap()</span><br><span class="line">Flow()</span><br><span class="line">Stack()</span><br></pre></td></tr></table></figure>

<h2 id="SignleChildScrollView-ä¸æ»¡ä¸€å±é«˜åº¦æ—¶æ— æ³•æ’‘æ»¡å…¨å±"><a href="#SignleChildScrollView-ä¸æ»¡ä¸€å±é«˜åº¦æ—¶æ— æ³•æ’‘æ»¡å…¨å±" class="headerlink" title="SignleChildScrollView ä¸æ»¡ä¸€å±é«˜åº¦æ—¶æ— æ³•æ’‘æ»¡å…¨å±"></a>SignleChildScrollView ä¸æ»¡ä¸€å±é«˜åº¦æ—¶æ— æ³•æ’‘æ»¡å…¨å±</h2><p>å…¶å®å’Œä¸Šé¢è¿™ä¸ªé—®é¢˜æ˜¯ç›¸ä¼¼çš„ï¼Œå¯ä»¥ä½¿ç”¨å¸ƒå±€ç±»ç»„ä»¶è§£å†³ï¼Œæˆ–è€…ç”¨å¦‚ä¸‹æ–¹å¼ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Container(</span><br><span class="line">  alignment: Alignment.topLeft,</span><br><span class="line">  child: SingleChildScrollView(),</span><br><span class="line">),</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ çœ‹è¿‡ <code>Container</code> çš„æºç ä½ ä¼šå‘ç°å…¶å®è®¾ç½® <code>alignment</code> å±æ€§ï¼Œå’Œç”¨ <code>Align</code> ç»„ä»¶æ˜¯ä¸€å›äº‹ï¼Œæºç ä¹Ÿæ˜¯ä½¿ç”¨ <code>Align</code> ç»„ä»¶ï¼Œè¿™å°±æ˜¯ä¸ªè¯­æ³•ç³–ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
<p>è¯´åˆ°è¯­æ³•ç³–ï¼Œå…¶å® <code>Center</code> ç»„ä»¶ä¹Ÿæ˜¯ <code>Align</code> ç»„ä»¶çš„è¯­æ³•ç³–ï¼Œå½“ä½ ä¸ç»™ <code>Align</code> ä¼ é€’ä»»ä½•å‚æ•°æ—¶ï¼Œä½¿ç”¨ <code>Center()</code> å’Œä½¿ç”¨ <code>Align()</code> æ˜¯ä¸€æ¨¡ä¸€æ ·çš„æ•ˆæœï¼Œæˆ‘çš„ä¹ æƒ¯æ˜¯ä¸ç®¡ä»€ä¹ˆæƒ…å†µï¼Œéƒ½æ˜¯åªç”¨<code>Align</code> ç»„ä»¶ã€‚</p>
<h2 id="Container-è®¾ç½®-borderRadius-ä¸ç”Ÿæ•ˆ"><a href="#Container-è®¾ç½®-borderRadius-ä¸ç”Ÿæ•ˆ" class="headerlink" title="Container  è®¾ç½® borderRadius ä¸ç”Ÿæ•ˆ"></a>Container  è®¾ç½® borderRadius ä¸ç”Ÿæ•ˆ</h2><p>è®¾ç½® <code>borderRadius</code> æœ‰ä¸¤ç§åšæ³•ï¼Œç¬¬ä¸€ç§ä½¿ç”¨ <code>Container</code> ç­‰ç»„ä»¶è‡ªå¸¦çš„ <code>borderRadius</code> å±æ€§ï¼Œç¬¬äºŒç§æ˜¯ï¼Œç›´æ¥ç”¨ <code>ClipRRect</code> ç­‰ clip ç»„ä»¶å¯¹å®¹å™¨è¿›è¡Œè£å‰ªï¼Œç¬¬äºŒç§æ¯”ç¬¬ä¸€ç§æ›´åŠ æš´åŠ›ã€æ¶ˆè€—æ€§èƒ½ï¼Œä½†æ›´æœ‰æ•ˆã€‚</p>
<p>ä¾‹å¦‚ç»™ <code>TabView</code> çš„å®¹å™¨è®¾ç½® <code>borderRadius</code>ï¼Œä½ ä¼šå‘ç°æ— æ³•ç”Ÿæ•ˆï¼Œè€Œä½¿ç”¨ <code>ClipRRect</code> åˆ™å¯ä»¥è§£å†³ï¼Œæˆ‘çš„ç†è§£æ˜¯ <code>ClipRRect</code> ä¼šç›´æ¥è£å‰ªæˆåœ†è§’å½¢çŠ¶ï¼Œè€Œ <code>BorderRadius</code> çš„åœ†è§’å¤–çš„å¼§å½¢èŒƒå›´æ˜¯é€æ˜çš„ï¼Œç±»ä¼¼ <code>css</code> ä¸­çš„ <code>display:none</code> ä¸ <code>opaticy:0</code> çš„åŒºåˆ«ï¼Œå®é™…å…·ä½“æ˜¯ä»€ä¹ˆåŸå› ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰å»ç»†ç©¶ï¼Œå¤åˆ¶ç²˜è´´ã€èƒ½è·‘å°±è¡Œã€‚</p>
<h1 id="å…ƒç´ æ˜¾ç¤ºå±‚çº§é—®é¢˜"><a href="#å…ƒç´ æ˜¾ç¤ºå±‚çº§é—®é¢˜" class="headerlink" title="å…ƒç´ æ˜¾ç¤ºå±‚çº§é—®é¢˜"></a>å…ƒç´ æ˜¾ç¤ºå±‚çº§é—®é¢˜</h1><p>å¯ä»¥è®¤ä¸º Flutter ä¸­ <code>widget</code> å¸ƒå±€çš„å±‚çº§å…³ç³»æ˜¯é€’è¿›çš„ï¼Œä¾‹å¦‚ <code>child</code> çš„å±‚çº§æ¯”çˆ¶ <code>Widget</code> å±‚çº§æ›´é«˜ï¼Œ <code>Column</code>ã€<code>Row</code> ç­‰ç»„ä»¶çš„ <code>children</code> ä¸­åŒçº§ <code>widget</code>ï¼Œè°åœ¨åé¢è°çš„å±‚çº§å°±æ›´é«˜ï¼Œå’Œ <code>Stack</code> å…¶ <code>children</code> çš„å±‚çº§å…³ç³»ç›¸åŒã€‚</p>
<h2 id="æ˜¾ç¤ºéšè—çš„å‡ ç§åšæ³•"><a href="#æ˜¾ç¤ºéšè—çš„å‡ ç§åšæ³•" class="headerlink" title="æ˜¾ç¤ºéšè—çš„å‡ ç§åšæ³•"></a>æ˜¾ç¤ºéšè—çš„å‡ ç§åšæ³•</h2><p>ç¬¬ä¸€ç§ï¼Œåˆ©ç”¨ <code>IndexedStack</code> ç»„ä»¶æ§åˆ¶å±‚çº§ï¼Œä¸Šé¢ä¹Ÿæåˆ°è¿‡ï¼Œå­ç»„ä»¶è°åœ¨åé¢è°çš„å±‚çº§å°±é«˜ï¼ŒFlutter ä¸­è™½ç„¶æ²¡æœ‰ <code>z-index</code> è¿™ä¸€è¯´æ³•ï¼Œä½†å…¶å®åŸç†å’Œ css çš„ <code>z-index</code> æ˜¯ç±»ä¼¼çš„ï¼Œindex è¶Šå¤§ï¼Œå±‚çº§è¶Šé«˜ï¼Œå½“ç„¶è¿™é‡Œçš„ <code>IndexedStack</code> çš„ <code>index</code> å±æ€§æ˜¯ç”¨æ¥æ§åˆ¶å½“å‰æ˜¾ç¤ºçš„æŸä¸€ä¸ª childrenï¼Œåªèƒ½æ˜¾ç¤ºä¸€ä¸ªã€‚è¯¥æ–¹æ³•å¸¸ç”¨äº APP é¦–é¡µåˆ‡æ¢åº•éƒ¨å¯¼èˆªã€‚</p>
<p>ç¬¬äºŒç§ï¼Œåˆ©ç”¨ <code>IgnorePointer</code> åŠ <code>Opacity</code> ç»„ä»¶ç»„åˆéšè— widgetï¼Œå¯ä»¥ä½¿ç”¨ <code>AnimationOpacity</code> ç»„ä»¶è¾¾åˆ°ä»¥å‰ <code>JQuery</code> ä¸­å¸¸ç”¨çš„ <code>fadeIn</code> æ•ˆæœã€‚</p>
<p>ç¬¬ä¸‰ç§ï¼Œåˆ©ç”¨ <code>Positioned</code> æˆ– <code>Transform.translate</code> ç§»åŠ¨åˆ°å±å¹•å¤–ï¼Œéœ€è¦æ˜¾ç¤ºæ—¶å†ç§»åŠ¨å›æ¥ï¼Œè¿™ç§åšæ³•éå¸¸é€‚åˆåŠ¨ç”»åˆ‡æ¢ï¼Œä¾‹å¦‚è§†é¢‘è¿›åº¦æ¡ç­‰æ•ˆæœã€‚</p>
<p>ç¬¬å››ç§ï¼Œåˆ©ç”¨ <code>Offstage</code> ç»„ä»¶ï¼Œå‰ä¸‰ç§éƒ½æ˜¯åˆ©ç”¨è§†è§‰æ•ˆæœå°†å…ƒç´ éšè—èµ·æ¥ï¼Œå…¶å®åœ¨å¸ƒå±€ä¸Šå¹¶æœªå‘ç”Ÿæ”¹å˜ï¼Œè€Œæ­¤ç»„ä»¶å°±æ˜¯ç±»ä¼¼äº css ä¸­çš„ <code>display:none</code>ï¼Œç›´æ¥è®©å…ƒç´ åœ¨å¸ƒå±€ä¸­éšè—ï¼Œä¸ä¼šåœ¨å¸ƒå±€ä¸Šç»§ç»­å ç”¨ç©ºé—´ã€‚</p>
<p>æœ€åä¸€ç§ï¼Œåœ¨ build æ–¹æ³•ä¸­æå‰åˆ¤æ–­ï¼Œä¸ç¬¦åˆæ¡ä»¶ç›´æ¥ä¸æ¸²æŸ“ï¼Œæˆ–è€…è¿”å›ç©º boxï¼Œè¿™å°±ç±»ä¼¼äº HTML ä¸­åˆ é™¤ dom å…ƒç´ ï¼Œæˆ‘äººæ²¡äº†ï¼Œè¿˜æ˜¾ç¤ºä¸ªğŸ”¨ï¼Œè¿™æ˜¯æœ€ææ€–çš„ã€‚</p>
<h1 id="GestureDetector-è®¾ç½®-onTap-ä¸ç”Ÿæ•ˆ"><a href="#GestureDetector-è®¾ç½®-onTap-ä¸ç”Ÿæ•ˆ" class="headerlink" title="GestureDetector è®¾ç½® onTap ä¸ç”Ÿæ•ˆ"></a>GestureDetector è®¾ç½® onTap ä¸ç”Ÿæ•ˆ</h1><p><code>Listener</code> é»˜è®¤çš„ <code>behavior</code> æ˜¯ <code>HitTestBehavior.deferToChild</code></p>
<p>å¦‚æœ <code>Listener</code> çš„å­ç»„ä»¶æ˜¯ä¸€ä¸ª <code>Container</code>ï¼Œè¿™ä¸ª <code>Container</code> ä¸è®¾ç½® <code>decoration</code> çš„æƒ…å†µä¸‹ï¼Œå³é€æ˜èƒŒæ™¯è‰²ã€æ— è¾¹æ¡†ï¼Œåˆ™ç‚¹å‡» <code>Container</code> æ—¶ï¼Œæ— æ³•è§¦å‘ <code>downã€up</code> ç­‰äº‹ä»¶ã€‚</p>
<p>åŒç†ï¼Œ<code>GestureDetector</code> æ˜¯å¯¹ <code>Listener</code> çš„å°è£…ï¼Œæ— æ³•è§¦å‘ <code>onTap</code> ç­‰äº‹ä»¶ä¹Ÿæ˜¯å¿…ç„¶çš„ï¼Œé‚£ä¹ˆè§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§è§£å†³åŠæ³•ï¼š</p>
<ol>
<li>ç»™ Container è®¾ç½® decoration</li>
<li>å°† behavior å±æ€§è®¾ç½®ä¸º opaque æˆ– translucent</li>
</ol>
<h1 id="è°ƒç”¨-setState-æˆ–-markNeedsBuild-åæŠ¥é”™"><a href="#è°ƒç”¨-setState-æˆ–-markNeedsBuild-åæŠ¥é”™" class="headerlink" title="è°ƒç”¨ setState æˆ– markNeedsBuild åæŠ¥é”™"></a>è°ƒç”¨ setState æˆ– markNeedsBuild åæŠ¥é”™</h1><h2 id="ç¬¬ä¸€ç§æŠ¥é”™"><a href="#ç¬¬ä¸€ç§æŠ¥é”™" class="headerlink" title="ç¬¬ä¸€ç§æŠ¥é”™"></a>ç¬¬ä¸€ç§æŠ¥é”™</h2><blockquote>
<p>setState() or markNeedsBuild() called during build</p>
</blockquote>
<p>é‡åˆ°æ­¤æç¤ºï¼Œä¸€èˆ¬è§£å†³æ€è·¯éƒ½æ˜¯åˆ©ç”¨ <code>addPostFrameCallback</code> æ¥è§£å†³ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WidgetsBinding.instance.addPostFrameCallback((_)&#123;</span><br><span class="line">    _model.setOpacity(opacity);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬äºŒç§æŠ¥é”™"><a href="#ç¬¬äºŒç§æŠ¥é”™" class="headerlink" title="ç¬¬äºŒç§æŠ¥é”™"></a>ç¬¬äºŒç§æŠ¥é”™</h2><blockquote>
<p>setState() called after dispose()</p>
</blockquote>
<p>ä¸€èˆ¬å®šæ—¶å™¨åœ¨ app è¿”å›æ¡Œé¢åä»åœ¨è°ƒç”¨ <code>setState</code> æˆ– é¡µé¢ pop é”€æ¯åå¼‚æ­¥ä»»åŠ¡æ‰å®Œæˆï¼Œæ­¤æ—¶è°ƒç”¨äº† <code>setState</code> å¿…ç„¶ä¼šå‡ºç°è¯¥æç¤ºï¼Œé‚£ä¹ˆè§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œåˆ¤æ–­ç”Ÿå‘½å‘¨æœŸå†æ‰§è¡Œé‡æ„é€»è¾‘ã€‚</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!mounted) <span class="keyword">return</span>;</span><br><span class="line">setState(() &#123;</span><br><span class="line">  <span class="comment">// do somthing</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="åŠ¨æ€æ›´æ”¹-TabBar-çš„é•¿åº¦å-setState-æŠ¥é”™"><a href="#åŠ¨æ€æ›´æ”¹-TabBar-çš„é•¿åº¦å-setState-æŠ¥é”™" class="headerlink" title="åŠ¨æ€æ›´æ”¹ TabBar çš„é•¿åº¦å setState æŠ¥é”™"></a>åŠ¨æ€æ›´æ”¹ TabBar çš„é•¿åº¦å setState æŠ¥é”™</h2><p>å…¶å®è¿™ä¸ªé—®é¢˜è‚¯å®šæ˜¯ç”±äºä½¿ç”¨äº† <code>SingleTickerProviderStateMixin</code> é€ æˆçš„ï¼Œè§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ã€‚</p>
<p>ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨ <code>DefaultTabController</code> æ¥è§£å†³ï¼Œè¿™ä¸ªæ–¹æ¡ˆæ¯”è¾ƒé€‚åˆå¤§ä½¬é€ è½®å­ï¼Œå› ä¸ºéœ€è¦è‡ªå·±å†™ <code>TabBar</code> çš„åˆ‡æ¢æ•ˆæœï¼Œéå¸¸ä¹‹éº»çƒ¦ã€‚</p>
<p>ç¬¬äºŒç§æ–¹æ¡ˆå°±æ˜¯æˆ‘ç›®å‰æ­£åœ¨ä½¿ç”¨çš„ï¼Œéå¸¸ç®€å•ï¼Œåªéœ€è¦å°† <code>SingleTickerProviderStateMixin</code> æ›¿æ¢ä¸º <code>TickerProviderStateMixin</code> å³å¯ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EntryPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  createState() =&gt; _EntryPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_EntryPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">EntryPage</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  TabController tabController;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> tabs = &lt;DanceSort&gt;[</span><br><span class="line">    DanceSort.fromJson(&#123;<span class="string">&quot;id&quot;</span>: <span class="number">-1</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;æ¨è&quot;</span>&#125;),</span><br><span class="line">    DanceSort.fromJson(&#123;<span class="string">&quot;id&quot;</span>: <span class="number">0</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;å…³æ³¨&quot;</span>&#125;),</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  Future&lt;<span class="keyword">void</span>&gt; getTabBar() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> danceSorts = <span class="keyword">await</span> EntryApi.getDanceSorts();</span><br><span class="line">    <span class="keyword">if</span> (danceSorts == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    tabs.addAll(danceSorts);</span><br><span class="line">    tabController.dispose();</span><br><span class="line">    tabController = TabController(length: tabs.length, vsync: <span class="keyword">this</span>);</span><br><span class="line">    setState(() &#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  initState() &#123;</span><br><span class="line">    getTabBar();</span><br><span class="line">    tabController = TabController(length: tabs.length, vsync: <span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  dispose() &#123;</span><br><span class="line">    tabController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> tabBar =&gt; TabBar(</span><br><span class="line">    controller: tabController,</span><br><span class="line">    tabs: tabs.map&lt;Tab&gt;((v) =&gt; Tab(text: v.name)).toList(),</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> tabBarView =&gt; TabBarView(</span><br><span class="line">    controller: tabController,</span><br><span class="line">    children: tabs.map&lt;RecommendList&gt;((v) =&gt; RecommendList(v.id)).toList(),</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> FloatingScrollView(</span><br><span class="line">      tabBar: tabBar,</span><br><span class="line">      tabBarView: tabBarView,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>initState</code> æ—¶ï¼Œå…ˆåˆå§‹åŒ–æœ¬åœ°é»˜è®¤çš„ tabï¼Œé€šè¿‡ Api è¯·æ±‚åˆ°æœåŠ¡ç«¯çš„ tab æ•°æ®åï¼Œå†å°†åŸ <code>tabController</code> é”€æ¯ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ <code>tabController</code>ï¼Œç”±äºä½¿ç”¨çš„æ˜¯ <code>TickerProviderStateMixin</code>ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå› ä¸º <code>Single</code> è€ŒæŠ¥é”™ã€‚</p>
<p>ä¸ºäº†ä¾¿äºç†è§£ï¼Œè¿™ä¸ªä¾‹å­ä½¿ç”¨çš„ <code>setState</code> æ¥é‡æ–°æ„å»ºå¸ƒå±€ï¼Œå…¶å®å®Œå…¨å¯ä»¥ä½¿ç”¨ Provider è¿›è¡Œä¼˜åŒ–ï¼Œæˆ‘çš„é¡¹ç›®ä¹Ÿæ˜¯å…¨éƒ¨ä½¿ç”¨ Provider æ¥è¿›è¡Œç®¡ç†çš„ï¼Œåˆ©ç”¨ <code>Selector</code> å°†æ„å»ºèŒƒå›´ç¼©å°è‡³æœ€å°ï¼Œèƒ½å¾ˆå¤§åœ°æ”¹å–„é‡æ„å¸ƒå±€æ—¶çš„æ€§èƒ½é—®é¢˜ï¼Œä¾‹å¦‚ä¸Šé¢ <code>tabBar</code> éƒ¨åˆ†å¯ä»¥æ¢æˆï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> tabBar =&gt; Selector&lt;HomeModel, TabController&gt;(</span><br><span class="line">  selector: (context, model) =&gt; model.tabController,</span><br><span class="line">  builder: (context, controller, _) =&gt; TabBar(</span><br><span class="line">    controller: controller,</span><br><span class="line">    tabs: model.tabs.map&lt;Tab&gt;((v) =&gt; Tab(text: v.name)).toList(),</span><br><span class="line">  ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>





<h1 id="é”®ç›˜ç›¸å…³é—®é¢˜"><a href="#é”®ç›˜ç›¸å…³é—®é¢˜" class="headerlink" title="é”®ç›˜ç›¸å…³é—®é¢˜"></a>é”®ç›˜ç›¸å…³é—®é¢˜</h1><h2 id="é”®ç›˜å¼¹å‡ºåå°†å¸ƒå±€é¡¶èµ·æ¥äº†ï¼Œè€Œä¸æ˜¯é®ä½å¸ƒå±€"><a href="#é”®ç›˜å¼¹å‡ºåå°†å¸ƒå±€é¡¶èµ·æ¥äº†ï¼Œè€Œä¸æ˜¯é®ä½å¸ƒå±€" class="headerlink" title="é”®ç›˜å¼¹å‡ºåå°†å¸ƒå±€é¡¶èµ·æ¥äº†ï¼Œè€Œä¸æ˜¯é®ä½å¸ƒå±€"></a>é”®ç›˜å¼¹å‡ºåå°†å¸ƒå±€é¡¶èµ·æ¥äº†ï¼Œè€Œä¸æ˜¯é®ä½å¸ƒå±€</h2><p>è§£å†³åŠæ³•ï¼šåœ¨ <code>scafold</code> é‡Œè®¾ç½® <code>resizeToAvoidBottomInset: false</code>ï¼Œé”®ç›˜ä¼šé®ä½å¸ƒå±€ï¼Œè€Œä¸æ˜¯é¡¶èµ·å¸ƒå±€ã€‚</p>
<h2 id="å°±æƒ³è®©é”®ç›˜é¡¶èµ·å¸ƒå±€ï¼Œå¸ƒå±€å´æº¢å‡ºäº†æ€ä¹ˆåŠï¼Ÿ"><a href="#å°±æƒ³è®©é”®ç›˜é¡¶èµ·å¸ƒå±€ï¼Œå¸ƒå±€å´æº¢å‡ºäº†æ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="å°±æƒ³è®©é”®ç›˜é¡¶èµ·å¸ƒå±€ï¼Œå¸ƒå±€å´æº¢å‡ºäº†æ€ä¹ˆåŠï¼Ÿ"></a>å°±æƒ³è®©é”®ç›˜é¡¶èµ·å¸ƒå±€ï¼Œå¸ƒå±€å´æº¢å‡ºäº†æ€ä¹ˆåŠï¼Ÿ</h2><p>æº¢å‡ºè‚¯å®šæ˜¯å› ä¸ºæ²¡æœ‰é”®ç›˜æ—¶ï¼Œæ•´ä½“é«˜åº¦æ²¡æœ‰ä¸€å±é«˜ï¼Œé”®ç›˜å‡ºç°äº†ï¼Œå´è¶…å‡ºäº†ä¸€å±çš„é«˜åº¦ã€‚è§£å†³åŠæ³•å¾ˆç®€å•ï¼Œé¦–å…ˆå°†å¸ƒå±€ä½¿ç”¨ <code>SingleChildScrolleView</code> ä¹‹ç±»çš„æ»šåŠ¨ç»„ä»¶åŒ…è£¹ä½ï¼Œå°†å¸ƒå±€æ”¹å˜ä¸ºå¯æ»šåŠ¨çš„ï¼Œè¿™æ ·é”®ç›˜å¼¹å‡ºåå¸ƒå±€å°±ä¸ä¼šæº¢å‡ºäº†ã€‚</p>
<p>æ¥ç€å¯ä»¥ä½¿ç”¨ <code>WidgetsBindingObserver</code> ç±»æ¥ç›‘å¬é”®ç›˜å¼¹èµ·äº‹ä»¶ï¼Œæ¯æ¬¡å¼¹èµ·é”®ç›˜å‡ºè§¦å‘ <code>didChangeMetrics</code> é’©å­ï¼Œåœ¨è¯¥é’©å­é‡Œæ‰§è¡Œé€»è¾‘å³å¯ï¼Œä¾‹å¦‚å°† <code>SingleChildScrolleView</code> çš„å½“å‰ä½ç½®è°ƒæ•´è‡³æœ€åº•éƒ¨ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  createState() =&gt; _DemoState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_DemoState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">Demo</span>&gt; <span class="title">with</span> <span class="title">WidgetsBindingObserver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> _scrollController = ScrollController();</span><br><span class="line">  <span class="keyword">final</span> _phoneController = TextEditingController();</span><br><span class="line"></span><br><span class="line">  FocusNode _phoneFocusNode = FocusNode();</span><br><span class="line">  FocusScopeNode _focusScopeNode;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> _phoneTextFiled =&gt; TextField(</span><br><span class="line">    controller: _phoneController,</span><br><span class="line">    focusNode: _phoneFocusNode,</span><br><span class="line">    keyboardType: TextInputType.phone,</span><br><span class="line">    maxLength: <span class="number">11</span>,</span><br><span class="line">    decoration: InputDecoration(</span><br><span class="line">      hintText: <span class="string">&#x27;è¯·è¾“å…¥æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">      border: InputBorder.none,</span><br><span class="line">      counterText: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> handlePostFrame() &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_phoneFocusNode.hasFocus) &#123;</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&#x27;requestFocus&#x27;</span>);</span><br><span class="line">      _focusScopeNode.requestFocus(_phoneFocusNode);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;jumpTo&#x27;</span>);</span><br><span class="line">    _scrollController.jumpTo(_scrollController.position.maxScrollExtent);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    WidgetsBinding.instance.addObserver(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> didChangeMetrics() &#123;</span><br><span class="line">    WidgetsBinding.instance.addPostFrameCallback(handlePostFrame);</span><br><span class="line">    <span class="keyword">super</span>.didChangeMetrics();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    WidgetsBinding.instance.removeObserver(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é”®ç›˜å¼¹èµ·å’Œæ”¶å›ä¼šå¼•èµ·é¡µé¢é‡æ–°build"><a href="#é”®ç›˜å¼¹èµ·å’Œæ”¶å›ä¼šå¼•èµ·é¡µé¢é‡æ–°build" class="headerlink" title="é”®ç›˜å¼¹èµ·å’Œæ”¶å›ä¼šå¼•èµ·é¡µé¢é‡æ–°build"></a>é”®ç›˜å¼¹èµ·å’Œæ”¶å›ä¼šå¼•èµ·é¡µé¢é‡æ–°build</h2><p>æˆ‘çš„é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªæ¥è¿‘ 1 ä¸‡è¡Œä»£ç çš„è§†é¢‘è¯¦æƒ…é¡µï¼Œå…¨éƒ¨ä½¿ç”¨ <code>Provider</code> è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œå¦‚æœé”®ç›˜å¼¹èµ·ã€æ”¶å›å¼•èµ·é‡æ–° buildï¼Œå°±å¯èƒ½å‡ºç°ä¸€äº›å¥‡æ€ªçš„ BUGï¼Œæ¯”å¦‚å½“å‰çš„æ»šåŠ¨ç»„ä»¶åœ¨å±å¹•ä¸­çš„ä½ç½®å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>æˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯åˆ©ç”¨ <code>showBottomSheet</code> æ–¹æ³•ï¼Œé¡µé¢ä¸­å±•ç¤ºçš„ <code>TextField</code> ä¸Šç›–ä¸€å±‚é€æ˜é®ç½©ï¼Œä½¿ç”¨æˆ·æ— æ³•ç‚¹å‡»ï¼Œè€Œç‚¹å‡»é®ç½©æ—¶ï¼Œåˆ™è§¦å‘ <code>showBottomSheet</code>ï¼Œ push è¿›ä¸€ä¸ªæ–°çš„è·¯ç”±ï¼Œå¼¹èµ·é”®ç›˜ï¼Œå´ä¸ä¼šå¼•èµ·é‡æ–° buildï¼Œæ”¶èµ·é”®ç›˜æ—¶ï¼Œåˆ™ä¼š pop å›é¡µé¢ï¼Œå…¶å®è§†è§‰ä¸Šä¸€ç›´éƒ½ä¿æŒåœ¨åŒä¸€é¡µé¢ä¸­ï¼Œå’Œæ™®é€šçš„å¼¹èµ·é”®ç›˜æ²¡åŒºåˆ«ï¼Œå¹¶ä¸”æ€§èƒ½ä¹Ÿéå¸¸æ£’ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> textField =&gt; TextField(</span><br><span class="line">  autofocus: <span class="keyword">true</span>,</span><br><span class="line">  cursorColor: currentTheme.hoverColor,</span><br><span class="line">  cursorWidth: <span class="number">1.0</span>,</span><br><span class="line">  textInputAction: TextInputAction.done,</span><br><span class="line">  style: TextStyle(</span><br><span class="line">    color: currentTheme.primaryColorLight,</span><br><span class="line">    fontSize: setSp(<span class="number">32</span>),</span><br><span class="line">  ),</span><br><span class="line">  decoration: InputDecoration(</span><br><span class="line">    hintText: <span class="string">&#x27;å‘ä¸€å¥å‹å–„çš„è¯„è®ºæ¥è§è¯å½“ä¸‹å§&#x27;</span>,</span><br><span class="line">    hintStyle: TextStyle(fontSize: setSp(<span class="number">28</span>)),</span><br><span class="line">    contentPadding: EdgeInsets.symmetric(horizontal: setWidth(<span class="number">31</span>)),</span><br><span class="line">    filled: <span class="keyword">true</span>,</span><br><span class="line">    fillColor: currentTheme.primaryColorDark,</span><br><span class="line">    border: OutlineInputBorder(</span><br><span class="line">        borderRadius: BorderRadius.circular(setWidth(<span class="number">30</span>)),</span><br><span class="line">        borderSide: BorderSide.none</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">  onSubmitted: (value) &#123;&#125;,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">Widget buildTextFieldPage(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">return</span> SizedBox.expand(</span><br><span class="line">    child: Stack(</span><br><span class="line">      alignment: Alignment.bottomLeft,</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Positioned.fill(</span><br><span class="line">          child: GestureDetector(</span><br><span class="line">            behavior: HitTestBehavior.opaque,</span><br><span class="line">            onTap: () =&gt; Navigator.pop(context),</span><br><span class="line">            child: Container(color: Colors.black.withOpacity(<span class="number">.5</span>)),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        buildInput(),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">buildInput(&#123;hasTextField = <span class="keyword">true</span>&#125;) &#123;</span><br><span class="line">  Widget child;</span><br><span class="line"></span><br><span class="line">  child = hasTextField</span><br><span class="line">      ? Container(</span><br><span class="line">          decoration: BoxDecoration(</span><br><span class="line">            color: currentTheme.backgroundColor,</span><br><span class="line">            borderRadius: BorderRadius.circular(setWidth(<span class="number">31</span>)),</span><br><span class="line">          ),</span><br><span class="line">          child: textField,</span><br><span class="line">        )</span><br><span class="line">      : GestureDetector(</span><br><span class="line">          onTap: () &#123;</span><br><span class="line">            showBottomSheet(</span><br><span class="line">              context: context,</span><br><span class="line">              backgroundColor: Colors.transparent,</span><br><span class="line">              builder: buildTextFieldPage,</span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">          child: Container(</span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">              color: currentTheme.backgroundColor,</span><br><span class="line">              borderRadius: BorderRadius.circular(setWidth(<span class="number">31</span>)),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Container(</span><br><span class="line">    height: setWidth(<span class="number">103</span>),</span><br><span class="line">    padding: EdgeInsets.symmetric(</span><br><span class="line">      vertical: setWidth(<span class="number">20</span>),</span><br><span class="line">      horizontal: setWidth(<span class="number">25</span>),</span><br><span class="line">    ),</span><br><span class="line">    decoration: BoxDecoration(</span><br><span class="line">      border: Border(top: commentDivider),</span><br><span class="line">      color: currentTheme.primaryColor,</span><br><span class="line">    ),</span><br><span class="line">    child: Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Expanded(child: child),</span><br><span class="line">        Container(</span><br><span class="line">          width: setWidth(<span class="number">66</span>),</span><br><span class="line">          padding: EdgeInsets.only(left: setWidth(<span class="number">25</span>)),</span><br><span class="line">          alignment: Alignment.center,</span><br><span class="line">          child: Icon(</span><br><span class="line">            IcoMoon.send,</span><br><span class="line">            color: currentTheme.hoverColor.withOpacity(<span class="number">.5</span>),</span><br><span class="line">            size: setWidth(<span class="number">42</span>),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›¸å…³æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p>![input.gif](data:image&#x2F;svg+xml;utf8,<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="599" height="1238"/>)</p>
<h2 id="TextField-å¦‚ä½•æ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦"><a href="#TextField-å¦‚ä½•æ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦" class="headerlink" title="TextField å¦‚ä½•æ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦"></a>TextField å¦‚ä½•æ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦</h2><p><code>TextField</code> åœ¨æœ€å¤§è¡Œæ•°ä¸ºä¸€è¡Œæ—¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡çˆ¶çº§ <code>Container</code> é™åˆ¶ <code>TextField</code> çš„é«˜åº¦ï¼Œä¸éœ€è¦è®¾ç½®é¢å¤–å±æ€§ï¼Œä½†æ˜¯åœ¨å¤šè¡Œé«˜åº¦æ—¶ï¼Œè¿™ç§åšæ³•å°±ä¸å¤ªçµéªŒã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ä¸Šå›¾ä¸­è¯„è®ºæ¡†ä¼šæ ¹æ®è¾“å‡ºçš„å†…å®¹è‡ªåŠ¨è°ƒæ•´é«˜åº¦ï¼Œå¹¶ä¸”é™åˆ¶äº†æœ€å¤§è¡Œæ•°ä¸º 4ï¼Œè€Œè¿™ç§éœ€æ±‚åˆæ˜¯ç‰¹åˆ«å¸¸è§çš„ï¼Œæˆ‘æ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œéœ€è¦è®¾ç½® <code>TextField</code> çš„ <code>maxLine</code> å±æ€§ä¸º <code>null</code>ï¼Œè¿™æ · <code>TextField</code> å°±ä¼šæ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´é«˜åº¦</p>
<p>æ¥ç€ï¼Œè®¾ç½® <code>decoration: InputDecoration(isDense:true)</code>ï¼Œè¿™æ · <code>TextField</code> å°†å…è®¸æˆ‘ä»¬é™åˆ¶ <code>TexField</code> çš„æœ€å¤§é«˜åº¦</p>
<p>æœ€åï¼Œåˆ©ç”¨çˆ¶çº§å®¹å™¨é™åˆ¶ <code>TextField</code> çš„æœ€å¤§é«˜åº¦ï¼Œä¾‹å¦‚</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Container(</span><br><span class="line">  constraints: BoxConstraints(maxHeight: <span class="number">200</span>),</span><br><span class="line">  child: TextField(),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä»¥ä¸Šè®¾ç½®åï¼Œ <code>TextField</code> çš„é«˜åº¦å°±æ˜¯æ ¹æ®å†…å®¹è‡ªåŠ¨é€‚åº”ï¼Œå¹¶ä¸”ä¼šè¢«é™åˆ¶æœ€å¤§é«˜åº¦ï¼Œä½†æ˜¯è¿˜éœ€è¦è¯´æ˜ä¸€ç‚¹ï¼Œå¦‚ä½•ä¿è¯æœ€å¤§é«˜åº¦åˆšå¥½æ˜¯ 4 è¡Œçš„é«˜åº¦ï¼Ÿ</p>
<p>ç”±äº <code>TextField</code> æ²¡æœ‰å±æ€§æ˜¯ç”¨æ¥é™åˆ¶æ¯è¡Œé«˜åº¦çš„ï¼Œæ‰€ä»¥è¿™å°±éœ€è¦æˆ‘ä»¬è‡ªå·±è®¡ç®— <code>contentPadding</code> äº†ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">decoration: InputDecoration(</span><br><span class="line">  isDense: <span class="keyword">true</span>,</span><br><span class="line">  contentPadding: EdgeInsets.symmetric(vertical: <span class="number">20</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="TextField-è®¾ç½®-border-ä¸ç”Ÿæ•ˆ"><a href="#TextField-è®¾ç½®-border-ä¸ç”Ÿæ•ˆ" class="headerlink" title="TextField è®¾ç½® border ä¸ç”Ÿæ•ˆ"></a>TextField è®¾ç½® border ä¸ç”Ÿæ•ˆ</h2><p>TextField çš„ <code>border</code> æœ‰å¦‚ä¸‹ 3 ç§ï¼Œéœ€è¦é’ˆå¯¹æ€§åœ°è®¾ç½®ï¼Œåªè®¾ç½®ä¸€ä¸ªæ˜¯æ— æ³•ç”Ÿæ•ˆçš„ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decoration: InputDecoration(border enabledBorder focusBorder)</span><br></pre></td></tr></table></figure>

<p>psï¼šè®¾ç½® <code>maxLength</code> å±æ€§åï¼Œ<code>decoration</code> é‡Œéœ€è¦è®¾ç½® <code>counterText: &#39;&#39;</code>ï¼Œå¦åˆ™é»˜è®¤ä¼šé™„å¸¦ä¸€ä¸ªç»Ÿè®¡å­—æ•°çš„æ ·å¼ã€‚</p>
<h1 id="è·¯ç”±è·³è½¬ç›¸å…³é—®é¢˜"><a href="#è·¯ç”±è·³è½¬ç›¸å…³é—®é¢˜" class="headerlink" title="è·¯ç”±è·³è½¬ç›¸å…³é—®é¢˜"></a>è·¯ç”±è·³è½¬ç›¸å…³é—®é¢˜</h1><h2 id="pushã€pop-å¸¸è§éœ€æ±‚"><a href="#pushã€pop-å¸¸è§éœ€æ±‚" class="headerlink" title="pushã€pop å¸¸è§éœ€æ±‚"></a>pushã€pop å¸¸è§éœ€æ±‚</h2><p>ä¾‹å¦‚æµè§ˆè®°å½•ä¸­æœ‰å¦‚ä¸‹ 4 ä¸ªé¡µé¢ï¼Œå½“å‰é¡µé¢ä¸º <code>d</code>ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a-&gt;b-&gt;c-&gt;d</span><br></pre></td></tr></table></figure>

<p>åœ¨å½“å‰é¡µé¢ä½¿ç”¨ <code>Navigator.popUtil(context, ModalRoute.withName(&#39;a&#39;))</code>ï¼Œå¯ä»¥ç›´æ¥è¿”å›è‡³ <code>a</code> é¡µé¢ï¼Œå¹¶é”€æ¯ <code>b</code>ã€<code>c</code> é¡µé¢ã€‚</p>
<p>åœ¨å½“å‰é¡µé¢ä½¿ç”¨ <code>Navigator.pushNamedAndRemoveUntil(context, &#39;e&#39;, (route) =&gt; false)</code>ï¼Œå¯ä»¥è¿›å…¥ <code>e</code> é¡µé¢ä¹‹å‰ï¼Œé”€æ¯æ‰€æœ‰å†å²è®°å½•ï¼Œå³ <code>e</code> é¡µé¢å˜æˆç¬¬ä¸€é¡µï¼Œ<code>e</code> é¡µé¢é‡Œæ— æ³•ç»§ç»­ <code>pop</code> è¿”å›ä¸Šä¸€é¡µã€‚</p>
<h2 id="å¦‚ä½•åœ¨-initState-é˜¶æ®µå°±èƒ½ä½¿ç”¨-context"><a href="#å¦‚ä½•åœ¨-initState-é˜¶æ®µå°±èƒ½ä½¿ç”¨-context" class="headerlink" title="å¦‚ä½•åœ¨ initState é˜¶æ®µå°±èƒ½ä½¿ç”¨ context"></a>å¦‚ä½•åœ¨ initState é˜¶æ®µå°±èƒ½ä½¿ç”¨ context</h2><p>Flutter æœ‰ä¸€äº›éœ€è¦ä½¿ç”¨ <code>context</code> çš„æ–¹æ³•ï¼Œä¾‹å¦‚ <code>Theme.of(context)</code>ã€<code>Navigator.of(context)</code> ç­‰ç­‰ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ build æ–¹æ³•ä¸­æ‰èƒ½æ‹¿åˆ° <code>context</code>ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å®šä¹‰ç±»çš„å±æ€§æ—¶å°±ç›´æ¥ä½¿ç”¨ <code>Theme.of(context)</code> æ˜¾ç„¶æ˜¯æ²¡åŠæ³•åšåˆ°çš„ï¼Œç¼–è¾‘å™¨éƒ½ä¼šç›´æ¥æç¤ºè¯­æ³•é”™è¯¯ã€‚</p>
<p>è§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ <code>constants.dart</code> ç”¨äºä¿å­˜é¡¹ç›®çš„å…¨å±€å˜é‡ï¼Œåœ¨ <code>Contants</code> ç±»ä¸­å£°æ˜ä¸€ä¸ª <code>navigatorKey</code>ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Constants</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> GlobalKey&lt;NavigatorState&gt; navigatorKey = GlobalKey&lt;NavigatorState&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€åœ¨ <code>MaterailApp</code> ä¸‹æŒ‚è½½ <code>navigatorKey</code> ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MaterialApp(navigatorKey: Constants.navigatorKey)</span><br></pre></td></tr></table></figure>

<p>æœ€ååœ¨ <code>constants.dart</code> ä¸­å£°æ˜å¦‚ä¸‹ 3 ä¸ª <code>getter</code>ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NavigatorState <span class="keyword">get</span> navigatorState =&gt; Constants.navigatorKey.currentState;</span><br><span class="line">BuildContext <span class="keyword">get</span> currentContext =&gt; navigatorState.context;</span><br><span class="line">ThemeData <span class="keyword">get</span> currentTheme =&gt; Theme.of(currentContext);</span><br></pre></td></tr></table></figure>

<p>ç”±äºæ‰€æœ‰ç»„ä»¶éƒ½æ˜¯æŒ‚è½½åœ¨ <code>MaterialApp</code> ä¸‹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä»»ä½•ä¸€ä¸ªç»„ä»¶ä¸­å¼•å…¥äº† <code>constants.dart</code>ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ 3 ä¸ª <code>getter</code>ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> box = GestureDetector(</span><br><span class="line">    onTap: navigatorState.pop,</span><br><span class="line">    child: Text(<span class="string">&#x27;è¿”å›ä¸Šä¸€é¡µ&#x27;</span>),</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">final</span> userModel = Provider.of&lt;UserModel&gt;(currentContext, listen: <span class="keyword">false</span>);</span><br><span class="line">  <span class="keyword">final</span> primaryColor = currentTheme.primaryColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç ç­‰ä»·äºï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  Widget box;</span><br><span class="line">  UserModel userModel;</span><br><span class="line">  Color primaryColor;</span><br><span class="line">  </span><br><span class="line">  build(context) &#123;</span><br><span class="line">    box = GestureDetector(</span><br><span class="line">      onTap: Navigator.of(context).pop,</span><br><span class="line">      child: Text(<span class="string">&#x27;è¿”å›ä¸Šä¸€é¡µ&#x27;</span>),</span><br><span class="line">    );</span><br><span class="line">    userModel = Provider.of&lt;UserModel&gt;(context, listen: <span class="keyword">false</span>);</span><br><span class="line">    primaryColor = Theme.of(context).primaryColor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Mac-ç¯å¢ƒ-build-æ—¶çš„é”™è¯¯"><a href="#Mac-ç¯å¢ƒ-build-æ—¶çš„é”™è¯¯" class="headerlink" title="Mac ç¯å¢ƒ build æ—¶çš„é”™è¯¯"></a>Mac ç¯å¢ƒ build æ—¶çš„é”™è¯¯</h1><p>æç¤ºå¦‚ä¸‹ï¼š</p>
<p>Automatically assigning platform <code>iOS</code> with version <code>9.0</code> on target <code>Runner</code> because no platform was specified. Please specify a platform for this target in your Podfile.</p>
<p>è§£å†³åŠæ³•æ˜¯ï¼šåˆ é™¤ <code>pod</code> æ–‡ä»¶ä¸­ <code>platform</code>å‰çš„ <code>#</code></p>
<p>å› ä¸ºæ²¡æœ‰åšè¿‡åŸç”Ÿå¼€å‘ï¼Œæ‰€ä»¥å¯¹äºè¿™ç§ build é—®é¢˜çœŸçš„æ˜¯ä¸€è„¸èŒ«ç„¶ï¼Œæœ€å¼€å§‹é‡åˆ°è¿‡å‡ æ¬¡ç±»ä¼¼é”™è¯¯ï¼Œæˆ‘é€šè¿‡ç½‘ä¸Šæœç´¢ç­”æ¡ˆã€ç¾¤é‡Œé—®å¤§ä½¬æ¥è§£å†³ï¼Œéå¸¸ä¹‹éº»çƒ¦ã€‚æ‰€ä»¥åæ¥æˆ‘åœ¨ Mac ç¯å¢ƒ build äº§ç”Ÿé”™è¯¯æ—¶ï¼Œéƒ½æ˜¯ç›´æ¥é‡å»ºé¡¹ç›®ï¼ŒæŠŠé€»è¾‘ä»£ç å¤åˆ¶è¿›æ–°é¡¹ç›®é‡Œï¼Œå†é‡æ–° build å°±ä¸ä¼šå‘ç”Ÿå„ç§ä¹±ä¸ƒå…«ç³Ÿçœ‹ä¸æ‡‚çš„é”™è¯¯äº†ï¼Œæ•ˆç‡ä¹Ÿå¿«ã€‚</p>
<h1 id="PageViewã€ListView-ç­‰æ»šåŠ¨ç»„ä»¶åˆ‡æ¢é¡µé¢è¿”å›åçš„é«˜åº¦ä½ç½®è¢«æ”¹å˜äº†"><a href="#PageViewã€ListView-ç­‰æ»šåŠ¨ç»„ä»¶åˆ‡æ¢é¡µé¢è¿”å›åçš„é«˜åº¦ä½ç½®è¢«æ”¹å˜äº†" class="headerlink" title="PageViewã€ListView ç­‰æ»šåŠ¨ç»„ä»¶åˆ‡æ¢é¡µé¢è¿”å›åçš„é«˜åº¦ä½ç½®è¢«æ”¹å˜äº†"></a>PageViewã€ListView ç­‰æ»šåŠ¨ç»„ä»¶åˆ‡æ¢é¡µé¢è¿”å›åçš„é«˜åº¦ä½ç½®è¢«æ”¹å˜äº†</h1><p>è§£å†³åŠæ³•ï¼šç»™æ»šåŠ¨ç»„ä»¶åŠ ä¸Š <code>key</code> å±æ€§ï¼Œç”¨äºä¿å­˜ä½ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š <code>key: PageStorageKey(1)</code></p>
<p>å…¶å®ä¸€èˆ¬çš„ ListView è¿˜æ— æ³•æ»¡è¶³æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­å„ç§èŠ±å¼çš„éœ€æ±‚ï¼Œæ¨èä½¿ç”¨æ³•ä½¬çš„ <a target="_blank" rel="noopener" href="https://github.com/fluttercandies/extended_nested_scroll_view">NestedScrollView</a></p>
<p>æ³•ä½¬å·²ç»ç»™æˆ‘ä»¬è§£å†³äº†å¾ˆå¤šå¥‡æ€ªçš„ bugï¼Œè¿˜è¦ä»€ä¹ˆè‡ªè¡Œè½¦ï¼Ÿ</p>
<h1 id="å¦‚ä½•ç›‘å¬-App-è¿”å›æ¡Œé¢äº‹ä»¶"><a href="#å¦‚ä½•ç›‘å¬-App-è¿”å›æ¡Œé¢äº‹ä»¶" class="headerlink" title="å¦‚ä½•ç›‘å¬ App è¿”å›æ¡Œé¢äº‹ä»¶"></a>å¦‚ä½•ç›‘å¬ App è¿”å›æ¡Œé¢äº‹ä»¶</h1><p>æˆ‘éœ€è¦å½“ app è¿”å›æ¡Œé¢æ—¶æš‚åœè§†é¢‘çš„æ’­æ”¾ï¼Œä»æ¡Œé¢è¿”å› app åå†ç»§ç»­æ’­æ”¾ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_DemoState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">Demo</span>&gt; <span class="title">with</span> <span class="title">WidgetsBindingObserver</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> didChangeAppLifecycleState(AppLifecycleState state) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;app lifecycle state: <span class="subst">$state</span>&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (state == AppLifecycleState.inactive) &#123;</span><br><span class="line">      _playerModel.pausePlayer();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (state == AppLifecycleState.resumed) &#123;</span><br><span class="line">      <span class="keyword">if</span> (_homeModel.isFindPage) _playerModel.startPlayer();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">super</span>.didChangeAppLifecycleState(state);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>WidgetsBindingObserver è¿™ä¸ªç±»æˆ‘ç»å¸¸ä½¿ç”¨ï¼Œä¾‹å¦‚ç›‘å¬é”®ç›˜å¼¹èµ·äº‹ä»¶ä¹Ÿä¼šç”¨åˆ°è¿™ä¸ªç±»ã€‚</p>
<h1 id="Dio-å°æŠ€å·§"><a href="#Dio-å°æŠ€å·§" class="headerlink" title="Dio å°æŠ€å·§"></a>Dio å°æŠ€å·§</h1><p>ä½¿ç”¨ Dio è¿›è¡Œ HTTP è¯·æ±‚æ—¶ï¼Œè¯·æ±‚å¤´ <code>content-type</code> çš„é»˜è®¤å€¼æ˜¯</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">application/json; charset=utf<span class="number">-8</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¿”å›å¤´çš„ <code>content-type</code> æ˜¯</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">application/json</span><br></pre></td></tr></table></figure>

<p>Dio å°†è‡ªåŠ¨è§£æè¿”å› json æ•°æ®ä¸º Dart ç›¸åº”çš„æ•°æ®ç±»å‹ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨åœ°è°ƒç”¨ <code>jsonDecode</code> æ–¹æ³•ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯çš„ç»Ÿä¸€ä½¿ç”¨ <code>application/json</code> ä½œä¸º  <code>content-type</code>ï¼Œä»–å¥½æˆ‘ä¹Ÿå¥½ã€‚</p>
<h1 id="Android-æ‰“åŒ…åæ— æ³•è¿›è¡Œç½‘ç»œè¯·æ±‚"><a href="#Android-æ‰“åŒ…åæ— æ³•è¿›è¡Œç½‘ç»œè¯·æ±‚" class="headerlink" title="Android æ‰“åŒ…åæ— æ³•è¿›è¡Œç½‘ç»œè¯·æ±‚"></a>Android æ‰“åŒ…åæ— æ³•è¿›è¡Œç½‘ç»œè¯·æ±‚</h1><p>åœ¨æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨ Flutter æ‰“åŒ…é¡¹ç›®æ—¶é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œæœ€åå‘ç°æ˜¯æ²¡æœ‰ç½‘ç»œè¯·æ±‚çš„æƒé™ï¼Œç±»ä¼¼çš„ï¼Œå‚¨å­˜è¯»å–æœ¬åœ°æ–‡ä»¶æ—¶å¯èƒ½ä¹Ÿä¼šæœ‰ç±»ä¼¼é—®é¢˜ï¼Œè¿™ç§é—®é¢˜è®¾ç½®æƒé™å°±å¯ä»¥è§£å†³äº†ã€‚</p>
<p>åœ¨ <code>android/app/src/profile/AndroidManifest.xml</code> ä¸­</p>
<p>ä»¥åŠ <code>android/app/src/main/AndroidManifest.xml</code> ä¸¤ä¸ªæ–‡ä»¶çš„ <code>manifest</code> æ ‡ç­¾å†…æ·»åŠ å¦‚ä¸‹å­æ ‡ç­¾å³å¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_PHONE_STATE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_WIFI_STATE&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>





<h1 id="å¯¹äºç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•çš„å®šä¹‰è§„èŒƒçš„ä¸€äº›å»ºè®®"><a href="#å¯¹äºç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•çš„å®šä¹‰è§„èŒƒçš„ä¸€äº›å»ºè®®" class="headerlink" title="å¯¹äºç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•çš„å®šä¹‰è§„èŒƒçš„ä¸€äº›å»ºè®®"></a>å¯¹äºç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•çš„å®šä¹‰è§„èŒƒçš„ä¸€äº›å»ºè®®</h1><ul>
<li>ä¸å¼•ç”¨å…¶ä»–å±æ€§çš„æˆå‘˜ï¼Œå®šä¹‰ä¸ºå±æ€§</li>
<li>å¼•ç”¨å…¶ä»–å±æ€§ï¼Œä¸”ä¸æ¥æ”¶å‚æ•°çš„æˆå‘˜ï¼Œå®šä¹‰ä¸ºgetter</li>
<li>å¼•ç”¨å…¶ä»–å±æ€§ï¼Œä¸”æ¥å—å‚æ•°çš„æˆå‘˜ï¼Œå®šä¹‰ä¸ºfunction</li>
</ul>
<h1 id="å…¨å±ç›¸å…³è®¾ç½®"><a href="#å…¨å±ç›¸å…³è®¾ç½®" class="headerlink" title="å…¨å±ç›¸å…³è®¾ç½®"></a>å…¨å±ç›¸å…³è®¾ç½®</h1><p>å¼ºåˆ¶ç«–å±ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> initState() &#123;</span><br><span class="line">  SystemChrome.setPreferredOrientations([</span><br><span class="line">    DeviceOrientation.portraitUp,</span><br><span class="line">    DeviceOrientation.portraitDown</span><br><span class="line">  ]);</span><br><span class="line">  <span class="keyword">super</span>.initState();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¼ºåˆ¶æ¨ªå±ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">initState() &#123;</span><br><span class="line">  SystemChrome.setPreferredOrientations([</span><br><span class="line">    DeviceOrientation.landscapeLeft,</span><br><span class="line">    DeviceOrientation.landscapeRight</span><br><span class="line">  ]);</span><br><span class="line">  <span class="keyword">super</span>.initState();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h1 id="Transform-3D-è½¬æ¢"><a href="#Transform-3D-è½¬æ¢" class="headerlink" title="Transform 3D è½¬æ¢"></a>Transform 3D è½¬æ¢</h1><p>æ¨èä½¿ç”¨ <code>Transform</code> ç»„ä»¶æ¥å®ŒæˆåŠ¨ç”»æ•ˆæœï¼Œä¾‹å¦‚ <code>Transform.translate</code> å’Œ  <code>Transform.scale</code> å¯ä»¥å®Œæˆä½ç½®ã€ç¼©æ”¾çš„å˜åŒ–ï¼Œ <code>Transform.rotate</code>  å¯ä»¥å®Œæˆæ—‹è½¬è§’åº¦çš„å˜åŒ–ã€‚</p>
<p><code>Transform.rotate</code>  å’Œ <code>RotateBox</code> éƒ½å¯ä»¥å®Œæˆæ—‹è½¬åŠŸèƒ½ï¼Œä»–ä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p>ä½¿ç”¨ <code>RotateBox</code> æ¸²æŸ“ widget æ˜¯åœ¨ layout é˜¶æ®µï¼Œæ¸²æŸ“å®Œæ¯•åå°±ä¼šå ç”¨å®é™…ä½ç½®ï¼Œè€Œ <code>Transform</code> ç»„ä»¶åˆ™æ˜¯åœ¨ layout ä¹‹åçš„ç»˜åˆ¶é˜¶æ®µï¼Œ <code>Transform</code> åªæ˜¯ä¸€ä¸ªè§†è§‰æ•ˆæœï¼Œå®é™…æ‰€å ç©ºé—´å¤§å°æ˜¯ transform å˜åŒ–ä¹‹å‰æ‰€å ç”¨çš„ç©ºé—´å¤§å°ï¼Œæ‰€ä»¥é‡æ–°æ¸²æŸ“ <code>Transform.rotate</code> ç»„ä»¶æ¯”é‡æ–°æ¸²æŸ“ <code>RotateBox</code> å¼€é”€æ›´å°ã€‚</p>
<p>Flutter çš„ <code>Transform</code> ç»„ä»¶çš„è¿™ä¸ªç‰¹æ€§å’Œ CSS çš„ <code>transform</code> å±æ€§éå¸¸ç›¸ä¼¼ï¼Œéƒ½å¯ä»¥ç”¨æ¥æå‡åŠ¨ç”»æ€§èƒ½ã€‚</p>
<p>ä¸è¿‡åšè§†é¢‘å…¨å±åŠŸèƒ½æ—¶ï¼Œå¯ä»¥ç”¨ <code>IndexedStack</code> + <code>RotateBox</code> æ›¿ä»£ push ä¸€ä¸ªæ¨ªå±çš„è·¯ç”±çš„åšæ³•ï¼Œ<code>RotateBox</code> å®ƒä¼šä½¿å®¹å™¨å¡«å……å…¨å±ï¼Œè€Œ <code>IndexedStack</code> å¯ä»¥æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºå…¨å±ï¼Œè¿™é‡Œå¦‚æœä½¿ç”¨ <code>Transform</code> åˆ™æ— æ³•å¡«å……å…¨å±ï¼Œå› ä¸ºå®¹å™¨çš„å®½é«˜åœ¨ layout æ—¶å°±å·²ç»ç¡®å®šäº†ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨ <code>RotateBox</code>ã€‚</p>
<h2 id="è§†é¢‘é•œåƒç¿»è½¬"><a href="#è§†é¢‘é•œåƒç¿»è½¬" class="headerlink" title="è§†é¢‘é•œåƒç¿»è½¬"></a>è§†é¢‘é•œåƒç¿»è½¬</h2><p>æˆ‘åœ¨é¡¹ç›®ä¸­ä¸ä»…ä½¿ç”¨ RotatedBox å®Œæˆè§†é¢‘å…¨å±åŠŸèƒ½ï¼Œè¿˜åˆ©ç”¨äº† <code>Transform</code> æ¥å®Œæˆé•œåƒç¿»è½¬åŠŸèƒ½ï¼Œå†™æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Selector&lt;VideoModel, <span class="built_in">bool</span>&gt;(</span><br><span class="line">  selector: (context, model) =&gt; model.isMirror,</span><br><span class="line">    builder: (context, isMirror, child) =&gt; Transform(</span><br><span class="line">      alignment: Alignment.center,</span><br><span class="line">      transform: Matrix4.identity()..setEntry(<span class="number">3</span>, <span class="number">2</span>, <span class="number">0.006</span>)..rotateY(isMirror ? math.pi : <span class="number">0</span>),</span><br><span class="line">      child: child,</span><br><span class="line">    ),</span><br><span class="line">    child: FijkView(</span><br><span class="line">    player: model.player,</span><br><span class="line">    color: Colors.black,</span><br><span class="line">    panelBuilder: (player, context, size, pos) =&gt; emptyBox,</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>åŸç†å¾ˆç®€å•ï¼ŒFijkView æ˜¯ fijkplayer æä¾›çš„è§†é¢‘å®¹å™¨ï¼Œæˆ‘å°†è§†é¢‘å®¹å™¨ä»¥ä¸­å¿ƒä½ç½®ä¸ºåœ†å¿ƒï¼Œæ²¿ Y è½´åšä¸€ä¸ª 180 åº¦çš„æ—‹è½¬ï¼Œå³å¯æ»¡è¶³éœ€æ±‚ã€‚</p>
<p><code>setEntry</code> ç”¨äºè®¾ç½®é€è§†ï¼Œå¦åˆ™å°†æ— æ³•çœ‹åˆ° Y è½´åŠ X è½´çš„ç«‹ä½“è½¬æ¢æ•ˆæœ</p>
<p><code>rotateY</code> åˆ™ä¸ css ä¸­çš„ <code>rotateY</code> æ˜¯ç›¸åŒå«ä¹‰ï¼Œå³æ²¿ Y è½´æ—‹è½¬ã€‚åœ¨ css ä¸­å¯ä»¥è®¾ç½® <code>transform: rotateY(180deg)</code> æ¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚</p>
<h1 id="çŠ¶æ€æ ç›¸å…³è®¾ç½®"><a href="#çŠ¶æ€æ ç›¸å…³è®¾ç½®" class="headerlink" title="çŠ¶æ€æ ç›¸å…³è®¾ç½®"></a>çŠ¶æ€æ ç›¸å…³è®¾ç½®</h1><p>éšè—çŠ¶æ€æ ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/services.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> toggleFullscreen() &#123;</span><br><span class="line">  _isFullscreen = !_isFullscreen;</span><br><span class="line">  _isFullscreen</span><br><span class="line">      ? SystemChrome.setEnabledSystemUIOverlays([])</span><br><span class="line">      : SystemChrome.setEnabledSystemUIOverlays(SystemUiOverlay.values);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ”¹å˜çŠ¶æ€æ é¢œè‰²ï¼Œåˆ™éœ€è¦ä½¿ç”¨æ’ä»¶ï¼š<code>flutter_statusbarcolor</code>ï¼Œä¸‹é¢æ˜¯ç”¨æ³•ç¤ºä¾‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ”¹å˜çŠ¶æ€æ èƒŒæ™¯é¢œè‰²ï¼Œé»˜è®¤æ”¹å˜ä¸ºé€æ˜</span></span><br><span class="line">Future&lt;<span class="keyword">void</span>&gt; changeStatusColor(&#123;Color color: Colors.transparent&#125;) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> FlutterStatusbarcolor.setStatusBarColor(</span><br><span class="line">      color,</span><br><span class="line">      animate: <span class="keyword">true</span>,</span><br><span class="line">    );</span><br><span class="line">    FlutterStatusbarcolor.setStatusBarWhiteForeground(<span class="keyword">true</span>);</span><br><span class="line">    FlutterStatusbarcolor.setNavigationBarWhiteForeground(<span class="keyword">true</span>);</span><br><span class="line">  &#125; <span class="keyword">on</span> PlatformException <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    debugPrint(e.toString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢ä»‹ç»ä¸€ä¸ªç”¨æ³•ï¼Œæˆ‘çš„ home é¡µä½¿ç”¨ <code>indexStack</code>  ç»„ä»¶åŒ…å«äº† 4 ä¸ª tab é¡µï¼Œæ¯æ¬¡æ›´æ”¹ tab ä¼šæ”¹å˜ <code>currentHomeTab</code> çš„å€¼ï¼Œä½†ä¸ä¼šè§¦å‘é‡æ–° buildï¼Œè€Œç”±äºè·¯ç”± <code>push</code> æˆ– <code>pop</code> åˆä¼šè§¦å‘é‡æ–° buildï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å½“è¿›å…¥ home é¡µçš„ <code>å‘ç° tab é¡µ</code> æ—¶æ”¹å˜ä¸ºé»‘è‰²çŠ¶æ€æ ï¼Œåˆ™å¯ä»¥ç”¨ä¸‹é¢è¿™ç§åšæ³•ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å‘ç°é¡µçš„ build æ–¹æ³•é‡Œè¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="meta">@override</span></span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">if</span> (ModalRoute.of(context).isCurrent &amp;&amp; currentHomeTab == <span class="string">&#x27;å‘ç°&#x27;</span>) &#123;</span><br><span class="line">    changeStatusColor(color: Colors.black);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h1 id="fijkplayer-ç§’å¼€ã€è¿›åº¦è·³è½¬ç­‰ä¼˜åŒ–"><a href="#fijkplayer-ç§’å¼€ã€è¿›åº¦è·³è½¬ç­‰ä¼˜åŒ–" class="headerlink" title="fijkplayer ç§’å¼€ã€è¿›åº¦è·³è½¬ç­‰ä¼˜åŒ–"></a>fijkplayer ç§’å¼€ã€è¿›åº¦è·³è½¬ç­‰ä¼˜åŒ–</h1><p>fijkplayer é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿›åº¦è·³è½¬ã€æ’­æ”¾å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œé’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œå¯ä»¥è¿›è¡Œä»¥ä¸‹ä¼˜åŒ–ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">_player.setDataSource(_video.src);</span><br><span class="line"><span class="keyword">await</span> _player.applyOptions(</span><br><span class="line">    FijkOption()</span><br><span class="line">      ..setFormatOption(<span class="string">&#x27;flush_packets&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">      ..setFormatOption(<span class="string">&#x27;analyzemaxduration&#x27;</span>, <span class="number">100</span>)</span><br><span class="line">      ..setFormatOption(<span class="string">&#x27;analyzeduration&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">      ..setCodecOption(<span class="string">&#x27;skip_loop_filter&#x27;</span>, <span class="number">48</span>)</span><br><span class="line">      ..setPlayerOption(<span class="string">&#x27;start-on-prepared&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">      ..setPlayerOption(<span class="string">&#x27;packet-buffering&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">      ..setPlayerOption(<span class="string">&#x27;framedrop&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">      ..setPlayerOption(<span class="string">&#x27;enable-accurate-seek&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">      ..setPlayerOption(<span class="string">&#x27;find_stream_info&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">      ..setPlayerOption(<span class="string">&#x27;render-wait-start&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">await</span> _player.prepareAsync();</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c8c755ed61ee">IjkPlayer èµ·æ’­é€Ÿåº¦ä¼˜åŒ–</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/843c86a9e9ad">IjkPlayer æ’­æ”¾å™¨ç§’å¼€ä¼˜åŒ–ä»¥åŠå¸¸ç”¨ Option è®¾ç½®</a></p>
<h1 id="LayoutBuilder-ç›¸å…³çš„å®è·µ"><a href="#LayoutBuilder-ç›¸å…³çš„å®è·µ" class="headerlink" title="LayoutBuilder ç›¸å…³çš„å®è·µ"></a>LayoutBuilder ç›¸å…³çš„å®è·µ</h1><h2 id="å¦‚ä½•å®ç°å¾®ä¿¡æœ‹å‹åœˆã€å“”å“©å“”å“©è¯„è®ºçš„å¤šè¡Œæ–‡æœ¬æ”¶èµ·ã€å±•å¼€åŠŸèƒ½"><a href="#å¦‚ä½•å®ç°å¾®ä¿¡æœ‹å‹åœˆã€å“”å“©å“”å“©è¯„è®ºçš„å¤šè¡Œæ–‡æœ¬æ”¶èµ·ã€å±•å¼€åŠŸèƒ½" class="headerlink" title="å¦‚ä½•å®ç°å¾®ä¿¡æœ‹å‹åœˆã€å“”å“©å“”å“©è¯„è®ºçš„å¤šè¡Œæ–‡æœ¬æ”¶èµ·ã€å±•å¼€åŠŸèƒ½"></a>å¦‚ä½•å®ç°å¾®ä¿¡æœ‹å‹åœˆã€å“”å“©å“”å“©è¯„è®ºçš„å¤šè¡Œæ–‡æœ¬æ”¶èµ·ã€å±•å¼€åŠŸèƒ½</h2><p>æˆ‘å†™äº†ä¸‹é¢è¿™ä¸ªå·¥å…·ç±»ï¼Œç®€å•ã€å¥½ç”¨å¾—æˆ‘éƒ½æ¯äº†ï¼ŒåŸç†æ˜¯åˆ©ç”¨å…ˆ <code>LayoutBuilder</code> åˆ¤æ–­æ˜¯å¦è¶…å‡ºæŒ‡å®šçš„è¡Œæ•°ï¼Œå¦‚æœè¶…å‡ºåˆ™è¿”å› <code>Column</code>ï¼Œå¦‚æœæœªè¶…å‡ºåˆ™è¿”å›åŸ widget</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExpandableText</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> text;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> maxLines;</span><br><span class="line">  <span class="keyword">final</span> TextStyle style;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">bool</span> expand;</span><br><span class="line">  <span class="keyword">final</span> TextStyle markerStyle;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> atName;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> ExpandableText(<span class="keyword">this</span>.text, &#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.maxLines,</span><br><span class="line">    <span class="keyword">this</span>.style,</span><br><span class="line">    <span class="keyword">this</span>.markerStyle,</span><br><span class="line">    <span class="keyword">this</span>.expand = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.atName = <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  &#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  createState() =&gt; _ExpandableTextState();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_ExpandableTextState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">ExpandableText</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool</span> expand;</span><br><span class="line">  TextStyle style;</span><br><span class="line">  <span class="built_in">int</span> maxLines;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    expand = widget.expand;</span><br><span class="line">    style = widget.style;</span><br><span class="line">    maxLines = widget.maxLines;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Widget buildOrdinaryText() &#123;</span><br><span class="line">    <span class="keyword">final</span> text = widget.text;</span><br><span class="line">    <span class="keyword">return</span> LayoutBuilder(builder: (_, size) &#123;</span><br><span class="line">      <span class="keyword">final</span> tp = TextPainter(</span><br><span class="line">        text: TextSpan(text: text, style: style),</span><br><span class="line">        maxLines: maxLines,</span><br><span class="line">        textDirection: TextDirection.ltr,</span><br><span class="line">      );</span><br><span class="line">      tp.layout(maxWidth: size.maxWidth);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!tp.didExceedMaxLines) <span class="keyword">return</span> Text(text, style: style);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> Builder(</span><br><span class="line">        builder: (context) =&gt; Column(</span><br><span class="line">          crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Text(text, maxLines: expand ? <span class="keyword">null</span> : widget.maxLines, style: style),</span><br><span class="line">            GestureDetector(</span><br><span class="line">              onTap: () &#123;</span><br><span class="line">                expand = !expand;</span><br><span class="line">                (context <span class="keyword">as</span> <span class="built_in">Element</span>).markNeedsBuild();</span><br><span class="line">              &#125;,</span><br><span class="line">              child: Text(</span><br><span class="line">                expand ? <span class="string">&#x27;æ”¶èµ·&#x27;</span> : <span class="string">&#x27;å±•å¼€&#x27;</span>,</span><br><span class="line">                style: widget.markerStyle,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Widget buildAtText() &#123;</span><br><span class="line">    <span class="keyword">return</span> LayoutBuilder(builder: (_, size) &#123;</span><br><span class="line">      <span class="keyword">final</span> tp = TextPainter(</span><br><span class="line">        text: TextSpan(text: <span class="string">&#x27;å›å¤ @<span class="subst">$&#123;widget.text&#125;</span>ï¼š&#x27;</span>, style: style),</span><br><span class="line">        maxLines: maxLines,</span><br><span class="line">        textDirection: TextDirection.ltr,</span><br><span class="line">      );</span><br><span class="line">      tp.layout(maxWidth: size.maxWidth);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!tp.didExceedMaxLines) <span class="keyword">return</span> Text.rich(</span><br><span class="line">        TextSpan(</span><br><span class="line">          children: [</span><br><span class="line">            TextSpan(text: <span class="string">&#x27;å›å¤ &#x27;</span>),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27;@<span class="subst">$&#123;widget.atName&#125;</span>&#x27;</span>, style: widget.markerStyle),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27;ï¼š<span class="subst">$&#123;widget.text&#125;</span>&#x27;</span>),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        style: style,</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> Builder(</span><br><span class="line">        builder: (context) =&gt; Column(</span><br><span class="line">          crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Text.rich(</span><br><span class="line">              TextSpan(</span><br><span class="line">                children: [</span><br><span class="line">                  TextSpan(text: <span class="string">&#x27;å›å¤ &#x27;</span>),</span><br><span class="line">                  TextSpan(text: <span class="string">&#x27;@<span class="subst">$&#123;widget.atName&#125;</span>&#x27;</span>, style: widget.markerStyle),</span><br><span class="line">                  TextSpan(text: <span class="string">&#x27;ï¼š<span class="subst">$&#123;widget.text&#125;</span>&#x27;</span>),</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">              maxLines: expand ? <span class="keyword">null</span> : widget.maxLines,</span><br><span class="line">              style: style,</span><br><span class="line">            ),</span><br><span class="line">            GestureDetector(</span><br><span class="line">              onTap: () &#123;</span><br><span class="line">                expand = !expand;</span><br><span class="line">                (context <span class="keyword">as</span> <span class="built_in">Element</span>).markNeedsBuild();</span><br><span class="line">              &#125;,</span><br><span class="line">              child: Text(</span><br><span class="line">                expand ? <span class="string">&#x27;æ”¶èµ·&#x27;</span> : <span class="string">&#x27;å±•å¼€&#x27;</span>,</span><br><span class="line">                style: widget.markerStyle,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  build(context) =&gt; widget.atName == <span class="string">&#x27;&#x27;</span> ? buildOrdinaryText() : buildAtText();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Container(</span><br><span class="line">  padding: EdgeInsets.only(top: setWidth(<span class="number">6</span>), bottom: setWidth(<span class="number">11</span>)),</span><br><span class="line">  alignment: Alignment.centerLeft,</span><br><span class="line">  child: ExpandableText(</span><br><span class="line">    reply.content,</span><br><span class="line">    maxLines: <span class="number">4</span>,</span><br><span class="line">    style: commentTextStyle,</span><br><span class="line">    markerStyle: commentMarkerStyle,</span><br><span class="line">    atName: reply.isDirect &gt; <span class="number">0</span> ? <span class="string">&#x27;&#x27;</span> : reply.pNickname,</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure>

<p>ç›¸å…³æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p>![extendable.gif](data:image&#x2F;svg+xml;utf8,<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="599" height="750"/>)</p>
<h2 id="ç›‘å¬çˆ¶çº§-widget-çš„å®é™…å®½é«˜ä¿¡æ¯"><a href="#ç›‘å¬çˆ¶çº§-widget-çš„å®é™…å®½é«˜ä¿¡æ¯" class="headerlink" title="ç›‘å¬çˆ¶çº§ widget çš„å®é™…å®½é«˜ä¿¡æ¯"></a>ç›‘å¬çˆ¶çº§ widget çš„å®é™…å®½é«˜ä¿¡æ¯</h2><p>LayoutBuilder çš„ä½œç”¨éå¸¸å¤§ï¼Œå¯ä»¥ç”¨å®ƒæ¥ç›‘å¬æŸä¸ªwidgetçš„å®½é«˜ä¿¡æ¯ï¼Œæˆ‘åœ¨é¡¹ç›®ä¸­é‡åˆ°äº† ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦æ ¹æ®æŸä¸ª widget çš„é«˜åº¦æ¥å¼¹å‡º BottomSheetï¼Œè€Œè¿™ä¸ª widget çš„é«˜åº¦æ˜¯å¯ä»¥æ»‘åŠ¨æ”¹å˜çš„ï¼Œé‚£ä¹ˆ <code>LayoutBuilder</code>  å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œåšæ³•å¦‚ä¸‹ï¼š</p>
<p>éœ€è¦ç›‘å¬çš„ <code>widget</code> æ˜¯ <code>Body()</code> ç»„ä»¶ï¼Œç»™ Body() ç»„ä»¶å¥—ä¸Šä¸€ä¸ª <code>Stack</code></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> body =&gt; Stack(</span><br><span class="line">  children: &lt;Widget&gt;[</span><br><span class="line">    Body(),</span><br><span class="line">    BodyLayout(model),</span><br><span class="line">  ],</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ç„¶åç”¨ <code>BodyLayout</code> ç»„ä»¶æ¥ç›‘å¬ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:vhiphop/provider/video/video_model.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BodyLayout</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> VideoModel model;</span><br><span class="line">  BodyLayout(<span class="keyword">this</span>.model);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> LayoutBuilder(builder: (_, BoxConstraints constraints) &#123;</span><br><span class="line">      model.bottomSheetDy = constraints.maxHeight;</span><br><span class="line">      <span class="keyword">return</span> emptyBox;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ <code>Body()</code> ç»„ä»¶é«˜åº¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè§¦å‘ <code>LayoutBuilder</code> çš„ <code>builder</code> å›è°ƒå‡½æ•°ï¼Œåœ¨æ­¤å‡½æ•°ä¸­å°†é«˜åº¦ä¿¡æ¯ä¼ é€’ç»™ <code>model</code> ï¼Œé‚£ä¹ˆæ¯æ¬¡å¼¹å‡º <code>BottomSheet</code> ä¹‹å‰ï¼Œæˆ‘å°±å¯ä»¥ä» model ä¸­æ‹¿åˆ°é«˜åº¦ï¼Œä»¥è®¾ç½® BottomSheet çš„é«˜åº¦ã€‚</p>
<h1 id="åº•éƒ¨å¼¹å‡ºåŠ¨ç”»çš„ä¸¤ç§å®ç°æ–¹å¼"><a href="#åº•éƒ¨å¼¹å‡ºåŠ¨ç”»çš„ä¸¤ç§å®ç°æ–¹å¼" class="headerlink" title="åº•éƒ¨å¼¹å‡ºåŠ¨ç”»çš„ä¸¤ç§å®ç°æ–¹å¼"></a>åº•éƒ¨å¼¹å‡ºåŠ¨ç”»çš„ä¸¤ç§å®ç°æ–¹å¼</h1><p>è¿™ç§åŠ¨ç”»åœ¨ App ä¸­æ˜¯å¾ˆå¸¸è§çš„æ•ˆæœï¼Œä¾‹å¦‚ App åˆ†äº«åŠŸèƒ½ï¼Œç‚¹å‡»åˆ†äº«æŒ‰é’®åï¼Œä¼šä»é¡µé¢åº•éƒ¨å¼¹å‡ºåˆ†äº«ç»„ä»¶ã€‚</p>
<p>ç¬¬ä¸€ç§ï¼Œåˆ©ç”¨ <code>showModalBottomSheet</code>ï¼Œç›¸å…³å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> showShareBottomSheet() &#123;</span><br><span class="line">  showModalBottomSheet(</span><br><span class="line">    elevation: <span class="number">0</span>,</span><br><span class="line">    backgroundColor: currentTheme.highlightColor,</span><br><span class="line">    context: context,</span><br><span class="line">    builder: (context) =&gt; Container(</span><br><span class="line">      width: Screens.width,</span><br><span class="line">      decoration: BoxDecoration(color: currentTheme.primaryColor),</span><br><span class="line">      child: Column(</span><br><span class="line">        mainAxisSize: MainAxisSize.min,</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          Container(</span><br><span class="line">            alignment: Alignment.bottomLeft,</span><br><span class="line">            height: setWidth(<span class="number">59</span>),</span><br><span class="line">            padding: EdgeInsets.only(left: setWidth(<span class="number">42</span>)),</span><br><span class="line">            child: Text(</span><br><span class="line">              <span class="string">&#x27;åˆ†äº«&#x27;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                fontSize: setSp(<span class="number">32</span>),</span><br><span class="line">                color: currentTheme.highlightColor,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          Container(</span><br><span class="line">            height: setWidth(<span class="number">206</span>),</span><br><span class="line">            padding: EdgeInsets.only(top: setWidth(<span class="number">33</span>), left: setWidth(<span class="number">33</span>)),</span><br><span class="line">            alignment: Alignment.topLeft,</span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">              border: Border(</span><br><span class="line">                bottom: BorderSide(</span><br><span class="line">                  width: setWidth(<span class="number">.7</span>),</span><br><span class="line">                  color: currentTheme.dividerColor,</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            child: Row(</span><br><span class="line">              children: &lt;Widget&gt;[</span><br><span class="line">                shareIconOfQQ,</span><br><span class="line">                shareIconOfQQZone,</span><br><span class="line">                shareIconOfWeChat,</span><br><span class="line">                shareIconOfWeChatMoments,</span><br><span class="line">                shareIconOfMicroBlog,</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          Container(</span><br><span class="line">            height: setWidth(<span class="number">206</span>),</span><br><span class="line">            padding: EdgeInsets.only(top: setWidth(<span class="number">33</span>), left: setWidth(<span class="number">33</span>)),</span><br><span class="line">            alignment: Alignment.topLeft,</span><br><span class="line">            child: Row(</span><br><span class="line">              children: &lt;Widget&gt;[</span><br><span class="line">                shareIconOfLink,</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          GestureDetector(</span><br><span class="line">            onTap: () &#123;</span><br><span class="line">              Navigator.pop(context);</span><br><span class="line">            &#125;,</span><br><span class="line">            child: Container(</span><br><span class="line">              width: Screens.width,</span><br><span class="line">              height: setWidth(<span class="number">125</span>),</span><br><span class="line">              alignment: Alignment.center,</span><br><span class="line">              decoration: BoxDecoration(</span><br><span class="line">                border: Border(</span><br><span class="line">                  top: BorderSide(</span><br><span class="line">                    width: setWidth(<span class="number">10</span>),</span><br><span class="line">                    color: currentTheme.backgroundColor,</span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              child: Text(</span><br><span class="line">                <span class="string">&#x27;å–æ¶ˆ&#x27;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  fontSize: setSp(<span class="number">36</span>),</span><br><span class="line">                  color: currentTheme.highlightColor,</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨-translate-å®ç°"><a href="#ä½¿ç”¨-translate-å®ç°" class="headerlink" title="ä½¿ç”¨ translate å®ç°"></a>ä½¿ç”¨ translate å®ç°</h2><p>æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨  <code>showModalBottomSheet</code> æ—¶å‘ç°åŠ¨ç”»æœ‰ç‚¹å¡é¡¿ï¼Œå¯èƒ½æ˜¯æµ‹è¯•æ‰‹æœºä¸è¡Œï¼ŒåªèŠ±äº† 1000 å¤§æ´‹ï¼Œä½†å’±æ˜¯ä¸ªå€”å¼ºç©·äººï¼Œéè¦æ‰¾ä¸€ç§æ€§èƒ½æ›´å¥½çš„æ–¹å¼ï¼Œé‚£å°±æ˜¯ <code>translate</code> äº†ã€‚</p>
<p>è¿™ç§æ–¹æ³•æ¯” <code>showModalBottomSheet</code> åŠ¨ç”»æ€§èƒ½æ›´é«˜ï¼Œåœ¨æˆ‘ 1000 å¤§æ´‹çš„æµ‹è¯•æœº debug æ¨¡å¼ä¸‹éƒ½éå¸¸åœ°ä¸æ»‘æµç•…ï¼Œåªæ˜¯ä»£ç å®ç°æ›´å¤æ‚ä¸€ç‚¹ï¼Œå¹¶ä¸”éœ€è¦ä¾èµ– Provider æ¥æ›´æ–°ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢è¿™ç§æ–¹å¼ã€‚</p>
<p>æ•´ä¸ªé¡µé¢éƒ½ä½¿ç”¨ <code>Stack</code> æ„å»ºï¼Œè€Œ bottomSheet ä¸é®ç½© box åˆ™ä½¿ç”¨ <code>Positioned</code> å®šä½è‡³é¡µé¢åº•éƒ¨ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> body =&gt; Stack(</span><br><span class="line">  children: &lt;Widget&gt;[</span><br><span class="line">    page,</span><br><span class="line">    Positioned(</span><br><span class="line">      left: <span class="number">0</span>,</span><br><span class="line">      bottom: <span class="number">0</span>,</span><br><span class="line">      right: <span class="number">0</span>,</span><br><span class="line">      child: bottomSheetBox,</span><br><span class="line">    ),</span><br><span class="line">    Positioned(</span><br><span class="line">      left: <span class="number">0</span>,</span><br><span class="line">      top: <span class="number">0</span>,</span><br><span class="line">      right: <span class="number">0</span>,</span><br><span class="line">      bottom: shareBottomSheetHeight,</span><br><span class="line">      child: bottomSheetBoxMask,</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ä½¿ç”¨æˆ‘å®šä¹‰çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œåå­—å« <code>AnimatedTranslateBox</code>ï¼Œæˆ‘å‘ç° Animated å®¶æ—æœ‰å„ç§åŠ¨ç”»ç»„ä»¶ï¼Œæ¯”å¦‚ <code>AnimatedPadding</code>ã€<code>AnimatedPositioned</code> ç­‰ç­‰ï¼Œå”¯ç‹¬æ²¡æœ‰ <code>Translate</code>ï¼Œä¸çŸ¥é“å®˜æ–¹æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå¯èƒ½ä»–ä»¬è§‰å¾— <code>Positioned</code>  æ¥è°ƒæ•´ä½ç½®å°±å¤Ÿç”¨äº†å­ï¼Œå¯æ˜¯ <code>translate</code> åŠ¨ç”»æ€§èƒ½æ›´é«˜ï¼Œå®ƒä¸é¦™å—ï¼Ÿæ²¡å…³ç³»ï¼Œå’±è‡ªå·±é€ äº†ä¸€ä¸ªï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnimatedTranslateBox</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  AnimatedTranslateBox(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.dx,</span><br><span class="line">    <span class="keyword">this</span>.dy,</span><br><span class="line">    <span class="keyword">this</span>.child,</span><br><span class="line">    <span class="keyword">this</span>.curve = Curves.linear,</span><br><span class="line">    <span class="keyword">this</span>.duration = <span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">200</span>),</span><br><span class="line">    <span class="keyword">this</span>.reverseDuration,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> dx;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> dy;</span><br><span class="line">  <span class="keyword">final</span> Widget child;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Duration</span> duration;</span><br><span class="line">  <span class="keyword">final</span> Curve curve;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Duration</span> reverseDuration;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  createState() =&gt; _AnimatedTranslateBoxState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_AnimatedTranslateBoxState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">AnimatedTranslateBox</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  AnimationController controller;</span><br><span class="line">  Animation&lt;<span class="built_in">double</span>&gt; animation;</span><br><span class="line">  Tween&lt;<span class="built_in">double</span>&gt; tween;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _updateCurve() &#123;</span><br><span class="line">    animation = widget.curve == <span class="keyword">null</span></span><br><span class="line">      ? controller</span><br><span class="line">      : CurvedAnimation(parent: controller, curve: widget.curve);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    controller = AnimationController(</span><br><span class="line">      duration: widget.duration,</span><br><span class="line">      reverseDuration: widget.reverseDuration,</span><br><span class="line">      vsync: <span class="keyword">this</span>,</span><br><span class="line">    );</span><br><span class="line">    tween = Tween&lt;<span class="built_in">double</span>&gt;(begin: widget.dx ?? widget.dy);</span><br><span class="line">    _updateCurve();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> didUpdateWidget(AnimatedTranslateBox oldWidget) &#123;</span><br><span class="line">    <span class="keyword">super</span>.didUpdateWidget(oldWidget);</span><br><span class="line">    <span class="keyword">if</span> (widget.curve != oldWidget.curve) _updateCurve();</span><br><span class="line">    controller</span><br><span class="line">      ..duration = widget.duration</span><br><span class="line">      ..reverseDuration = widget.reverseDuration;</span><br><span class="line">    <span class="keyword">if</span> ((widget.dx ?? widget.dy) != (tween.end ?? tween.begin)) &#123;</span><br><span class="line">      tween</span><br><span class="line">        ..begin = tween.evaluate(animation)</span><br><span class="line">        ..end = widget.dx ?? widget.dy;</span><br><span class="line">      controller</span><br><span class="line">        ..value = <span class="number">0.0</span></span><br><span class="line">        ..forward();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    controller.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  build(context) =&gt; AnimatedBuilder(</span><br><span class="line">    animation: animation,</span><br><span class="line">    builder: (context, child) =&gt; widget.dx == <span class="keyword">null</span></span><br><span class="line">        ? Transform.translate(</span><br><span class="line">            offset: Offset(<span class="number">0</span>, tween.animate(animation).value),</span><br><span class="line">            child: child,</span><br><span class="line">          )</span><br><span class="line">        : Transform.translate(</span><br><span class="line">            offset: Offset(tween.animate(animation).value, <span class="number">0</span>),</span><br><span class="line">            child: child,</span><br><span class="line">          ),</span><br><span class="line">    child: widget.child,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨å¾ˆç®€å•ï¼Œä½¿ç”¨ <code>Selector</code> ä¾èµ– model ä¸­çš„å¸ƒå°”å€¼ï¼Œç”¨äºæ§åˆ¶æ˜¾ç¤ºéšè—ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> bottomSheetBox =&gt; Selector&lt;VideoModel, <span class="built_in">bool</span>&gt;(</span><br><span class="line">  selector: (context, model) =&gt; model.showBottomSheet,</span><br><span class="line">  builder: (context, <span class="keyword">show</span>, child) =&gt; AnimatedOpacity(</span><br><span class="line">    opacity: <span class="keyword">show</span> ? <span class="number">1</span> : <span class="number">0</span>,</span><br><span class="line">    curve: <span class="keyword">show</span> ? Curves.easeOut : Curves.easeIn,</span><br><span class="line">    duration: bottomSheetDuration,</span><br><span class="line">    child: AnimatedTranslateBox(</span><br><span class="line">      dy: <span class="keyword">show</span> ? <span class="number">0</span> : bottomSheetHeight,</span><br><span class="line">      curve: <span class="keyword">show</span> ? Curves.easeOut : Curves.easeIn,</span><br><span class="line">      duration: bottomSheetDuration,</span><br><span class="line">      child: child,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">  child: Container(</span><br><span class="line">    height: bottomSheetHeight,</span><br><span class="line">    child: bottomSheet,</span><br><span class="line">  ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>æ¯å½“ <code>dx</code> æˆ– <code>dy</code> çš„å€¼å‘ç”Ÿæ”¹å˜ï¼Œ<code>AnimatedTranslateBox</code> çš„ child å°±ä¼šæ ¹æ® <code>dx</code> æˆ– <code>dy</code> çš„å€¼è¿›è¡Œ y è½´ æˆ– x è½´çš„ç§»åŠ¨åŠ¨ç”»ã€‚</p>
<p>ç›¸å…³çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/2/28/1708b07cd338e0ca?imageslim" alt="bottom_sheet.gif"></p>
<h1 id="Provider-è°ƒç”¨é—®é¢˜"><a href="#Provider-è°ƒç”¨é—®é¢˜" class="headerlink" title="Provider è°ƒç”¨é—®é¢˜"></a>Provider è°ƒç”¨é—®é¢˜</h1><p>æˆ‘å‘ç°å¦‚æœåœ¨ <code>MaterialApp</code> ä¸‹å…¨å±€æŒ‚è½½äº† Provider ï¼Œåˆ™åœ¨ Home é¡µåˆå§‹åŒ–å®Œæˆå‰ï¼Œæ˜¯æ— æ³•ä½¿ Provider çš„ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> _userModel = UserModel();</span><br><span class="line">  <span class="keyword">final</span> _homeModel = HomeModel();</span><br><span class="line"></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> OKToast(</span><br><span class="line">      dismissOtherOnShow: <span class="keyword">true</span>,</span><br><span class="line">      child: MultiProvider(</span><br><span class="line">        providers: [</span><br><span class="line">          ChangeNotifierProvider.value(value: _userModel),</span><br><span class="line">          ChangeNotifierProvider.value(value: _homeModel),</span><br><span class="line">        ],</span><br><span class="line">        child: Selector&lt;ThemeModel, ThemeData&gt;(</span><br><span class="line">          selector: (context, model) =&gt; model.theme,</span><br><span class="line">          builder: (context, theme, child) =&gt; MaterialApp(</span><br><span class="line">            navigatorKey: Constants.navigatorKey,</span><br><span class="line">            debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">            theme: theme,</span><br><span class="line">            initialRoute: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">            routes: &#123;</span><br><span class="line">              <span class="string">&#x27;/&#x27;</span>: (context) =&gt; HomePage(),</span><br><span class="line">            &#125;,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç å£°æ˜äº† <code>MultiProvider</code>ï¼Œå¦‚æœåœ¨é¦–é¡µåšå¦‚ä¸‹è°ƒç”¨ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">initState() &#123;</span><br><span class="line">  _model = Provider.of&lt;HomeModel&gt;(context);</span><br><span class="line">  _userModel = Provider.of&lt;UserModel&gt;(context);</span><br><span class="line">  <span class="keyword">super</span>.initState();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ™ä¼šæŠ¥é”™ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): â•â•â•¡ EXCEPTION CAUGHT BY WIDGETS LIBRARY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): The following assertion was thrown building Builder:</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): dependOnInheritedWidgetOfExactType&lt;_DefaultInheritedProviderScope&lt;HomeModel&gt;&gt;() or</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): dependOnInheritedElement() was called before _HomePageState.initState() completed.</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): When an inherited widget changes, for example if the value of Theme.of() changes, its dependent</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): widgets are rebuilt. If the dependent widget&#x27;s reference to the inherited widget is in a constructor</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): or an initState() method, then the rebuilt dependent widget will not reflect the changes in the</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): inherited widget.</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): Typically references to inherited widgets should occur in widget build() methods. Alternatively,</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): initialization based <span class="literal">on</span> inherited widgets can be placed in the didChangeDependencies method, which</span><br><span class="line"><span class="attribute">I</span>/flutter ( <span class="number">8380</span>): is called after initState and whenever the dependencies change thereafter.</span><br></pre></td></tr></table></figure>

<p>æç¤º <code>initState</code> å¿…é¡»è°ƒç”¨å®Œæˆï¼Œæ‰èƒ½ä½¿ç”¨ <code>Provider.of</code> æ¥è·å–ç¥–å…ˆèŠ‚ç‚¹çš„ modelï¼Œéè¦ä½¿ç”¨æ€ä¹ˆåŠï¼ŸåŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œ <code>of</code> æ–¹æ³•æœ‰ä¸€ä¸ªå±æ€§å€¼ <code>listen</code>ï¼Œé»˜è®¤å€¼ä¸º <code>true</code>ï¼Œå°†æ­¤å€¼è®¾ç½®ä¸º <code>false</code> åˆ™ä¸ä¼šå»ºç«‹ä¸ Provider çš„ä¾èµ–å…³ç³»ï¼Œå…¶å®æˆ‘åœ¨ Provider çš„æ‰‹å†Œä¸­ä¹Ÿå‘ç°ï¼Œå»ºè®®åœ¨ <code>initState</code> æ–¹æ³•ä¸­è°ƒç”¨ <code>of</code> æ—¶ï¼Œå°† <code>listen</code> è®¾ç½®ä¸º <code>false</code>ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">initState() &#123;</span><br><span class="line">  _userModel = Provider.of&lt;UserModel&gt;(context, listen: <span class="keyword">false</span>);</span><br><span class="line">  _model = Provider.of&lt;HomeModel&gt;(context, listen: <span class="keyword">false</span>);</span><br><span class="line">  <span class="keyword">super</span>.initState();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="å¦‚ä½•å®ç°ç½‘æ˜“äº‘éŸ³ä¹ã€QQéŸ³ä¹æ’­æ”¾é¡µé¢çš„èƒŒæ™¯å›¾ç‰‡æ¨¡ç³Šæ•ˆæœ"><a href="#å¦‚ä½•å®ç°ç½‘æ˜“äº‘éŸ³ä¹ã€QQéŸ³ä¹æ’­æ”¾é¡µé¢çš„èƒŒæ™¯å›¾ç‰‡æ¨¡ç³Šæ•ˆæœ" class="headerlink" title="å¦‚ä½•å®ç°ç½‘æ˜“äº‘éŸ³ä¹ã€QQéŸ³ä¹æ’­æ”¾é¡µé¢çš„èƒŒæ™¯å›¾ç‰‡æ¨¡ç³Šæ•ˆæœ"></a>å¦‚ä½•å®ç°ç½‘æ˜“äº‘éŸ³ä¹ã€QQéŸ³ä¹æ’­æ”¾é¡µé¢çš„èƒŒæ™¯å›¾ç‰‡æ¨¡ç³Šæ•ˆæœ</h1><p>åˆ†æä¸€ä¸‹ï¼Œå…¶å®è¿™ç§æ•ˆæœç‰¹åˆ«ç®€å•ï¼Œé¦–å…ˆæ”¾å¤§èƒŒæ™¯å›¾ç‰‡ï¼Œå…¶æ¬¡å¯¹å›¾ç‰‡è¿›è¡Œé«˜æ–¯æ¨¡ç³Šï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:ui&#x27;</span>;</span><br><span class="line"></span><br><span class="line">main() =&gt; runApp(MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> image = Image.asset(</span><br><span class="line">    <span class="string">&#x27;assets/images/test.jpg&#x27;</span>,</span><br><span class="line">    fit: BoxFit.cover,</span><br><span class="line">    width: <span class="number">200</span>,</span><br><span class="line">    height: <span class="number">200</span>,</span><br><span class="line">  );</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">get</span> blurImage =&gt; ClipRRect(</span><br><span class="line">    child: Stack(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Transform.scale(</span><br><span class="line">          scale: <span class="number">1.5</span>,</span><br><span class="line">          child: image,</span><br><span class="line">        ),</span><br><span class="line">        BackdropFilter(</span><br><span class="line">          filter: ImageFilter.blur(sigmaX: <span class="number">5</span>, sigmaY: <span class="number">5</span>),</span><br><span class="line">          child: Container(</span><br><span class="line">            width: <span class="number">200</span>,</span><br><span class="line">            height: <span class="number">200</span>,</span><br><span class="line">            alignment: Alignment.center,</span><br><span class="line">            color: Colors.black.withOpacity(<span class="number">.3</span>),</span><br><span class="line">            child: Text(</span><br><span class="line">              <span class="string">&#x27;1 ä¸ªå†…å®¹&#x27;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                fontSize: <span class="number">24</span>,</span><br><span class="line">                color: Colors.white,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">);</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">&#x27;Flutter Demo app&#x27;</span>,</span><br><span class="line">      theme: ThemeData(primarySwatch: Colors.blue),</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        appBar: AppBar(title: Text(<span class="string">&#x27;blur image demo&#x27;</span>)),</span><br><span class="line">        body: Row(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            Column(</span><br><span class="line">              mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">              children: &lt;Widget&gt;[</span><br><span class="line">                Container(</span><br><span class="line">                  margin: EdgeInsets.only(bottom: <span class="number">30</span>),</span><br><span class="line">                  child: image,</span><br><span class="line">                ),</span><br><span class="line">                blurImage,</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ•ˆæœå…¶å®æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¸»è¦çš„çŸ¥è¯†ç‚¹åœ¨äº <code>BackdropFilter</code> ç»„ä»¶é»˜è®¤çš„æ¨¡ç³Šæ•ˆæœæ˜¯å…¨å±çš„ï¼Œå¿…é¡»ä½¿ç”¨ <code>ClipRRect</code> è¿›è¡Œè£å‰ªï¼Œè€Œä¸” <code>Transform</code> çš„å‡ ä¸ªå‘½åæ„é€ å‡½æ•°ï¼Œå¦‚ <code>Transform.translate</code> å¸¦æ¥çš„æ•ˆæœæ˜¯åœ¨ç»˜åˆ¶é˜¶æ®µå‘ç”Ÿçš„ï¼Œä¼šè¶…å‡º <code>widget</code> å®é™…å ç”¨çš„ç©ºé—´ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨ <code>ClipRRect</code> è¿›è¡Œè£å‰ªï¼Œæœ€åçš„æ•ˆæœå›¾å¦‚ä¸‹ï¼š</p>
<p><img src="/posts/136519660/blur_img.jpg" alt="blur_img.jpg"></p>
<h2 id="Dart-SDK-is-not-found-in-the-specified-location"><a href="#Dart-SDK-is-not-found-in-the-specified-location" class="headerlink" title="Dart SDK is not found in the specified location"></a>Dart SDK is not found in the specified location</h2><p>åˆ é™¤<code>flutter\bin</code>ä¸‹çš„<code>cache</code>æ–‡ä»¶å¤¹ï¼Œé‡æ–°è¿è¡Œ<code>flutter doctor</code></p>
<!-- flag of hidden posts -->
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/private/" rel="tag"># private</a>
          
            <a href="/tags/flutter/" rel="tag"># flutter</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">292</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:shenbh@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/ptwenzi?spm=1010.2135.3001.5113" target="_blank" title="CSDN">
                      
                        <i class="fa fa-fw fa-clone"></i>CSDN</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%AE%BD%E9%AB%98%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"><span class="nav-text">å®¹å™¨å®½é«˜ç›¸å…³é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Container-%E8%AE%BE%E7%BD%AE%E5%AE%BD%E9%AB%98%E4%B8%8D%E7%94%9F%E6%95%88"><span class="nav-text">Container è®¾ç½®å®½é«˜ä¸ç”Ÿæ•ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SignleChildScrollView-%E4%B8%8D%E6%BB%A1%E4%B8%80%E5%B1%8F%E9%AB%98%E5%BA%A6%E6%97%B6%E6%97%A0%E6%B3%95%E6%92%91%E6%BB%A1%E5%85%A8%E5%B1%8F"><span class="nav-text">SignleChildScrollView ä¸æ»¡ä¸€å±é«˜åº¦æ—¶æ— æ³•æ’‘æ»¡å…¨å±</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Container-%E8%AE%BE%E7%BD%AE-borderRadius-%E4%B8%8D%E7%94%9F%E6%95%88"><span class="nav-text">Container  è®¾ç½® borderRadius ä¸ç”Ÿæ•ˆ</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%83%E7%B4%A0%E6%98%BE%E7%A4%BA%E5%B1%82%E7%BA%A7%E9%97%AE%E9%A2%98"><span class="nav-text">å…ƒç´ æ˜¾ç¤ºå±‚çº§é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E9%9A%90%E8%97%8F%E7%9A%84%E5%87%A0%E7%A7%8D%E5%81%9A%E6%B3%95"><span class="nav-text">æ˜¾ç¤ºéšè—çš„å‡ ç§åšæ³•</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GestureDetector-%E8%AE%BE%E7%BD%AE-onTap-%E4%B8%8D%E7%94%9F%E6%95%88"><span class="nav-text">GestureDetector è®¾ç½® onTap ä¸ç”Ÿæ•ˆ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B0%83%E7%94%A8-setState-%E6%88%96-markNeedsBuild-%E5%90%8E%E6%8A%A5%E9%94%99"><span class="nav-text">è°ƒç”¨ setState æˆ– markNeedsBuild åæŠ¥é”™</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%8A%A5%E9%94%99"><span class="nav-text">ç¬¬ä¸€ç§æŠ¥é”™</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%8A%A5%E9%94%99"><span class="nav-text">ç¬¬äºŒç§æŠ¥é”™</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%9B%B4%E6%94%B9-TabBar-%E7%9A%84%E9%95%BF%E5%BA%A6%E5%90%8E-setState-%E6%8A%A5%E9%94%99"><span class="nav-text">åŠ¨æ€æ›´æ”¹ TabBar çš„é•¿åº¦å setState æŠ¥é”™</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"><span class="nav-text">é”®ç›˜ç›¸å…³é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E5%BC%B9%E5%87%BA%E5%90%8E%E5%B0%86%E5%B8%83%E5%B1%80%E9%A1%B6%E8%B5%B7%E6%9D%A5%E4%BA%86%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF%E9%81%AE%E4%BD%8F%E5%B8%83%E5%B1%80"><span class="nav-text">é”®ç›˜å¼¹å‡ºåå°†å¸ƒå±€é¡¶èµ·æ¥äº†ï¼Œè€Œä¸æ˜¯é®ä½å¸ƒå±€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%B1%E6%83%B3%E8%AE%A9%E9%94%AE%E7%9B%98%E9%A1%B6%E8%B5%B7%E5%B8%83%E5%B1%80%EF%BC%8C%E5%B8%83%E5%B1%80%E5%8D%B4%E6%BA%A2%E5%87%BA%E4%BA%86%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F"><span class="nav-text">å°±æƒ³è®©é”®ç›˜é¡¶èµ·å¸ƒå±€ï¼Œå¸ƒå±€å´æº¢å‡ºäº†æ€ä¹ˆåŠï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E5%BC%B9%E8%B5%B7%E5%92%8C%E6%94%B6%E5%9B%9E%E4%BC%9A%E5%BC%95%E8%B5%B7%E9%A1%B5%E9%9D%A2%E9%87%8D%E6%96%B0build"><span class="nav-text">é”®ç›˜å¼¹èµ·å’Œæ”¶å›ä¼šå¼•èµ·é¡µé¢é‡æ–°build</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TextField-%E5%A6%82%E4%BD%95%E6%A0%B9%E6%8D%AE%E5%86%85%E5%AE%B9%E8%87%AA%E9%80%82%E5%BA%94%E9%AB%98%E5%BA%A6"><span class="nav-text">TextField å¦‚ä½•æ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TextField-%E8%AE%BE%E7%BD%AE-border-%E4%B8%8D%E7%94%9F%E6%95%88"><span class="nav-text">TextField è®¾ç½® border ä¸ç”Ÿæ•ˆ</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"><span class="nav-text">è·¯ç”±è·³è½¬ç›¸å…³é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#push%E3%80%81pop-%E5%B8%B8%E8%A7%81%E9%9C%80%E6%B1%82"><span class="nav-text">pushã€pop å¸¸è§éœ€æ±‚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%9C%A8-initState-%E9%98%B6%E6%AE%B5%E5%B0%B1%E8%83%BD%E4%BD%BF%E7%94%A8-context"><span class="nav-text">å¦‚ä½•åœ¨ initState é˜¶æ®µå°±èƒ½ä½¿ç”¨ context</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mac-%E7%8E%AF%E5%A2%83-build-%E6%97%B6%E7%9A%84%E9%94%99%E8%AF%AF"><span class="nav-text">Mac ç¯å¢ƒ build æ—¶çš„é”™è¯¯</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PageView%E3%80%81ListView-%E7%AD%89%E6%BB%9A%E5%8A%A8%E7%BB%84%E4%BB%B6%E5%88%87%E6%8D%A2%E9%A1%B5%E9%9D%A2%E8%BF%94%E5%9B%9E%E5%90%8E%E7%9A%84%E9%AB%98%E5%BA%A6%E4%BD%8D%E7%BD%AE%E8%A2%AB%E6%94%B9%E5%8F%98%E4%BA%86"><span class="nav-text">PageViewã€ListView ç­‰æ»šåŠ¨ç»„ä»¶åˆ‡æ¢é¡µé¢è¿”å›åçš„é«˜åº¦ä½ç½®è¢«æ”¹å˜äº†</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E7%9B%91%E5%90%AC-App-%E8%BF%94%E5%9B%9E%E6%A1%8C%E9%9D%A2%E4%BA%8B%E4%BB%B6"><span class="nav-text">å¦‚ä½•ç›‘å¬ App è¿”å›æ¡Œé¢äº‹ä»¶</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Dio-%E5%B0%8F%E6%8A%80%E5%B7%A7"><span class="nav-text">Dio å°æŠ€å·§</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Android-%E6%89%93%E5%8C%85%E5%90%8E%E6%97%A0%E6%B3%95%E8%BF%9B%E8%A1%8C%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82"><span class="nav-text">Android æ‰“åŒ…åæ— æ³•è¿›è¡Œç½‘ç»œè¯·æ±‚</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%B9%E4%BA%8E%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95%E7%9A%84%E5%AE%9A%E4%B9%89%E8%A7%84%E8%8C%83%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BB%BA%E8%AE%AE"><span class="nav-text">å¯¹äºç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•çš„å®šä¹‰è§„èŒƒçš„ä¸€äº›å»ºè®®</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%A8%E5%B1%8F%E7%9B%B8%E5%85%B3%E8%AE%BE%E7%BD%AE"><span class="nav-text">å…¨å±ç›¸å…³è®¾ç½®</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Transform-3D-%E8%BD%AC%E6%8D%A2"><span class="nav-text">Transform 3D è½¬æ¢</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E9%A2%91%E9%95%9C%E5%83%8F%E7%BF%BB%E8%BD%AC"><span class="nav-text">è§†é¢‘é•œåƒç¿»è½¬</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E6%A0%8F%E7%9B%B8%E5%85%B3%E8%AE%BE%E7%BD%AE"><span class="nav-text">çŠ¶æ€æ ç›¸å…³è®¾ç½®</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#fijkplayer-%E7%A7%92%E5%BC%80%E3%80%81%E8%BF%9B%E5%BA%A6%E8%B7%B3%E8%BD%AC%E7%AD%89%E4%BC%98%E5%8C%96"><span class="nav-text">fijkplayer ç§’å¼€ã€è¿›åº¦è·³è½¬ç­‰ä¼˜åŒ–</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#LayoutBuilder-%E7%9B%B8%E5%85%B3%E7%9A%84%E5%AE%9E%E8%B7%B5"><span class="nav-text">LayoutBuilder ç›¸å…³çš„å®è·µ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E6%9C%8B%E5%8F%8B%E5%9C%88%E3%80%81%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E8%AF%84%E8%AE%BA%E7%9A%84%E5%A4%9A%E8%A1%8C%E6%96%87%E6%9C%AC%E6%94%B6%E8%B5%B7%E3%80%81%E5%B1%95%E5%BC%80%E5%8A%9F%E8%83%BD"><span class="nav-text">å¦‚ä½•å®ç°å¾®ä¿¡æœ‹å‹åœˆã€å“”å“©å“”å“©è¯„è®ºçš„å¤šè¡Œæ–‡æœ¬æ”¶èµ·ã€å±•å¼€åŠŸèƒ½</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%91%E5%90%AC%E7%88%B6%E7%BA%A7-widget-%E7%9A%84%E5%AE%9E%E9%99%85%E5%AE%BD%E9%AB%98%E4%BF%A1%E6%81%AF"><span class="nav-text">ç›‘å¬çˆ¶çº§ widget çš„å®é™…å®½é«˜ä¿¡æ¯</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BA%95%E9%83%A8%E5%BC%B9%E5%87%BA%E5%8A%A8%E7%94%BB%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="nav-text">åº•éƒ¨å¼¹å‡ºåŠ¨ç”»çš„ä¸¤ç§å®ç°æ–¹å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-translate-%E5%AE%9E%E7%8E%B0"><span class="nav-text">ä½¿ç”¨ translate å®ç°</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Provider-%E8%B0%83%E7%94%A8%E9%97%AE%E9%A2%98"><span class="nav-text">Provider è°ƒç”¨é—®é¢˜</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E3%80%81QQ%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E9%A1%B5%E9%9D%A2%E7%9A%84%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87%E6%A8%A1%E7%B3%8A%E6%95%88%E6%9E%9C"><span class="nav-text">å¦‚ä½•å®ç°ç½‘æ˜“äº‘éŸ³ä¹ã€QQéŸ³ä¹æ’­æ”¾é¡µé¢çš„èƒŒæ™¯å›¾ç‰‡æ¨¡ç³Šæ•ˆæœ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Dart-SDK-is-not-found-in-the-specified-location"><span class="nav-text">Dart SDK is not found in the specified location</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é˜¿ç‚³</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('Copied')
          else $(this).text('Copy failed')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('Copy')
        }, 300)
      }).append(e)
    })
  </script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>